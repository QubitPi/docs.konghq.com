<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/Article">

  



<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
    <!-- OneTrust Cookies Consent Notice start for konghq.com -->
    <script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" type="text/javascript" charset="UTF-8" data-domain-script="2c4de954-6bec-4e93-8086-64cb113f151a">
    </script>
    <script type="text/javascript">
    function OptanonWrapper() { }
    </script>
    <!-- OneTrust Cookies Consent Notice end for konghq.com -->

    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-NL48VKT');</script>
    <!-- End Google Tag Manager -->

    <!-- Recaptcha -->
    <script src="https://www.google.com/recaptcha/api.js" async defer></script>
  

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Proxy Reference - v2.7.x | Kong Docs</title>
  <meta name="description" content="Documentation for Kong, the Cloud Connectivity Company for APIs and Microservices.">
  <meta name="author" content="KongHQ">
  <meta property="og:title" content="Proxy Reference - v2.7.x | Kong Docs">
  <meta property="og:site_name" content="Kong Docs">
  <!-- use share link for facebook -->
  <meta property="og:url" content="https://docs.konghq.com">
  <meta property="og:description" content="Documentation for Kong, the Cloud Connectivity Company for APIs and Microservices.">
  <meta property="og:type" content="website">
  <meta property="og:locale" content="en_US">
  <meta property="og:image" content="https://docs.konghq.com/assets/images/share.png">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@thekonginc">
  <meta name="twitter:creator" content="@thekonginc">
  <meta name="twitter:url" content="https://docs.konghq.com">
  <meta name="twitter:description" content="Documentation for Kong, the Cloud Connectivity Company for APIs and Microservices.">
  <meta name="twitter:image" content="https://docs.konghq.com/assets/images/share.png">
  <meta property="fb:admins" content="227304446">
  <meta property="fb:admins" content="576641408">
  <meta name="google-site-verification" content="CrU3zp02dNKTe8NSAipL4NCPkrIjDXG8fViTZ-MIzP4">

  

  <script type="application/ld+json">
    {
      "@context": "http://schema.org",
      "@type": "Organization",
      "name": "KongHQ",
      "url": "https://docs.konghq.com",
      "logo": "https://docs.konghq.com/assets/images/logo.png",
      "sameAs": [
        "https://www.facebook.com/konginc",
        "https://twitter.com/thekonginc",
        "https://plus.google.com/+mashape"
      ]
    }
  </script>

  <!-- Preload assets -->
  <link rel="dns-prefetch" href="https://cloud.typography.com">
  <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700" rel="stylesheet">
  <link rel="dns-prefetch" href="https://dev.visualwebsiteoptimizer.com">
  <link rel="dns-prefetch" href="https://cdn.segment.com">

  <link rel="icon" type="image/x-icon" href="/assets/images/favicon.ico">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3">

  
    <link rel="canonical" href="https://docs.konghq.com/gateway/latest/how-kong-works/routing-traffic/">
  

  
    <meta name="robots" content="follow,noindex">
  

  <!-- FontAwesome icon font -->
  <script src="https://kit.fontawesome.com/1332a92967.js" crossorigin="anonymous">
  </script>

  
  <script src="/docs.konghq.com/vite/assets/application-MBEAZv6G.js" crossorigin="anonymous" type="module"></script>
<link href="/docs.konghq.com/vite/assets/_commonjsHelpers-4gQjN7DL.js" rel="modulepreload" as="script" crossorigin="anonymous">


  

  

  <link rel="stylesheet" href="/docs.konghq.com/vite/assets/application-T5YiCv-Y.css" media="screen">

  
</head>


  <body id="" data-spy="scroll" data-target="#scroll-sidebar" data-offset="350">

    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NL48VKT" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->

    <header class="navbar-v2 closed">
  <a class="skip-main" href="#main">Skip to content</a>
  <!-- uncomment the promo-banner div when adding a new promo banner-->
  <!--also uncomment the promo banner sections in app/assets/stylesheets/header.less and application.js-->
  <!-- <div id="promo-banner">
    <div class="container">
      <div class="closebanner"></div> <strong>2023 API Summit Hackathon: Experiment with AI for APIs (August 28 - September 27) <a
          href="https://konghq.com/conferences/kong-summit/hackathon?utm_medium=website&utm_source=docs-konghq-com&utm_campaign=docs-banner">Learn More &rarr;</a></strong>
    </div>
  </div> -->
  <div class="navbar-content">
    <a href="https://konghq.com" class="navbar-brand col col-xl-auto" target="_blank" rel="noopener noreferrer">
      <img src="/assets/images/logos/kong-logo-blue.svg" alt="Kong Logo" id="kong-logo">
    </a>
    <span class="logo-divider">|</span>
    <a href="/" class="navbar-brand col col-xl-auto">
      <img src="/assets/images/logos/docs-logo-steel.svg" alt="Kong Docs Logo" id="kong-docs-logo">
    </a>

    <div class="separator mobile"></div>
      <div class="search-input-wrapper" id="getkong-algolia-search-input">
    </div>

    <div class="search-results-wrapper"></div>

    <div class="separator"></div>
    <div class="navbar-items" role="navigation" aria-label="Main menu">
      <ul class="navbar-items" role="menubar">
        <li id="top-module-list" aria-haspopup="true" role="menuitem" aria-expanded="false" class="navbar-item main-menu-item with-submenu  active">
          <span tabindex="0" id="docs-link" class="main-menu-item-title">Docs</span>
          <span class="caret"></span>
          <ul class="navbar-item-submenu" role="menu">
            <div class="submenu-section">
              <li role="menuitem" class="docs-dropdown-li">
                <a href="/api/" class="docs-dropdown-li__link" tabindex="-1">
                  <div class="docs-dropdown-li__card">
                    <span class="heading">Explore the API Specs</span>
                    <div class="docs-dropdown-li__card-link">
                      <img src="/assets/images/landing-page/view-all-api-specs.png" alt="View all API Specs">
                      <span class="docs-dropdown-li__card-image">
                        View all API Specs
                        <img src="/assets/images/landing-page/arrow-right.svg" alt="View all API Specs arrow image">
                      </span>
                    </div>
                  </div>
                </a>
              </li>

              <li role="menuitem" class="docs-dropdown-li" tabindex="-1">
                <div class="docs-dropdown-li__section">
                  <div class="docs-dropdown-li__section-title">
                    <span class="heading">Documentation</span>
                  </div>

                  <div class="docs-dropdown-li__section-items">
                    <a class="item item-all" href="/api/" tabindex="-1">
                      <div class="item__description">
                        <div class="item__description-title">API Specs</div>
                      </div>
                    </a>
                    
                      <a class="item" href="/gateway/latest/" tabindex="-1">
                        
                        <div class="item__description">
                          <div class="item__description-title">Kong Gateway</div>
                          <div class="item__description-desc">Lightweight, fast, and flexible cloud-native API gateway</div>
                        </div>
                      </a>
                    
                      <a class="item" href="/konnect/" tabindex="-1">
                        
                        <div class="item__description">
                          <div class="item__description-title">Kong Konnect</div>
                          <div class="item__description-desc">Single platform for SaaS end-to-end connectivity</div>
                        </div>
                      </a>
                    
                      <a class="item" href="/mesh/latest/" tabindex="-1">
                        
                        <div class="item__description">
                          <div class="item__description-title">Kong Mesh</div>
                          <div class="item__description-desc">Enterprise service mesh based on Kuma and Envoy</div>
                        </div>
                      </a>
                    
                      <a class="item" href="/deck/latest/" tabindex="-1">
                        
                        <div class="item__description">
                          <div class="item__description-title">decK</div>
                          <div class="item__description-desc">Helps manage Kong’s configuration in a declarative fashion</div>
                        </div>
                      </a>
                    
                      <a class="item" href="/kubernetes-ingress-controller/latest/" tabindex="-1">
                        
                        <div class="item__description">
                          <div class="item__description-title">Kong Ingress Controller</div>
                          <div class="item__description-desc">Works inside a Kubernetes cluster and configures Kong to proxy traffic</div>
                        </div>
                      </a>
                    
                      <a class="item" href="/gateway-operator/latest/" tabindex="-1">
                        
                        <div class="item__description">
                          <div class="item__description-title">Kong Gateway Operator</div>
                          <div class="item__description-desc">Manage your Kong deployments on Kubernetes using YAML Manifests</div>
                        </div>
                      </a>
                    
                      <a class="item" href="https://docs.insomnia.rest/" tabindex="-1" target="_blank" rel="noopener nofollow noreferrer ">
                        
                        <div class="item__description">
                          <div class="item__description-title">Insomnia</div>
                          <div class="item__description-desc">Collaborative API development platform</div>
                        </div>
                      </a>
                    
                      <a class="item" href="https://kuma.io/docs/" tabindex="-1" target="_blank" rel="noopener nofollow noreferrer ">
                        
                        <div class="item__description">
                          <div class="item__description-title">Kuma</div>
                          <div class="item__description-desc">Open-source distributed control plane with a bundled Envoy Proxy integration</div>
                        </div>
                      </a>
                    
                  </div>
                </div>
              </li>

            </div>
          </ul>
        </li>

        <li role="menuitem" aria-haspopup="true" aria-expanded="false" class="navbar-item main-menu-item with-submenu navbar-item-hub">
          <span id="plugin-link" class="main-menu-item-title" tabindex="0">Plugin Hub</span>
          <span class="caret"></span>
          <ul class="navbar-item-submenu" role="menu">
            <div class="submenu-section">
              <li role="menuitem" class="docs-dropdown-li">
                <a href="/hub/" class="docs-dropdown-li__link" tabindex="-1">
                  <div class="docs-dropdown-li__card">
                    <span class="heading">Explore the Plugin Hub</span>
                    <div class="docs-dropdown-li__card-link">
                      <img src="/assets/images/landing-page/view-all-plugins.svg" alt="View all plugins">
                      <span class="docs-dropdown-li__card-image">
                        View all plugins
                        <img src="/assets/images/landing-page/arrow-right.svg" alt="View all plugins arrow image">
                      </span>
                    </div>
                  </div>
                </a>
              </li>

              <li role="menuitem" class="docs-dropdown-li">
                <div class="docs-dropdown-li__section">
                  <div class="docs-dropdown-li__section-title">
                    <span class="heading">Functionality</span>
                    <a href="/hub/" class="view-all" tabindex="-1">
                      View all
                      <img src="/assets/images/landing-page/arrow-right.svg" alt="View all arrow image">
                    </a>
                  </div>

                  <div class="docs-dropdown-li__section-items">
                    <a class="item item-all" href="/hub/" tabindex="-1">
                      <div class="item__description">
                        <div class="item__description-title">View all plugins</div>
                      </div>
                    </a>

                    
                      <a class="item" href="/hub/?category=authentication" tabindex="-1">
                        <div>
                          <img src="/assets/images/nav/hub/lock_person.svg" alt="Authentication's icon">
                        </div>
                        <div class="item__description">
                          <div class="item__description-title">Authentication</div>
                          <div class="item__description-desc">Protect your services with an authentication layer</div>
                        </div>
                      </a>
                    
                      <a class="item" href="/hub/?category=security" tabindex="-1">
                        <div>
                          <img src="/assets/images/nav/hub/shield.svg" alt="Security's icon">
                        </div>
                        <div class="item__description">
                          <div class="item__description-title">Security</div>
                          <div class="item__description-desc">Protect your services with additional security layer</div>
                        </div>
                      </a>
                    
                      <a class="item" href="/hub/?category=traffic-control" tabindex="-1">
                        <div>
                          <img src="/assets/images/nav/hub/route.svg" alt="Traffic Control's icon">
                        </div>
                        <div class="item__description">
                          <div class="item__description-title">Traffic Control</div>
                          <div class="item__description-desc">Manage, throttle and restrict inbound and outbound API traffic</div>
                        </div>
                      </a>
                    
                      <a class="item" href="/hub/?category=serverless" tabindex="-1">
                        <div>
                          <img src="/assets/images/nav/hub/serverless.svg" alt="Serverless's icon">
                        </div>
                        <div class="item__description">
                          <div class="item__description-title">Serverless</div>
                          <div class="item__description-desc">Invoke serverless functions in combination with other plugins</div>
                        </div>
                      </a>
                    
                      <a class="item" href="/hub/?category=analytics-monitoring" tabindex="-1">
                        <div>
                          <img src="/assets/images/nav/hub/bar_chart.svg" alt="Analytics &amp; Monitoring's icon">
                        </div>
                        <div class="item__description">
                          <div class="item__description-title">Analytics &amp; Monitoring</div>
                          <div class="item__description-desc">Visualize, inspect and monitor APIs and microservices traffic</div>
                        </div>
                      </a>
                    
                      <a class="item" href="/hub/?category=transformations" tabindex="-1">
                        <div>
                          <img src="/assets/images/nav/hub/swap_horiz.svg" alt="Transformations's icon">
                        </div>
                        <div class="item__description">
                          <div class="item__description-title">Transformations</div>
                          <div class="item__description-desc">Transform request and responses on the fly on Kong</div>
                        </div>
                      </a>
                    
                      <a class="item" href="/hub/?category=logging" tabindex="-1">
                        <div>
                          <img src="/assets/images/nav/hub/list_alt.svg" alt="Logging's icon">
                        </div>
                        <div class="item__description">
                          <div class="item__description-title">Logging</div>
                          <div class="item__description-desc">Log request and response data using the best transport for your infrastructure</div>
                        </div>
                      </a>
                    

                  </div>
                </div>
              </li>
            </div>
          </ul>
        </li>
        <li role="menuitem" class="main-menu-item">
          <a href="https://support.konghq.com/" class="navbar-item" target="_blank" rel="noopener nofollow noreferrer ">Support</a>
        </li>
        <li role="menuitem" class="main-menu-item">
          <a href="https://konghq.com/community/" class="navbar-item" target="_blank" rel="noopener noreferrer">Community</a>
        </li>
        <li role="menuitem" class="main-menu-item">
          <a href="https://education.konghq.com" class="navbar-item" target="_blank" rel="noopener nofollow noreferrer ">Kong Academy</a>
        </li>
      </ul>
      <a id="top-cta" href="https://konghq.com/contact-sales?utm_source=docs.konghq.com" class="navbar-button" target="_blank" rel="noopener nofollow noreferrer ">
        Get a Demo
      </a>
      <a id="konnect-cta" href="https://konghq.com/products/kong-konnect/register?utm_medium=referral&amp;utm_source=docs&amp;utm_campaign=gateway-konnect&amp;utm_content=top-nav" class="navbar-button" target="_blank" rel="noopener nofollow noreferrer ">
        Start Free Trial
      </a>
    </div>
    <div id="navbar-menu-toggle-button" class="small-screen-button" aria-label="Toggle navigation">
      <div></div>
      <div></div>
      <div></div>
    </div>
  </div>
</header>


    

<div class="page v2 " data-url="/gateway/2.7.x/reference/proxy/">
  <div class="page--header-background page--header-background-doc"></div>
  <div class="container">

    <header class="page-header page-header-doc">
      <div class="page-header-product-version">
        <div class="edition">
          Kong Gateway
          
        </div>
        
        <div class="version">
          2.7.x
          
        </div>
        
      </div>
      <div class="page-header--nav">
        <i class="sidebar-toggle"></i>

        
          









  <ul class="breadcrumbs">
    <li class="breadcrumb-item">
      <a href="/">
        <img src="/assets/images/icons/hub-layout/icn-breadcrumbs.svg" alt="Home icon">
      </a>
    </li>
    <li class="breadcrumb-item">
      <a href="/gateway/2.7.x/">Kong Gateway</a>
    </li>

    
    
      

      

      
      

      
      

      
        <li class="breadcrumb-item">
          
          Reference
          
        </li>
      
    
      

      

      
      

      
      

      
    

    
    
    <li class="breadcrumb-item">
      <a href="/gateway/2.7.x/reference/proxy/">Proxy Reference</a>
    </li>
  </ul>

        

        

        <div class="github-links">
  <div class="github-links--edit">
    
      <a href="https://github.com/Kong/docs.konghq.com/edit/main/app/gateway/2.7.x/reference/proxy.md" target="_blank" rel="noopener nofollow noreferrer ">
        <img src="/assets/images/icons/third-party/logo-github-white.svg" alt="github-edit-page">Edit this page
      </a>
    
  </div>
  <div class="github-links--issues">
    <a href="https://github.com/Kong/docs.konghq.com/issues" target="_blank" rel="noopener nofollow noreferrer ">
      <img src="/assets/images/icons/documentation/icn-monitoring-white.svg" alt="report-issue">Report an issue</a>
  </div>
</div>


      </div>
    </header>

    

<aside class="docs-sidebar">
  <i class="fa fa-times close-sidebar"></i>

  <div class="sidebar-title-container">
    <div class="docsets-dropdown dropdown">
      <button class="dropdown-button" id="module-dropdown" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" tabindex="0">
        <span>
          Kong Gateway
          
        </span>
        <span class="caret"></span>
      </button>
      <ul class="dropdown-menu dropdown-menu-right with-submenu" id="module-list" role="menu" aria-labelledby="module-dropdown" aria-hidden="true">

        <li role="menuitem" tabindex="-1" class="active">
          <a href="/gateway/latest/" class="active">Kong Gateway</a>
        </li>
        <li role="menuitem" tabindex="-1">
          <a href="/konnect/">Kong Konnect</a>
        </li>
        <li role="menuitem" tabindex="-1">
          <a href="/mesh/latest/">Kong Mesh</a>
        </li>
        <li role="menuitem" tabindex="-1">
          <a href="/hub/">Plugin Hub</a>
        </li>
        <li role="menuitem" tabindex="-1">
          <a href="/deck/latest/">decK</a>
        </li>
        <li role="menuitem" tabindex="-1">
          <a href="/kubernetes-ingress-controller/latest/">Kong Ingress Controller</a>
        </li>
        <li role="menuitem" tabindex="-1">
          <a href="/gateway-operator/latest/">Kong Gateway Operator</a>
        </li>
        <li>
          <a href="https://docs.insomnia.rest/" target="_blank" rel="noopener nofollow noreferrer ">Insomnia</a>
        </li>
        <li role="menuitem" tabindex="-1">
          <a href="https://kuma.io/docs/" target="_blank" rel="noopener nofollow noreferrer ">Kuma</a>
        </li>
        <hr>
        <li role="menuitem" tabindex="-1">
          <a href="/contributing/">Docs contribution guidelines</a>
        </li>
      </ul>
    </div>

    
    <div class="versions-dropdown dropdown">
      <button class="dropdown-button" id="version-dropdown" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" tabindex="0">
        <span>
          Version 2.7.x
          
        </span>
        <span class="caret"></span>
      </button>
      <ul class="dropdown-menu dropdown-menu-right" id="version-list" role="menu" aria-labelledby="version-dropdown" aria-hidden="true">
          
          
          
          
          
        <li role="menuitem" tabindex="-1">
          <a href="/gateway/3.5.x" data-version-id="3.5.x">
            3.5.x
             <em>(latest)</em>
            
          </a>
        </li>
        
          
          
          
          
        <li role="menuitem" tabindex="-1">
          <a href="/gateway/3.4.x" data-version-id="3.4.x">
            3.4.x
            
          </a>
        </li>
        
          
          
          
          
        <li role="menuitem" tabindex="-1">
          <a href="/gateway/3.3.x" data-version-id="3.3.x">
            3.3.x
            
          </a>
        </li>
        
          
          
          
          
        <li role="menuitem" tabindex="-1">
          <a href="/gateway/3.2.x" data-version-id="3.2.x">
            3.2.x
            
          </a>
        </li>
        
          
          
          
          
        <li role="menuitem" tabindex="-1">
          <a href="/gateway/3.1.x" data-version-id="3.1.x">
            3.1.x
            
          </a>
        </li>
        
          
          
          
          
        <li role="menuitem" tabindex="-1">
          <a href="/gateway/3.0.x" data-version-id="3.0.x">
            3.0.x
            
          </a>
        </li>
        
          
          
          
          
        <li role="menuitem" tabindex="-1">
          <a href="/gateway/2.8.x/reference/proxy/" data-version-id="2.8.x">
            2.8.x
            
          </a>
        </li>
        
          
          
          
          
        <li class="active" role="menuitem" tabindex="-1">
          <a href="/gateway/2.7.x/reference/proxy/" class="active" data-version-id="2.7.x">
            2.7.x
            
          </a>
        </li>
        
          
          
          
          
        <li role="menuitem" tabindex="-1">
          <a href="/gateway/2.6.x/reference/proxy/" data-version-id="2.6.x">
            2.6.x
            
          </a>
        </li>
        
        
        <li role="menuitem" tabindex="-1">
          <a href="https://legacy-gateway--kongdocs.netlify.app/" target="_blank" rel="noopener nofollow noreferrer ">
            Archive (pre-2.6)
          </a>
        </li>
        
      </ul>
    </div>
    
  </div>

  <ul class="sidebar-container" role="tree" aria-label="Documentation">
    
      <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label" aria-expanded="false" aria-owns="id-1-introduction-subtree">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/">
        
  <img src="/assets/images/icons/documentation/icn-flag.svg" alt="">


Introduction

      </a>
    
  </span>

  
    <ul class="items" id="id-1-introduction-subtree" role="group" aria-label="Introduction">
      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/latest/support-policy/">
        

Version Support Policy

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/compatibility/">
        

Compatibility

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/changelog/">
        

Changelog

      </a>
    
  </span>

  
</li>

      
    </ul>
  
</li>

    
      <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label" aria-expanded="false" aria-owns="id-2-install-and-run-subtree">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/install-and-run/">
        
  <img src="/assets/images/icons/documentation/icn-deployment-color.svg" alt="">


Install and Run

      </a>
    
  </span>

  
    <ul class="items" id="id-2-install-and-run-subtree" role="group" aria-label="Install and Run">
      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/install-and-run/kubernetes/">
        

Kubernetes

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/install-and-run/helm/">
        

Helm

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/install-and-run/openshift/">
        

OpenShift with Helm

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/install-and-run/docker/">
        

Docker

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/install-and-run/amazon-linux/">
        

Amazon Linux

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/install-and-run/centos/">
        

CentOS

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/install-and-run/debian/">
        

Debian

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/install-and-run/rhel/">
        

RHEL

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/install-and-run/ubuntu/">
        

Ubuntu

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/install-and-run/migrate-ce-to-ke/">
        

Migrating from OSS to EE

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/install-and-run/upgrade-enterprise/">
        

Upgrade Kong Gateway

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/install-and-run/upgrade-oss/">
        

Upgrade Kong Gateway OSS

      </a>
    
  </span>

  
</li>

      
    </ul>
  
</li>

    
      <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label" aria-expanded="false" aria-owns="id-3-get-started-subtree">
    
      
  <img src="/assets/images/icons/documentation/icn-quickstart-color.svg" alt="">


Get Started


        
          <button class="sidebar-tree-toggle" aria-label="toggle Get Started subtree">
            <i class="fa fa-chevron-down"></i>
          </button>
        
      
  </span>

  
    <ul class="items" id="id-3-get-started-subtree" role="group" aria-label="Get Started">
      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label" aria-expanded="false" aria-owns="id-3-1-quickstart-guide-subtree">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/get-started/quickstart/">
        

Quickstart Guide

      </a>
    
  </span>

  
    <ul class="items" id="id-3-1-quickstart-guide-subtree" role="group" aria-label="Quickstart Guide">
      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/get-started/quickstart/configuring-a-service/">
        

Configuring a Service

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/get-started/quickstart/configuring-a-grpc-service/">
        

Configuring a gRPC Service

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/get-started/quickstart/enabling-plugins/">
        

Enabling Plugins

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/get-started/quickstart/adding-consumers/">
        

Adding Consumers

      </a>
    
  </span>

  
</li>

      
    </ul>
  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label" aria-expanded="false" aria-owns="id-3-2-comprehensive-guide-subtree">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/get-started/comprehensive/">
        

Comprehensive Guide

      </a>
    
  </span>

  
    <ul class="items" id="id-3-2-comprehensive-guide-subtree" role="group" aria-label="Comprehensive Guide">
      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/get-started/comprehensive/prepare/">
        

Prepare to Administer

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/get-started/comprehensive/expose-services/">
        

Expose your Services

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/get-started/comprehensive/protect-services/">
        

Protect your Services

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/get-started/comprehensive/improve-performance/">
        

Improve Performance

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/get-started/comprehensive/secure-services/">
        

Secure Services

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/get-started/comprehensive/load-balancing/">
        

Set Up Intelligent Load Balancing

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/get-started/comprehensive/manage-teams/">
        

Manage Administrative Teams

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/get-started/comprehensive/dev-portal/">
        

Publish, Locate, and Consume Services

      </a>
    
  </span>

  
</li>

      
    </ul>
  
</li>

      
    </ul>
  
</li>

    
      <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label" aria-expanded="false" aria-owns="id-4-plan-and-deploy-subtree">
    
      
  <img src="/assets/images/icons/documentation/icn-deployment-color.svg" alt="">


Plan and Deploy


        
          <button class="sidebar-tree-toggle" aria-label="toggle Plan and Deploy subtree">
            <i class="fa fa-chevron-down"></i>
          </button>
        
      
  </span>

  
    <ul class="items" id="id-4-plan-and-deploy-subtree" role="group" aria-label="Plan and Deploy">
      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/plan-and-deploy/kong-user/">
        

Running Kong as a Non-Root User

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/plan-and-deploy/sizing-guidelines/">
        

Resource Sizing Guidelines

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label" aria-expanded="false" aria-owns="id-4-3-hybrid-mode-subtree">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/plan-and-deploy/hybrid-mode/">
        

Hybrid Mode

      </a>
    
  </span>

  
    <ul class="items" id="id-4-3-hybrid-mode-subtree" role="group" aria-label="Hybrid Mode">
      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/plan-and-deploy/hybrid-mode/hybrid-mode-setup/">
        

Deploy Kong Gateway in Hybrid Mode

      </a>
    
  </span>

  
</li>

      
    </ul>
  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/plan-and-deploy/kubernetes-deployment-options/">
        

Kubernetes Deployment Options

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/plan-and-deploy/systemd/">
        

Control Kong Gateway through systemd

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/plan-and-deploy/performance-testing-framework/">
        

Performance Testing Framework

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/plan-and-deploy/dns-considerations/">
        

DNS Considerations

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/plan-and-deploy/default-ports/">
        

Default Ports

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label" aria-expanded="false" aria-owns="id-4-9-licenses-subtree">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/plan-and-deploy/licenses/">
        

Licenses

      </a>
    
  </span>

  
    <ul class="items" id="id-4-9-licenses-subtree" role="group" aria-label="Licenses">
      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/plan-and-deploy/licenses/access-license/">
        

Access Your License

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/plan-and-deploy/licenses/deploy-license/">
        

Deploy Your License

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/plan-and-deploy/licenses/report/">
        

Monitor License Usage

      </a>
    
  </span>

  
</li>

      
    </ul>
  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label" aria-expanded="false" aria-owns="id-4-10-security-subtree">
    
      

Security


        
          <button class="sidebar-tree-toggle" aria-label="toggle Security subtree">
            <i class="fa fa-chevron-down"></i>
          </button>
        
      
  </span>

  
    <ul class="items" id="id-4-10-security-subtree" role="group" aria-label="Security">
      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/plan-and-deploy/security/start-kong-securely/">
        

Start Kong Gateway Securely

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/plan-and-deploy/security/db-encryption/">
        

Keyring and Data Encryption

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/plan-and-deploy/security/kong-security-update-process/">
        

Kong Security Update Process

      </a>
    
  </span>

  
</li>

      
    </ul>
  
</li>

      
    </ul>
  
</li>

    
      <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label" aria-expanded="false" aria-owns="id-5-configure-subtree">
    
      
  <img src="/assets/images/icons/konnect/konnect-settings.svg" alt="">


Configure


        
          <button class="sidebar-tree-toggle" aria-label="toggle Configure subtree">
            <i class="fa fa-chevron-down"></i>
          </button>
        
      
  </span>

  
    <ul class="items" id="id-5-configure-subtree" role="group" aria-label="Configure">
      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label" aria-expanded="false" aria-owns="id-5-1-authentication-and-authorization-subtree">
    
      

Authentication and Authorization


        
          <button class="sidebar-tree-toggle" aria-label="toggle Authentication and Authorization subtree">
            <i class="fa fa-chevron-down"></i>
          </button>
        
      
  </span>

  
    <ul class="items" id="id-5-1-authentication-and-authorization-subtree" role="group" aria-label="Authentication and Authorization">
      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/configure/auth/">
        

Authentication Reference

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label" aria-expanded="false" aria-owns="id-5-1-2-openid-connect-plugin-subtree">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/configure/auth/oidc-use-case/">
        

OpenID Connect Plugin

      </a>
    
  </span>

  
    <ul class="items" id="id-5-1-2-openid-connect-plugin-subtree" role="group" aria-label="OpenID Connect Plugin">
      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/configure/auth/oidc-curity/">
        

OpenID Connect with Curity

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/configure/auth/oidc-azuread/">
        

OpenID Connect with Azure AD

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/configure/auth/oidc-google/">
        

OpenID Connect with Google

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/configure/auth/oidc-okta/">
        

OpenID Connect with Okta

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/configure/auth/oidc-auth0/">
        

OpenID Connect with Auth0

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/configure/auth/oidc-cognito/">
        

OpenID Connect with Cognito

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/hub/kong-inc/openid-connect/">
        

OpenID Connect Plugin Reference

      </a>
    
  </span>

  
</li>

      
    </ul>
  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/configure/auth/allowing-multiple-authentication-methods/">
        

Allowing Multiple Authentication Methods

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label" aria-expanded="false" aria-owns="id-5-1-4-auth-for-kong-manager-subtree">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/configure/auth/kong-manager/">
        

Auth for Kong Manager

      </a>
    
  </span>

  
    <ul class="items" id="id-5-1-4-auth-for-kong-manager-subtree" role="group" aria-label="Auth for Kong Manager">
      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/configure/auth/kong-manager/super-admin/">
        

Create a Super Admin

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/configure/auth/kong-manager/networking/">
        

Configure Networking

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/configure/auth/kong-manager/email/">
        

Configure Kong Manager to Send Email

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/configure/auth/kong-manager/reset-password/">
        

Reset Passwords and RBAC Tokens

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/configure/auth/kong-manager/workspaces/">
        

Configure Workspaces

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/configure/auth/kong-manager/basic/">
        

Basic Auth

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/configure/auth/kong-manager/ldap/">
        

LDAP

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/configure/auth/kong-manager/oidc-mapping/">
        

OIDC

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/configure/auth/kong-manager/sessions/">
        

Sessions

      </a>
    
  </span>

  
</li>

      
    </ul>
  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label" aria-expanded="false" aria-owns="id-5-1-5-role-based-access-control-rbac-subtree">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/configure/auth/rbac/">
        

Role-based Access Control (RBAC)

      </a>
    
  </span>

  
    <ul class="items" id="id-5-1-5-role-based-access-control-rbac-subtree" role="group" aria-label="Role-based Access Control (RBAC)">
      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/configure/auth/rbac/add-role/">
        

Add a Role

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/configure/auth/rbac/add-user/">
        

Add a User

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/configure/auth/rbac/add-admin/">
        

Add an Admin

      </a>
    
  </span>

  
</li>

      
    </ul>
  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/configure/auth/service-directory-mapping/">
        

Mapping LDAP Service Directory Groups to Kong Roles

      </a>
    
  </span>

  
</li>

      
    </ul>
  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label" aria-expanded="false" aria-owns="id-5-2-kong-dev-portal-subtree">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/developer-portal/">
        

Kong Dev Portal

      </a>
    
  </span>

  
    <ul class="items" id="id-5-2-kong-dev-portal-subtree" role="group" aria-label="Kong Dev Portal">
      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/developer-portal/enable-dev-portal/">
        

Enable the Dev Portal

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/developer-portal/structure-and-file-types/">
        

Structure and File Types

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/dev-portal/api/v1/">
        

Portal API Documentation

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/developer-portal/working-with-templates/">
        

Working with Templates

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/developer-portal/using-the-editor/">
        

Using the Editor

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label" aria-expanded="false" aria-owns="id-5-2-6-configuration-subtree">
    
      

Configuration


        
          <button class="sidebar-tree-toggle" aria-label="toggle Configuration subtree">
            <i class="fa fa-chevron-down"></i>
          </button>
        
      
  </span>

  
    <ul class="items" id="id-5-2-6-configuration-subtree" role="group" aria-label="Configuration">
      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label" aria-expanded="false" aria-owns="id-5-2-6-1-authentication-subtree">
    
      

Authentication


        
          <button class="sidebar-tree-toggle" aria-label="toggle Authentication subtree">
            <i class="fa fa-chevron-down"></i>
          </button>
        
      
  </span>

  
    <ul class="items" id="id-5-2-6-1-authentication-subtree" role="group" aria-label="Authentication">
      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/developer-portal/configuration/authentication/basic-auth/">
        

Basic Auth

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/developer-portal/configuration/authentication/key-auth/">
        

Key Auth

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/developer-portal/configuration/authentication/oidc/">
        

OIDC

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/developer-portal/configuration/authentication/sessions/">
        

Sessions

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/developer-portal/configuration/authentication/adding-registration-fields/">
        

Adding Custom Registration Fields

      </a>
    
  </span>

  
</li>

      
    </ul>
  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/developer-portal/configuration/smtp/">
        

SMTP

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/developer-portal/configuration/workspaces/">
        

Workspaces

      </a>
    
  </span>

  
</li>

      
    </ul>
  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label" aria-expanded="false" aria-owns="id-5-2-7-administration-subtree">
    
      

Administration


        
          <button class="sidebar-tree-toggle" aria-label="toggle Administration subtree">
            <i class="fa fa-chevron-down"></i>
          </button>
        
      
  </span>

  
    <ul class="items" id="id-5-2-7-administration-subtree" role="group" aria-label="Administration">
      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/developer-portal/administration/managing-developers/">
        

Manage Developers

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/developer-portal/administration/developer-permissions/">
        

Developer Roles and Content Permissions

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label" aria-expanded="false" aria-owns="id-5-2-7-3-application-registration-subtree">
    
      

Application Registration


        
          <button class="sidebar-tree-toggle" aria-label="toggle Application Registration subtree">
            <i class="fa fa-chevron-down"></i>
          </button>
        
      
  </span>

  
    <ul class="items" id="id-5-2-7-3-application-registration-subtree" role="group" aria-label="Application Registration">
      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/developer-portal/administration/application-registration/auth-provider-strategy/">
        

Authorization Provider Strategy

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/developer-portal/administration/application-registration/enable-application-registration/">
        

Enable Application Registration

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/developer-portal/administration/application-registration/enable-key-auth-plugin/">
        

Enable Key Authentication for Application Registration

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/developer-portal/administration/application-registration/3rd-party-oauth/">
        

External OAuth2 Support

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/developer-portal/administration/application-registration/okta-config/">
        

Set up Okta and Kong for external OAuth

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/developer-portal/administration/application-registration/azure-oidc-config/">
        

Set Up Azure AD and Kong for External Authentication

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/developer-portal/administration/application-registration/managing-applications/">
        

Manage Applications

      </a>
    
  </span>

  
</li>

      
    </ul>
  
</li>

      
    </ul>
  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label" aria-expanded="false" aria-owns="id-5-2-8-customization-subtree">
    
      

Customization


        
          <button class="sidebar-tree-toggle" aria-label="toggle Customization subtree">
            <i class="fa fa-chevron-down"></i>
          </button>
        
      
  </span>

  
    <ul class="items" id="id-5-2-8-customization-subtree" role="group" aria-label="Customization">
      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/developer-portal/theme-customization/easy-theme-editing/">
        

Easy Theme Editing

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/developer-portal/theme-customization/migrating-templates/">
        

Migrating Templates Between Workspaces

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/developer-portal/theme-customization/markdown-extended/">
        

Markdown Rendering Module

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/developer-portal/theme-customization/emails/">
        

Customizing Portal Emails

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/developer-portal/theme-customization/adding-javascript-assets/">
        

Adding and Using JavaScript Assets

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/developer-portal/theme-customization/single-page-app/">
        

Single Page App in Dev Portal

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/developer-portal/theme-customization/alternate-openapi-renderer/">
        

Alternate OpenAPI Renderer

      </a>
    
  </span>

  
</li>

      
    </ul>
  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/developer-portal/helpers/cli/">
        

Helpers CLI

      </a>
    
  </span>

  
</li>

      
    </ul>
  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/configure/grpc/">
        

Configure gRPC Plugins

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/configure/graphql-quickstart/">
        

GraphQL Quickstart

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/configure/logging/">
        

Logging Reference

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/configure/network/">
        

Network and Firewall

      </a>
    
  </span>

  
</li>

      
    </ul>
  
</li>

    
      <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label" aria-expanded="false" aria-owns="id-6-monitor-subtree">
    
      
  <img src="/assets/images/icons/documentation/icn-vitals.svg" alt="">


Monitor


        
          <button class="sidebar-tree-toggle" aria-label="toggle Monitor subtree">
            <i class="fa fa-chevron-down"></i>
          </button>
        
      
  </span>

  
    <ul class="items" id="id-6-monitor-subtree" role="group" aria-label="Monitor">
      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label" aria-expanded="false" aria-owns="id-6-1-kong-vitals-subtree">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/vitals/">
        

Kong Vitals

      </a>
    
  </span>

  
    <ul class="items" id="id-6-1-kong-vitals-subtree" role="group" aria-label="Kong Vitals">
      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/vitals/vitals-metrics/">
        

Metrics

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/vitals/vitals-reports/">
        

Reports

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/vitals/vitals-influx-strategy/">
        

Vitals with InfluxDB

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/vitals/vitals-prometheus-strategy/">
        

Vitals with Prometheus

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/vitals/vitals-estimates/">
        

Estimate Vitals Storage in PostgreSQL

      </a>
    
  </span>

  
</li>

      
    </ul>
  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/hub/kong-inc/prometheus/">
        

Prometheus plugin

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/hub/kong-inc/zipkin/">
        

Zipkin plugin

      </a>
    
  </span>

  
</li>

      
    </ul>
  
</li>

    
      <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label" aria-expanded="false" aria-owns="id-7-reference-subtree">
    
      
  <img src="/assets/images/icons/documentation/icn-references-color.svg" alt="">


Reference


        
          <button class="sidebar-tree-toggle" aria-label="toggle Reference subtree">
            <i class="fa fa-chevron-down"></i>
          </button>
        
      
  </span>

  
    <ul class="items" id="id-7-reference-subtree" role="group" aria-label="Reference">
      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label" aria-expanded="false" aria-owns="id-7-1-admin-api-subtree">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/admin-api/">
        

Admin API

      </a>
    
  </span>

  
    <ul class="items" id="id-7-1-admin-api-subtree" role="group" aria-label="Admin API">
      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/admin-api/#db-less-mode">
        

DB-less Mode

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/admin-api/#declarative-configuration">
        

Declarative Configuration

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/admin-api/#supported-content-types">
        

Supported Content Types

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/admin-api/#information-routes">
        

Information Routes

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/admin-api/#health-routes">
        

Health Routes

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/admin-api/#tags">
        

Tags

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/admin-api/#service-object">
        

Service Object

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/admin-api/#route-object">
        

Route Object

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/admin-api/#consumer-object">
        

Consumer Object

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/admin-api/#plugin-object">
        

Plugin Object

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/admin-api/#certificate-object">
        

Certificate Object

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/admin-api/#ca-certificate-object">
        

CA Certificate Object

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/admin-api/#sni-object">
        

SNI Object

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/admin-api/#upstream-object">
        

Upstream Object

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/admin-api/#target-object">
        

Target Object

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label" aria-expanded="false" aria-owns="id-7-1-16-licenses-subtree">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/admin-api/licenses/reference/">
        

Licenses

      </a>
    
  </span>

  
    <ul class="items" id="id-7-1-16-licenses-subtree" role="group" aria-label="Licenses">
      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/admin-api/licenses/reference/">
        

Licenses Reference

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/admin-api/licenses/examples/">
        

Licenses Examples

      </a>
    
  </span>

  
</li>

      
    </ul>
  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label" aria-expanded="false" aria-owns="id-7-1-17-workspaces-subtree">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/admin-api/workspaces/reference/">
        

Workspaces

      </a>
    
  </span>

  
    <ul class="items" id="id-7-1-17-workspaces-subtree" role="group" aria-label="Workspaces">
      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/admin-api/workspaces/reference/">
        

Workspaces Reference

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/admin-api/workspaces/examples/">
        

Workspace Examples

      </a>
    
  </span>

  
</li>

      
    </ul>
  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label" aria-expanded="false" aria-owns="id-7-1-18-rbac-subtree">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/admin-api/rbac/reference/">
        

RBAC

      </a>
    
  </span>

  
    <ul class="items" id="id-7-1-18-rbac-subtree" role="group" aria-label="RBAC">
      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/admin-api/rbac/reference/">
        

RBAC Reference

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/admin-api/rbac/examples/">
        

RBAC Examples

      </a>
    
  </span>

  
</li>

      
    </ul>
  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label" aria-expanded="false" aria-owns="id-7-1-19-admins-subtree">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/admin-api/admins/reference/">
        

Admins

      </a>
    
  </span>

  
    <ul class="items" id="id-7-1-19-admins-subtree" role="group" aria-label="Admins">
      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/admin-api/admins/reference/">
        

API Reference

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/admin-api/admins/examples/">
        

Examples

      </a>
    
  </span>

  
</li>

      
    </ul>
  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label" aria-expanded="false" aria-owns="id-7-1-20-consumer-groups-subtree">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/admin-api/consumer-groups/reference/">
        

Consumer Groups

      </a>
    
  </span>

  
    <ul class="items" id="id-7-1-20-consumer-groups-subtree" role="group" aria-label="Consumer Groups">
      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/admin-api/consumer-groups/reference/">
        

API Reference

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/admin-api/consumer-groups/examples/">
        

Examples

      </a>
    
  </span>

  
</li>

      
    </ul>
  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label" aria-expanded="false" aria-owns="id-7-1-21-event-hooks-subtree">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/admin-api/event-hooks/reference/">
        

Event Hooks

      </a>
    
  </span>

  
    <ul class="items" id="id-7-1-21-event-hooks-subtree" role="group" aria-label="Event Hooks">
      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/admin-api/event-hooks/reference/">
        

Event Hooks Reference

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/admin-api/event-hooks/examples/">
        

Examples

      </a>
    
  </span>

  
</li>

      
    </ul>
  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/admin-api/audit-log/">
        

Audit Logging

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/admin-api/db-encryption/">
        

Keyring and Data Encryption

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/admin-api/secure-admin-api/">
        

Securing the Admin API

      </a>
    
  </span>

  
</li>

      
    </ul>
  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/reference/db-less-and-declarative-config/">
        

DB-less and Declarative Configuration

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/reference/configuration/">
        

Configuration Reference

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/reference/cli/">
        

CLI Reference

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/reference/loadbalancing/">
        

Load Balancing Reference

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/reference/proxy/">
        

Proxy Reference

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/reference/rate-limiting/">
        

Rate Limiting Library

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/reference/health-checks-circuit-breakers/">
        

Health Checks and Circuit Breakers Reference

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/reference/clustering/">
        

Clustering Reference

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label" aria-expanded="false" aria-owns="id-7-10-plugin-development-kit-subtree">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/pdk/">
        

Plugin Development Kit

      </a>
    
  </span>

  
    <ul class="items" id="id-7-10-plugin-development-kit-subtree" role="group" aria-label="Plugin Development Kit">
      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/pdk/kong.client/">
        

kong.client

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/pdk/kong.client.tls/">
        

kong.client.tls

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/pdk/kong.cluster/">
        

kong.cluster

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/pdk/kong.ctx/">
        

kong.ctx

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/pdk/kong.ip/">
        

kong.ip

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/pdk/kong.log/">
        

kong.log

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/pdk/kong.nginx/">
        

kong.nginx

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/pdk/kong.node/">
        

kong.node

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/pdk/kong.request/">
        

kong.request

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/pdk/kong.response/">
        

kong.response

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/pdk/kong.router/">
        

kong.router

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/pdk/kong.service/">
        

kong.service

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/pdk/kong.service.request/">
        

kong.service.request

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/pdk/kong.service.response/">
        

kong.service.response

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/pdk/kong.table/">
        

kong.table

      </a>
    
  </span>

  
</li>

      
    </ul>
  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label" aria-expanded="false" aria-owns="id-7-11-plugin-development-guide-subtree">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/plugin-development/">
        

Plugin Development Guide

      </a>
    
  </span>

  
    <ul class="items" id="id-7-11-plugin-development-guide-subtree" role="group" aria-label="Plugin Development Guide">
      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/plugin-development/">
        

Introduction

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/plugin-development/file-structure/">
        

File structure

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/plugin-development/custom-logic/">
        

Implementing custom logic

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/plugin-development/plugin-configuration/">
        

Plugin configuration

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/plugin-development/access-the-datastore/">
        

Accessing the datastore

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/plugin-development/custom-entities/">
        

Storing custom entities

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/plugin-development/entities-cache/">
        

Caching custom entities

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/plugin-development/admin-api/">
        

Extending the Admin API

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/plugin-development/tests/">
        

Writing tests

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/plugin-development/distribution/">
        

(un)Installing your plugin

      </a>
    
  </span>

  
</li>

      
    </ul>
  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/2.7.x/reference/external-plugins/">
        

Plugins in Other Languages

      </a>
    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/gateway/3.0.x/reference/file-access-permissions/">
        

File Permissions Reference

      </a>
    
  </span>

  
</li>

      
    </ul>
  
</li>

    
  </ul>
</aside>




      <aside class="docs-toc">
        <i class="fa fa-times close-sidebar"></i>
        <i class="fa fa-chevron-right collapse-toc"></i>
        <i class="far fa-list-alt expand-toc"></i>

        <div id="oss-ee-toggle" data-current="Enterprise" style="display: none">
          <span class="oss-ee-toggle-inner">
            <img src="/assets/images/icons/icn-enterprise-black.svg" alt="enterprise-switcher-icon">
            <span>Switch to <span id="switch-to-version">OSS</span></span>
          </span>
        </div>

        
        <div class="docs-toc-title">
<img src="/assets/images/icons/hub-layout/icn-on-this-page.svg" alt="On this page"><a href="#">On this page</a>
</div>
<ul>
  <li><a href="#terminology" class="active scroll-to">Terminology</a></li>
  <li><a href="#overview" class="scroll-to">Overview</a></li>
  <li><a href="#how-to-configure-a-service" class="scroll-to">How to configure a Service</a></li>
  <li>
<a href="#routes-and-matching-capabilities" class="scroll-to">Routes and matching capabilities</a>
    <ul>
      <li><a href="#request-header" class="scroll-to">Request header</a></li>
      <li><a href="#additional-request-headers" class="scroll-to">Additional request headers</a></li>
      <li><a href="#request-path" class="scroll-to">Request path</a></li>
      <li><a href="#request-http-method" class="scroll-to">Request HTTP method</a></li>
      <li><a href="#request-source" class="scroll-to">Request source</a></li>
      <li><a href="#request-destination" class="scroll-to">Request destination</a></li>
      <li><a href="#request-sni" class="scroll-to">Request SNI</a></li>
    </ul>
  </li>
  <li><a href="#matching-priorities" class="scroll-to">Matching priorities</a></li>
  <li>
<a href="#proxying-behavior" class="scroll-to">Proxying behavior</a>
    <ul>
      <li><a href="#1-load-balancing" class="scroll-to">1. Load balancing</a></li>
      <li><a href="#2-plugins-execution" class="scroll-to">2. Plugins execution</a></li>
      <li><a href="#3-proxying-and-upstream-timeouts" class="scroll-to">3. Proxying and upstream timeouts</a></li>
      <li><a href="#4-errors-and-retries" class="scroll-to">4. Errors and retries</a></li>
      <li><a href="#5-response" class="scroll-to">5. Response</a></li>
    </ul>
  </li>
  <li><a href="#configuring-a-fallback-route" class="scroll-to">Configuring a fallback Route</a></li>
  <li>
<a href="#configuring-tls-for-a-route" class="scroll-to">Configuring TLS for a Route</a>
    <ul>
      <li><a href="#restricting-the-client-protocol" class="scroll-to">Restricting the client protocol</a></li>
    </ul>
  </li>
  <li>
<a href="#proxy-websocket-traffic" class="scroll-to">Proxy WebSocket traffic</a>
    <ul>
      <li><a href="#websocket-and-tls" class="scroll-to">WebSocket and TLS</a></li>
    </ul>
  </li>
  <li><a href="#proxy-grpc-traffic" class="scroll-to">Proxy gRPC traffic</a></li>
  <li><a href="#proxy-tcptls-traffic" class="scroll-to">Proxy TCP/TLS traffic</a></li>
  <li><a href="#proxy-tls-passthrough-traffic" class="scroll-to">Proxy TLS passthrough traffic</a></li>
  <li><a href="#conclusion" class="scroll-to">Conclusion</a></li>
</ul>

        
      </aside>

    <div class="page-content-container page-content-container-doc v2 " id="documentation">
      <div class="toggles ">
          <i class="far fa-list-alt toc-sidebar-toggle"></i>
      </div>

      <div class="page-content">
        <div class="content show-anchor-links">
          
              <blockquote id="version-notice" class="important">
                
                You are browsing documentation for an outdated version.
                
                See the <a href="/gateway/latest/how-kong-works/routing-traffic/">latest documentation here</a>.
              </blockquote>
          

          <h1 tabindex="-1" id="main" class="page-content-title">Proxy Reference
            

            
          </h1>

          

          
          

          <p>In this document we will cover Kong’s <strong>proxying capabilities</strong>  by explaining
its routing capabilities and internal workings in details.</p>

<p>Kong exposes several interfaces which can be tweaked by the following configuration
properties:</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">proxy_listen</code>, which defines a list of addresses/ports on which Kong will
accept <strong>public HTTP (gRPC, WebSocket, etc) traffic</strong> from clients and proxy
it to your upstream services (<code class="language-plaintext highlighter-rouge">8000</code> by default).</li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">admin_listen</code>, which also defines a list of addresses and ports, but those
should be restricted to only be accessed by administrators, as they expose
Kong’s configuration capabilities: the <strong>Admin API</strong> (<code class="language-plaintext highlighter-rouge">8001</code> by default).</p>

    <blockquote class="important">
      <p><strong>Important</strong>: If you need to expose the <code class="language-plaintext highlighter-rouge">admin_listen</code> port to the internet in a production environment,</p>

      <p><a href="/gateway/2.7.x/admin-api/secure-admin-api/">secure it with authentication</a>.</p>
    </blockquote>
  </li>
  <li>
<code class="language-plaintext highlighter-rouge">stream_listen</code>, which is similar to <code class="language-plaintext highlighter-rouge">proxy_listen</code> but for Layer 4 (TCP, TLS)
generic proxy. This is turned off by default.</li>
</ul>

<h2 id="terminology">Terminology</h2>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">client</code>: Refers to the <em>downstream</em> client making requests to Kong’s
proxy port.</li>
  <li>
<code class="language-plaintext highlighter-rouge">upstream service</code>: Refers to your own API/service sitting behind Kong, to
which client requests/connections are forwarded.</li>
  <li>
<code class="language-plaintext highlighter-rouge">Service</code>: Service entities, as the name implies, are abstractions of each of
your own upstream services. Examples of Services would be a data
transformation microservice, a billing API, etc.</li>
  <li>
<code class="language-plaintext highlighter-rouge">Route</code>: This refers to the Kong Routes entity. Routes are entrypoints into
Kong, and defining rules for a request to be matched, and routed to a given
Service.</li>
  <li>
<code class="language-plaintext highlighter-rouge">Plugin</code>: This refers to Kong “plugins”, which are pieces of business logic
that run in the proxying lifecycle. Plugins can be configured through the
Admin API - either globally (all incoming traffic) or on specific Routes
and Services.</li>
</ul>

<h2 id="overview">Overview</h2>

<p>From a high-level perspective, Kong listens for HTTP traffic on its configured
proxy port(s) (<code class="language-plaintext highlighter-rouge">8000</code> and <code class="language-plaintext highlighter-rouge">8443</code> by default) and L4 traffic on explicitly configured
<code class="language-plaintext highlighter-rouge">stream_listen</code> ports. Kong will evaluate any incoming
HTTP request or L4 connection against the Routes you have configured and try to find a matching
one. If a given request matches the rules of a specific Route, Kong will
process proxying the request.</p>

<p>Because each Route may be linked to a Service, Kong will run the plugins you
have configured on your Route and its associated Service, and then proxy the
request upstream. You can manage Routes via Kong’s Admin API. Routes have
special attributes that are used for routing - matching incoming HTTP requests.
Routing attributes differ by subsystem (HTTP/HTTPS, gRPC/gRPCS, and TCP/TLS).</p>

<p>Subsystems and routing attributes:</p>
<ul>
  <li>
<code class="language-plaintext highlighter-rouge">http</code>: <code class="language-plaintext highlighter-rouge">methods</code>, <code class="language-plaintext highlighter-rouge">hosts</code>, <code class="language-plaintext highlighter-rouge">headers</code>, <code class="language-plaintext highlighter-rouge">paths</code> (and <code class="language-plaintext highlighter-rouge">snis</code>, if <code class="language-plaintext highlighter-rouge">https</code>)</li>
  <li>
<code class="language-plaintext highlighter-rouge">tcp</code>: <code class="language-plaintext highlighter-rouge">sources</code>, <code class="language-plaintext highlighter-rouge">destinations</code> (and <code class="language-plaintext highlighter-rouge">snis</code>, if <code class="language-plaintext highlighter-rouge">tls</code>)</li>
  <li>
<code class="language-plaintext highlighter-rouge">grpc</code>: <code class="language-plaintext highlighter-rouge">hosts</code>, <code class="language-plaintext highlighter-rouge">headers</code>, <code class="language-plaintext highlighter-rouge">paths</code> (and <code class="language-plaintext highlighter-rouge">snis</code>, if <code class="language-plaintext highlighter-rouge">grpcs</code>)</li>
</ul>

<p>If one attempts to configure a Route with a routing attribute it doesn’t support
(e.g., an <code class="language-plaintext highlighter-rouge">http</code> route with <code class="language-plaintext highlighter-rouge">sources</code> or <code class="language-plaintext highlighter-rouge">destinations</code> fields), an error message
will be reported:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>HTTP/1.1 400 Bad Request
Content-Type: application/json
Server: kong/&lt;x.x.x&gt;

{
    "code": 2,
    "fields": {
        "sources": "cannot set 'sources' when 'protocols' is 'http' or 'https'"
    },
    "message": "schema violation (sources: cannot set 'sources' when 'protocols' is 'http' or 'https')",
    "name": "schema violation"
}
</code></pre></div></div>

<p>If Kong receives a request that it cannot match against any of the configured
Routes (or if no Routes are configured), it will respond with:</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">404</span> <span class="ne">Not Found</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>
<span class="na">Server</span><span class="p">:</span> <span class="s">kong/&lt;x.x.x&gt;</span>

<span class="p">{</span><span class="w">
    </span><span class="nl">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"no route and no Service found with those values"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h2 id="how-to-configure-a-service">How to configure a Service</h2>

<p>The <a href="/gateway/2.7.x/get-started/quickstart/configuring-a-service">Configuring a Service</a> quickstart guide explains
how Kong is configured via the <a href="/gateway/2.7.x/admin-api">Admin API</a>.</p>

<p>Adding a Service to Kong is done by sending an HTTP request to the Admin API:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>curl <span class="nt">-i</span> <span class="nt">-X</span> POST http://localhost:8001/services/ <span class="se">\</span>
    <span class="nt">-d</span> <span class="s1">'name=foo-service'</span> <span class="se">\</span>
    <span class="nt">-d</span> <span class="s1">'url=http://foo-service.com'</span>
HTTP/1.1 201 Created
...

<span class="o">{</span>
    <span class="s2">"connect_timeout"</span>: 60000,
    <span class="s2">"created_at"</span>: 1515537771,
    <span class="s2">"host"</span>: <span class="s2">"foo-service.com"</span>,
    <span class="s2">"id"</span>: <span class="s2">"d54da06c-d69f-4910-8896-915c63c270cd"</span>,
    <span class="s2">"name"</span>: <span class="s2">"foo-service"</span>,
    <span class="s2">"path"</span>: <span class="s2">"/"</span>,
    <span class="s2">"port"</span>: 80,
    <span class="s2">"protocol"</span>: <span class="s2">"http"</span>,
    <span class="s2">"read_timeout"</span>: 60000,
    <span class="s2">"retries"</span>: 5,
    <span class="s2">"updated_at"</span>: 1515537771,
    <span class="s2">"write_timeout"</span>: 60000
<span class="o">}</span>
</code></pre></div></div>

<p>This request instructs Kong to register a Service named “foo-service”, which
points to <code class="language-plaintext highlighter-rouge">http://foo-service.com</code> (your upstream).</p>

<p><strong>Note:</strong> The <code class="language-plaintext highlighter-rouge">url</code> argument is a shorthand argument to populate the
<code class="language-plaintext highlighter-rouge">protocol</code>, <code class="language-plaintext highlighter-rouge">host</code>, <code class="language-plaintext highlighter-rouge">port</code>, and <code class="language-plaintext highlighter-rouge">path</code> attributes at once.</p>

<p>Now, in order to send traffic to this Service through Kong, we need to specify
a Route, which acts as an entry point to Kong:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>curl <span class="nt">-i</span> <span class="nt">-X</span> POST http://localhost:8001/routes/ <span class="se">\</span>
    <span class="nt">-d</span> <span class="s1">'hosts[]=example.com'</span> <span class="se">\</span>
    <span class="nt">-d</span> <span class="s1">'paths[]=/foo'</span> <span class="se">\</span>
    <span class="nt">-d</span> <span class="s1">'service.id=d54da06c-d69f-4910-8896-915c63c270cd'</span>
HTTP/1.1 201 Created
...

<span class="o">{</span>
    <span class="s2">"created_at"</span>: 1515539858,
    <span class="s2">"hosts"</span>: <span class="o">[</span>
        <span class="s2">"example.com"</span>
    <span class="o">]</span>,
    <span class="s2">"id"</span>: <span class="s2">"ee794195-6783-4056-a5cc-a7e0fde88c81"</span>,
    <span class="s2">"methods"</span>: null,
    <span class="s2">"paths"</span>: <span class="o">[</span>
        <span class="s2">"/foo"</span>
    <span class="o">]</span>,
    <span class="s2">"preserve_host"</span>: <span class="nb">false</span>,
    <span class="s2">"priority"</span>: 0,
    <span class="s2">"protocols"</span>: <span class="o">[</span>
        <span class="s2">"http"</span>,
        <span class="s2">"https"</span>
    <span class="o">]</span>,
    <span class="s2">"service"</span>: <span class="o">{</span>
        <span class="s2">"id"</span>: <span class="s2">"d54da06c-d69f-4910-8896-915c63c270cd"</span>
    <span class="o">}</span>,
    <span class="s2">"strip_path"</span>: <span class="nb">true</span>,
    <span class="s2">"updated_at"</span>: 1515539858
<span class="o">}</span>
</code></pre></div></div>

<p>We have now configured a Route to match incoming requests matching the given
<code class="language-plaintext highlighter-rouge">hosts</code> and <code class="language-plaintext highlighter-rouge">paths</code>, and forward them to the <code class="language-plaintext highlighter-rouge">foo-service</code> we configured, thus
proxying this traffic to <code class="language-plaintext highlighter-rouge">http://foo-service.com</code>.</p>

<p>Kong is a transparent proxy, and it will by default forward the request to your
upstream service untouched, with the exception of various headers such as
<code class="language-plaintext highlighter-rouge">Connection</code>, <code class="language-plaintext highlighter-rouge">Date</code>, and others as required by the HTTP specifications.</p>

<h2 id="routes-and-matching-capabilities">Routes and matching capabilities</h2>

<p>Let’s now discuss how Kong matches a request against the configured routing
attributes.</p>

<p>Kong supports native proxying of HTTP/HTTPS, TCL/TLS, and GRPC/GRPCS protocols;
as mentioned earlier, each of these protocols accept a different set of routing
attributes:</p>
<ul>
  <li>
<code class="language-plaintext highlighter-rouge">http</code>: <code class="language-plaintext highlighter-rouge">methods</code>, <code class="language-plaintext highlighter-rouge">hosts</code>, <code class="language-plaintext highlighter-rouge">headers</code>, <code class="language-plaintext highlighter-rouge">paths</code> (and <code class="language-plaintext highlighter-rouge">snis</code>, if <code class="language-plaintext highlighter-rouge">https</code>)</li>
  <li>
<code class="language-plaintext highlighter-rouge">tcp</code>: <code class="language-plaintext highlighter-rouge">sources</code>, <code class="language-plaintext highlighter-rouge">destinations</code> (and <code class="language-plaintext highlighter-rouge">snis</code>, if <code class="language-plaintext highlighter-rouge">tls</code>)</li>
  <li>
<code class="language-plaintext highlighter-rouge">grpc</code>: <code class="language-plaintext highlighter-rouge">hosts</code>, <code class="language-plaintext highlighter-rouge">headers</code>, <code class="language-plaintext highlighter-rouge">paths</code> (and <code class="language-plaintext highlighter-rouge">snis</code>, if <code class="language-plaintext highlighter-rouge">grpcs</code>)</li>
</ul>

<p>Note that all of these fields are <strong>optional</strong>, but at least <strong>one of them</strong>
must be specified.</p>

<p>For a request to match a Route:</p>

<ul>
  <li>The request <strong>must</strong> include <strong>all</strong> of the configured fields</li>
  <li>The values of the fields in the request <strong>must</strong> match at least one of the
configured values (While the field configurations accepts one or more values,
a request needs only one of the values to be considered a match)</li>
</ul>

<p>Let’s go through a few examples. Consider a Route configured like this:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"hosts"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"example.com"</span><span class="p">,</span><span class="w"> </span><span class="s2">"foo-service.com"</span><span class="p">],</span><span class="w">
    </span><span class="nl">"paths"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"/foo"</span><span class="p">,</span><span class="w"> </span><span class="s2">"/bar"</span><span class="p">],</span><span class="w">
    </span><span class="nl">"methods"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"GET"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Some of the possible requests matching this Route would look like:</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/foo</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">example.com</span>
</code></pre></div></div>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/bar</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">foo-service.com</span>
</code></pre></div></div>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/foo/hello/world</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">example.com</span>
</code></pre></div></div>

<p>All three of these requests satisfy all the conditions set in the Route
definition.</p>

<p>However, the following requests would <strong>not</strong> match the configured conditions:</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">example.com</span>
</code></pre></div></div>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">POST</span> <span class="nn">/foo</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">example.com</span>
</code></pre></div></div>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/foo</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">foo.com</span>
</code></pre></div></div>

<p>All three of these requests satisfy only two of configured conditions. The
first request’s path is not a match for any of the configured <code class="language-plaintext highlighter-rouge">paths</code>, same for
the second request’s HTTP method, and the third request’s Host header.</p>

<p>Now that we understand how the routing properties work together, let’s explore
each property individually.</p>

<h3 id="request-header">Request header</h3>

<p>Kong supports routing by arbitrary HTTP headers. A special case of this
feature is routing by the Host header.</p>

<p>Routing a request based on its Host header is the most straightforward way to
proxy traffic through Kong, especially since this is the intended usage of the
HTTP Host header. Kong makes it easy to do via the <code class="language-plaintext highlighter-rouge">hosts</code> field of the Route
entity.</p>

<p><code class="language-plaintext highlighter-rouge">hosts</code> accepts multiple values, which must be comma-separated when specifying
them via the Admin API, and is represented in a JSON payload:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>curl <span class="nt">-i</span> <span class="nt">-X</span> POST http://localhost:8001/routes/ <span class="se">\</span>
    <span class="nt">-H</span> <span class="s1">'Content-Type: application/json'</span> <span class="se">\</span>
    <span class="nt">-d</span> <span class="s1">'{"hosts":["example.com", "foo-service.com"]}'</span>
HTTP/1.1 201 Created
...
</code></pre></div></div>

<p>But since the Admin API also supports form-urlencoded content types, you
can specify an array via the <code class="language-plaintext highlighter-rouge">[]</code> notation:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>curl <span class="nt">-i</span> <span class="nt">-X</span> POST http://localhost:8001/routes/ <span class="se">\</span>
    <span class="nt">-d</span> <span class="s1">'hosts[]=example.com'</span> <span class="se">\</span>
    <span class="nt">-d</span> <span class="s1">'hosts[]=foo-service.com'</span>
HTTP/1.1 201 Created
...
</code></pre></div></div>

<p>To satisfy the <code class="language-plaintext highlighter-rouge">hosts</code> condition of this Route, any incoming request from a
client must now have its Host header set to one of:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Host: example.com
</code></pre></div></div>

<p>or:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Host: foo-service.com
</code></pre></div></div>

<p>Similarly, any other header can be used for routing:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ curl -i -X POST http://localhost:8001/routes/ \
    -d 'headers.region=north'
HTTP/1.1 201 Created
</code></pre></div></div>

<p>Incoming requests containing a <code class="language-plaintext highlighter-rouge">Region</code> header set to <code class="language-plaintext highlighter-rouge">North</code> will be routed to
said Route.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Region: North
</code></pre></div></div>

<h4 id="using-wildcard-hostnames">Using wildcard hostnames</h4>

<p>To provide flexibility, Kong allows you to specify hostnames with wildcards in
the <code class="language-plaintext highlighter-rouge">hosts</code> field. Wildcard hostnames allow any matching Host header to satisfy
the condition, and thus match a given Route.</p>

<p>Wildcard hostnames <strong>must</strong> contain <strong>only one</strong> asterisk at the leftmost
<strong>or</strong> rightmost label of the domain. Examples:</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">*.example.com</code> would allow Host values such as <code class="language-plaintext highlighter-rouge">a.example.com</code> and
<code class="language-plaintext highlighter-rouge">x.y.example.com</code> to match.</li>
  <li>
<code class="language-plaintext highlighter-rouge">example.*</code> would allow Host values such as <code class="language-plaintext highlighter-rouge">example.com</code> and <code class="language-plaintext highlighter-rouge">example.org</code>
to match.</li>
</ul>

<p>A complete example would look like this:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"hosts"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"*.example.com"</span><span class="p">,</span><span class="w"> </span><span class="s2">"service.com"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Which would allow the following requests to match this Route:</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">an.example.com</span>
</code></pre></div></div>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">service.com</span>
</code></pre></div></div>

<h4 id="the-preserve_host-property">The <code class="language-plaintext highlighter-rouge">preserve_host</code> property</h4>

<p>When proxying, Kong’s default behavior is to set the upstream request’s Host
header to the hostname specified in the Service’s <code class="language-plaintext highlighter-rouge">host</code>. The
<code class="language-plaintext highlighter-rouge">preserve_host</code> field accepts a boolean flag instructing Kong not to do so.</p>

<p>For example, when the <code class="language-plaintext highlighter-rouge">preserve_host</code> property is not changed and a Route is
configured like so:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"hosts"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"service.com"</span><span class="p">],</span><span class="w">
    </span><span class="nl">"service"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"..."</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>A possible request from a client to Kong could be:</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">service.com</span>
</code></pre></div></div>

<p>Kong would extract the Host header value from the Service’s <code class="language-plaintext highlighter-rouge">host</code> property, ,
and would send the following upstream request:</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">&lt;my-service-host.com&gt;</span>
</code></pre></div></div>

<p>However, by explicitly configuring a Route with <code class="language-plaintext highlighter-rouge">preserve_host=true</code>:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"hosts"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"service.com"</span><span class="p">],</span><span class="w">
    </span><span class="nl">"preserve_host"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nl">"service"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"..."</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>And assuming the same request from the client:</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">service.com</span>
</code></pre></div></div>

<p>Kong would preserve the Host on the client request and would send the following
upstream request instead:</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">service.com</span>
</code></pre></div></div>

<h3 id="additional-request-headers">Additional request headers</h3>

<p>It’s possible to route requests by other headers besides <code class="language-plaintext highlighter-rouge">Host</code>.</p>

<p>To do this, use the <code class="language-plaintext highlighter-rouge">headers</code> property in your Route:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"headers"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nl">"version"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"v1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"v2"</span><span class="p">]</span><span class="w"> </span><span class="p">},</span><span class="w">
    </span><span class="nl">"service"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"..."</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Given a request with a header such as:</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">version</span><span class="p">:</span> <span class="s">v1</span>
</code></pre></div></div>

<p>This request will be routed through to the Service. The same will happen with this one:</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">version</span><span class="p">:</span> <span class="s">v2</span>
</code></pre></div></div>

<p>But this request will not be routed to the Service:</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">version</span><span class="p">:</span> <span class="s">v3</span>
</code></pre></div></div>

<p><strong>Note</strong>: The <code class="language-plaintext highlighter-rouge">headers</code> keys are a logical <code class="language-plaintext highlighter-rouge">AND</code> and their values a logical <code class="language-plaintext highlighter-rouge">OR</code>.</p>

<h3 id="request-path">Request path</h3>

<p>Another way for a Route to be matched is via request paths. To satisfy this
routing condition, a client request’s normalized path <strong>must</strong> be prefixed with one of the
values of the <code class="language-plaintext highlighter-rouge">paths</code> attribute.</p>

<p>For example, with a Route configured like so:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"paths"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"/service"</span><span class="p">,</span><span class="w"> </span><span class="s2">"/hello/world"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>The following requests would be matched:</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/service</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">example.com</span>
</code></pre></div></div>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/service/resource?param=value</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">example.com</span>
</code></pre></div></div>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/hello/world/resource</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">anything.com</span>
</code></pre></div></div>

<p>For each of these requests, Kong detects that their normalized URL path is prefixed with
one of the Routes’s <code class="language-plaintext highlighter-rouge">paths</code> values. By default, Kong would then proxy the
request upstream without changing the URL path.</p>

<p>When proxying with path prefixes, <strong>the longest paths get evaluated first</strong>.
This allow you to define two Routes with two paths: <code class="language-plaintext highlighter-rouge">/service</code> and
<code class="language-plaintext highlighter-rouge">/service/resource</code>, and ensure that the former does not “shadow” the latter.</p>

<h4 id="using-regex-in-paths">Using Regex in paths</h4>

<p>Kong supports regular expression pattern matching for an Route’s <code class="language-plaintext highlighter-rouge">paths</code> field
via <a href="http://pcre.org/" target="_blank" rel="noopener nofollow noreferrer ">PCRE</a> (Perl Compatible Regular Expression). You can
assign paths as both prefixes and Regex to a Route at the same time.</p>

<p>For a path to be considered as Regex, it must fall <strong>outside</strong> of the following regex:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>^[a-zA-Z0-9\.\-_~/%]*$
</code></pre></div></div>

<p>In other words, if a path contains any character that is <strong>not</strong> alphanumerical, dot (<code class="language-plaintext highlighter-rouge">.</code>),
dash (<code class="language-plaintext highlighter-rouge">-</code>), underscore (<code class="language-plaintext highlighter-rouge">_</code>), tilde (<code class="language-plaintext highlighter-rouge">~</code>), forward-slash (<code class="language-plaintext highlighter-rouge">/</code>), or percent (<code class="language-plaintext highlighter-rouge">%</code>), then
it will be considered a Regex path. This determination is done on a per-path basis
and it is allowed to mix plain text and regex paths inside the same <code class="language-plaintext highlighter-rouge">paths</code> array of the same
Route object.</p>

<p>For example, if we consider the following Route:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"paths"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"/users/</span><span class="se">\d</span><span class="s2">+/profile"</span><span class="p">,</span><span class="w"> </span><span class="s2">"/following"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>The following requests would be matched by this Route:</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/following</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">...</span>
</code></pre></div></div>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/users/123/profile</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">...</span>
</code></pre></div></div>

<p>The provided Regex are evaluated with the <code class="language-plaintext highlighter-rouge">a</code> PCRE flag (<code class="language-plaintext highlighter-rouge">PCRE_ANCHORED</code>),
meaning that they will be constrained to match at the first matching point
in the path (the root <code class="language-plaintext highlighter-rouge">/</code> character).</p>

<p><strong>Note</strong>: Regex matching is in general very fast, but it is possible to
construct expressions that take a very long time to determine that they don’t
actually match.  This happens when the expression results in a “backtrace
exponential explosion”, which means that there’s an astronomical number of
tests to be performed before it’s conclusive that they’re all negative.
If undetected, this could take hours to finish with a single regular expression.
The <a href="http://pcre.org/" target="_blank" rel="noopener nofollow noreferrer ">PCRE</a> engine automatically detects most types of this
and replaces with more direct approaches, but there are more complex expressions
that could result in this scenario.</p>

<p>To limit the worst-case scenario, Kong applies the OpenResty
<a href="https://github.com/openresty/lua-nginx-module#lua_regex_match_limit" target="_blank" rel="noopener nofollow noreferrer "><code class="language-plaintext highlighter-rouge">lua_regex_match_limit</code></a>
to ensure that any regex operation terminates in around two seconds in the
worst case.  Apart from that, a smaller limit is applied to some “critical”
regex operations, like those for path selection, in order to terminate them
within two milliseconds, at most.</p>

<h5 id="evaluation-order">Evaluation order</h5>

<p>As previously mentioned, Kong evaluates prefix paths by length, the longest
prefix paths are evaluated first. However, Kong will evaluate Regex paths based
on the <code class="language-plaintext highlighter-rouge">regex_priority</code> attribute of Routes from highest priority to lowest.
Regex paths are furthermore evaluated before prefix paths.</p>

<p>Consider the following Routes:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nl">"paths"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"/status/</span><span class="se">\d</span><span class="s2">+"</span><span class="p">],</span><span class="w">
        </span><span class="nl">"regex_priority"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nl">"paths"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"/version/</span><span class="se">\d</span><span class="s2">+/status/</span><span class="se">\d</span><span class="s2">+"</span><span class="p">],</span><span class="w">
        </span><span class="nl">"regex_priority"</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nl">"paths"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"/version"</span><span class="p">],</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nl">"paths"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"/version/any/"</span><span class="p">],</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div></div>

<p>In this scenario, Kong will evaluate incoming requests against the following
defined URIs, in this order:</p>

<ol>
  <li><code class="language-plaintext highlighter-rouge">/version/\d+/status/\d+</code></li>
  <li><code class="language-plaintext highlighter-rouge">/status/\d+</code></li>
  <li><code class="language-plaintext highlighter-rouge">/version/any/</code></li>
  <li><code class="language-plaintext highlighter-rouge">/version</code></li>
</ol>

<p>Take care to avoid writing Regex rules that are overly broad and may consume
traffic intended for a prefix rule. Adding a rule with the path <code class="language-plaintext highlighter-rouge">/version/.*</code> to
the ruleset above would likely consume some traffic intended for the <code class="language-plaintext highlighter-rouge">/version</code>
prefix path. If you see unexpected behavior, sending <code class="language-plaintext highlighter-rouge">Kong-Debug: 1</code> in your
request headers will indicate the matched Route ID in the response headers for
troubleshooting purposes.</p>

<p>As usual, a request must still match a Route’s <code class="language-plaintext highlighter-rouge">hosts</code> and <code class="language-plaintext highlighter-rouge">methods</code> properties
as well, and Kong will traverse your Routes until it finds one that <a href="#matching-priorities">matches
the most rules</a>.</p>

<h5 id="capturing-groups">Capturing groups</h5>

<p>Capturing groups are also supported, and the matched group will be extracted
from the path and available for plugins consumption. If we consider the
following regex:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/version/(?&lt;version&gt;\d+)/users/(?&lt;user&gt;\S+)
</code></pre></div></div>

<p>And the following request path:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/version/1/users/john
</code></pre></div></div>

<p>Kong will consider the request path a match, and if the overall Route is
matched (considering other routing attributes), the extracted capturing groups
will be available from the plugins in the <code class="language-plaintext highlighter-rouge">ngx.ctx</code> variable:</p>

<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">local</span> <span class="n">router_matches</span> <span class="o">=</span> <span class="n">ngx</span><span class="p">.</span><span class="n">ctx</span><span class="p">.</span><span class="n">router_matches</span>

<span class="c1">-- router_matches.uri_captures is:</span>
<span class="c1">-- { "1", "john", version = "1", user = "john" }</span>
</code></pre></div></div>

<h5 id="escaping-special-characters">Escaping special characters</h5>

<p>Next, it is worth noting that characters found in Regex are often
reserved characters according to
<a href="https://tools.ietf.org/html/rfc3986" target="_blank" rel="noopener nofollow noreferrer ">RFC 3986</a> and as such,
should be percent-encoded. <strong>When configuring Routes with regex paths via the
Admin API, be sure to URL encode your payload if necessary</strong>. For example,
with <code class="language-plaintext highlighter-rouge">curl</code> and using an <code class="language-plaintext highlighter-rouge">application/x-www-form-urlencoded</code> MIME type:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>curl <span class="nt">-i</span> <span class="nt">-X</span> POST http://localhost:8001/routes <span class="se">\</span>
    <span class="nt">--data-urlencode</span> <span class="s1">'uris[]=/status/\d+'</span>
HTTP/1.1 201 Created
...
</code></pre></div></div>

<p>Note that <code class="language-plaintext highlighter-rouge">curl</code> does not automatically URL encode your payload, and note the
usage of <code class="language-plaintext highlighter-rouge">--data-urlencode</code>, which prevents the <code class="language-plaintext highlighter-rouge">+</code> character to be URL decoded
and interpreted as a space ` ` by Kong’s Admin API.</p>

<h4 id="the-strip_path-property">The <code class="language-plaintext highlighter-rouge">strip_path</code> property</h4>

<p>It may be desirable to specify a path prefix to match a Route, but not
include it in the upstream request. To do so, use the <code class="language-plaintext highlighter-rouge">strip_path</code> boolean
property by configuring a Route like so:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"paths"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"/service"</span><span class="p">],</span><span class="w">
    </span><span class="nl">"strip_path"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nl">"service"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"..."</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Enabling this flag instructs Kong that when matching this Route, and proceeding
with the proxying to a Service, it should <strong>not</strong> include the matched part of
the URL path in the upstream request’s URL. For example, the following
client’s request to the above Route:</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/service/path/to/resource</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">...</span>
</code></pre></div></div>

<p>Will cause Kong to send the following upstream request:</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/path/to/resource</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">...</span>
</code></pre></div></div>

<p>The same way, if a Regex path is defined on a Route that has <code class="language-plaintext highlighter-rouge">strip_path</code>
enabled, the entirety of the request URL matching sequence will be stripped.
Example:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"paths"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"/version/</span><span class="se">\d</span><span class="s2">+/service"</span><span class="p">],</span><span class="w">
    </span><span class="nl">"strip_path"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nl">"service"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"..."</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>The following HTTP request matching the provided Regex path:</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/version/1/service/path/to/resource</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">...</span>
</code></pre></div></div>

<p>Will be proxied upstream by Kong as:</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/path/to/resource</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">...</span>
</code></pre></div></div>

<h4 id="normalization-behavior">Normalization behavior</h4>

<p>To prevent trivial Route match bypass, the incoming request URI from client
is always normalized according to <a href="https://tools.ietf.org/html/rfc3986" target="_blank" rel="noopener nofollow noreferrer ">RFC 3986</a>
before router matching occurs. Specifically, the following normalization techniques are
used for incoming request URIs, which are selected because they generally do not change
semantics of the request URI:</p>

<ol>
  <li>Percent-encoded triplets are converted to uppercase.  For example: <code class="language-plaintext highlighter-rouge">/foo%3a</code> becomes <code class="language-plaintext highlighter-rouge">/foo%3A</code>.</li>
  <li>Percent-encoded triplets of unreserved characters are decoded. For example: <code class="language-plaintext highlighter-rouge">/fo%6F</code> becomes <code class="language-plaintext highlighter-rouge">/foo</code>.</li>
  <li>Dot segments are removed as necessary.  For example: <code class="language-plaintext highlighter-rouge">/foo/./bar/../baz</code> becomes <code class="language-plaintext highlighter-rouge">/foo/baz</code>.</li>
  <li>Duplicate slashes are merged. For example: <code class="language-plaintext highlighter-rouge">/foo//bar</code> becomes <code class="language-plaintext highlighter-rouge">/foo/bar</code>.</li>
</ol>

<p>The <code class="language-plaintext highlighter-rouge">paths</code> attribute of the Route object are also normalized. It is achieved by first determining
if the path is a plain text or regex path. Based on the result, different normalization techniques
are used.</p>

<p>For plain text Route path:</p>

<p>Same normalization technique as above is used, that is, methods 1 through 4.</p>

<p>For regex Route path:</p>

<p>Only methods 1 and 2 are used. In addition, if the decoded character becomes a regex
meta character, it will be escaped with backslash.</p>

<p>Kong normalizes any incoming request URI before performing router
matches. As a result, any request URI sent over to the upstream services will also
be in normalized form that preserves the original URI semantics.</p>

<h3 id="request-http-method">Request HTTP method</h3>

<p>The <code class="language-plaintext highlighter-rouge">methods</code> field allows matching the requests depending on their HTTP
method.  It accepts multiple values. Its default value is empty (the HTTP
method is not used for routing).</p>

<p>The following Route allows routing via <code class="language-plaintext highlighter-rouge">GET</code> and <code class="language-plaintext highlighter-rouge">HEAD</code>:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"methods"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"GET"</span><span class="p">,</span><span class="w"> </span><span class="s2">"HEAD"</span><span class="p">],</span><span class="w">
    </span><span class="nl">"service"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"..."</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Such a Route would be matched with the following requests:</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">...</span>
</code></pre></div></div>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">HEAD</span> <span class="nn">/resource</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">...</span>
</code></pre></div></div>

<p>But it would not match a <code class="language-plaintext highlighter-rouge">POST</code> or <code class="language-plaintext highlighter-rouge">DELETE</code> request. This allows for much more
granularity when configuring plugins on Routes. For example, one could imagine
two Routes pointing to the same service: one with unlimited unauthenticated
<code class="language-plaintext highlighter-rouge">GET</code> requests, and a second one allowing only authenticated and rate-limited
<code class="language-plaintext highlighter-rouge">POST</code> requests (by applying the authentication and rate limiting plugins to
such requests).</p>

<h3 id="request-source">Request source</h3>

<blockquote class="note">
  <p><strong>Note:</strong> This section only applies to TCP and TLS routes.</p>
</blockquote>

<p>The <code class="language-plaintext highlighter-rouge">sources</code> routing attribute allows
matching a route by a list of incoming connection IP and/or port sources.</p>

<p>The following Route allows routing via a list of source IP/ports:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"protocols"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"tcp"</span><span class="p">,</span><span class="w"> </span><span class="s2">"tls"</span><span class="p">],</span><span class="w">
    </span><span class="nl">"sources"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="nl">"ip"</span><span class="p">:</span><span class="s2">"10.1.0.0/16"</span><span class="p">,</span><span class="w"> </span><span class="nl">"port"</span><span class="p">:</span><span class="mi">1234</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="nl">"ip"</span><span class="p">:</span><span class="s2">"10.2.2.2"</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="nl">"port"</span><span class="p">:</span><span class="mi">9123</span><span class="p">}],</span><span class="w">
    </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"..."</span><span class="p">,</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>TCP or TLS connections originating from IPs in CIDR range “10.1.0.0/16” or IP
address “10.2.2.2” or Port “9123” would match such Route.</p>

<h3 id="request-destination">Request destination</h3>

<blockquote class="note">
  <p><strong>Note:</strong> This section only applies to TCP and TLS routes.</p>
</blockquote>

<p>The <code class="language-plaintext highlighter-rouge">destinations</code> attribute, similarly to <code class="language-plaintext highlighter-rouge">sources</code>,
allows matching a route by a list of incoming connection IP and/or port, but
uses the destination of the TCP/TLS connection as routing attribute.</p>

<h3 id="request-sni">Request SNI</h3>

<p>When using secure protocols (<code class="language-plaintext highlighter-rouge">https</code>, <code class="language-plaintext highlighter-rouge">grpcs</code>, or <code class="language-plaintext highlighter-rouge">tls</code>), a <a href="https://en.wikipedia.org/wiki/Server_Name_Indication" target="_blank" rel="noopener nofollow noreferrer ">Server
Name Indication</a> can be used as a routing attribute. The following Route
allows routing via SNIs:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"snis"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"foo.test"</span><span class="p">,</span><span class="w"> </span><span class="s2">"example.com"</span><span class="p">],</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"..."</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Incoming requests with a matching hostname set in the TLS connection’s SNI
extension would be routed to this Route. As mentioned, SNI routing applies not
only to TLS, but also to other protocols carried over TLS - such as HTTPS and
If multiple SNIs are specified in the Route, any of them can match with the incoming request’s SNI.
with the incoming request (OR relationship between the names).</p>

<p>The SNI is indicated at TLS handshake time and cannot be modified after the TLS connection has
been established. This means, for example, that multiple requests reusing the same keepalive connection
will have the same SNI hostname while performing router match, regardless of the <code class="language-plaintext highlighter-rouge">Host</code> header.
has been established. This means keepalive connections that send multiple requests
will have the same SNI hostnames while performing router match
(regardless of the <code class="language-plaintext highlighter-rouge">Host</code> header).</p>

<p>Please note that creating a route with mismatched SNI and <code class="language-plaintext highlighter-rouge">Host</code> header matcher
is possible, but generally discouraged.</p>

<h2 id="matching-priorities">Matching priorities</h2>

<p>A Route may define matching rules based on its <code class="language-plaintext highlighter-rouge">headers</code>, <code class="language-plaintext highlighter-rouge">hosts</code>, <code class="language-plaintext highlighter-rouge">paths</code>, and
<code class="language-plaintext highlighter-rouge">methods</code> (plus <code class="language-plaintext highlighter-rouge">snis</code> for secure routes - <code class="language-plaintext highlighter-rouge">"https"</code>, <code class="language-plaintext highlighter-rouge">"grpcs"</code>, <code class="language-plaintext highlighter-rouge">"tls"</code>)
fields. For Kong to match an incoming request to a Route, all existing fields
must be satisfied. However, Kong allows for quite some flexibility by allowing
two or more Routes to be configured with fields containing the same values -
when this occurs, Kong applies a priority rule.</p>

<p>The rule is: <strong>when evaluating a request, Kong will first try to match the
Routes with the most rules</strong>.</p>

<p>For example, if two Routes are configured like so:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"hosts"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"example.com"</span><span class="p">],</span><span class="w">
    </span><span class="nl">"service"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"..."</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="err">,</span><span class="w">
</span><span class="p">{</span><span class="w">
    </span><span class="nl">"hosts"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"example.com"</span><span class="p">],</span><span class="w">
    </span><span class="nl">"methods"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"POST"</span><span class="p">],</span><span class="w">
    </span><span class="nl">"service"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"..."</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>The second Route has a <code class="language-plaintext highlighter-rouge">hosts</code> field <strong>and</strong> a <code class="language-plaintext highlighter-rouge">methods</code> field, so it will be
evaluated first by Kong. By doing so, we avoid the first Route “shadowing”
calls intended for the second one.</p>

<p>Thus, this request will match the first Route</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">example.com</span>
</code></pre></div></div>

<p>And this request will match the second one:</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">POST</span> <span class="nn">/</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">example.com</span>
</code></pre></div></div>

<p>Following this logic, if a third Route was to be configured with a <code class="language-plaintext highlighter-rouge">hosts</code>
field, a <code class="language-plaintext highlighter-rouge">methods</code> field, and a <code class="language-plaintext highlighter-rouge">uris</code> field, it would be evaluated first by
Kong.</p>

<p>If the rule count for the given request is the same in two Routes <code class="language-plaintext highlighter-rouge">A</code> and
<code class="language-plaintext highlighter-rouge">B</code>, then the following tiebreaker rules will be applied in the order they
are listed. Route <code class="language-plaintext highlighter-rouge">A</code> will be selected over <code class="language-plaintext highlighter-rouge">B</code> if:</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">A</code> has only “plain” Host headers and <code class="language-plaintext highlighter-rouge">B</code> has one or more “wildcard”
host headers</li>
  <li>
<code class="language-plaintext highlighter-rouge">A</code> has more non-Host headers than <code class="language-plaintext highlighter-rouge">B</code>.</li>
  <li>
<code class="language-plaintext highlighter-rouge">A</code> has at least one “regex” paths and <code class="language-plaintext highlighter-rouge">B</code> has only “plain” paths.</li>
  <li>
<code class="language-plaintext highlighter-rouge">A</code>’s longest path is longer than <code class="language-plaintext highlighter-rouge">B</code>’s longest path.</li>
  <li><code class="language-plaintext highlighter-rouge">A.created_at &lt; B.created_at</code></li>
</ul>

<h2 id="proxying-behavior">Proxying behavior</h2>

<p>The proxying rules above detail how Kong forwards incoming requests to your
upstream services. Below, we detail what happens internally between the time
Kong <em>matches</em> an HTTP request with a registered Route, and the actual
<em>forwarding</em> of the request.</p>

<h3 id="1-load-balancing">1. Load balancing</h3>

<p>Kong implements load balancing capabilities to distribute proxied
requests across a pool of instances of an upstream service.</p>

<p>You can find more information about configuring load balancing by consulting
the <a href="/gateway/2.7.x/reference/loadbalancing">Load Balancing Reference</a>.</p>

<h3 id="2-plugins-execution">2. Plugins execution</h3>

<p>Kong is extensible via “plugins” that hook themselves in the request/response
lifecycle of the proxied requests. Plugins can perform a variety of operations
in your environment and/or transformations on the proxied request.</p>

<p>Plugins can be configured to run globally (for all proxied traffic) or on
specific Routes and Services. In both cases, you must create a <a href="/gateway/2.7.x/admin-api#plugin-object">plugin
configuration</a> via the Admin API.</p>

<p>Once a Route has been matched (and its associated Service entity), Kong will
run plugins associated to either of those entities. Plugins configured on a
Route run before plugins configured on a Service, but otherwise, the usual
rules of <a href="/gateway/2.7.x/admin-api/#precedence">plugins association</a> apply.</p>

<p>These configured plugins will run their <code class="language-plaintext highlighter-rouge">access</code> phase, which you can find more
information about in the <a href="/gateway/2.7.x/plugin-development">Plugin development guide</a>.</p>

<h3 id="3-proxying-and-upstream-timeouts">3. Proxying and upstream timeouts</h3>

<p>Once Kong has executed all the necessary logic (including plugins), it is ready
to forward the request to your upstream service. This is done via Nginx’s
<a href="http://nginx.org/en/docs/http/ngx_http_proxy_module.html" target="_blank" rel="noopener nofollow noreferrer "><code class="language-plaintext highlighter-rouge">ngx_http_proxy_module</code></a>. You can configure the desired
timeouts for the connection between Kong and a given upstream, via the following
properties of a Service:</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">connect_timeout</code>: defines in milliseconds the timeout for
establishing a connection to your upstream service. Defaults to <code class="language-plaintext highlighter-rouge">60000</code>.</li>
  <li>
<code class="language-plaintext highlighter-rouge">write_timeout</code>: defines in milliseconds a timeout between two
successive write operations for transmitting a request to your upstream
service.  Defaults to <code class="language-plaintext highlighter-rouge">60000</code>.</li>
  <li>
<code class="language-plaintext highlighter-rouge">read_timeout</code>: defines in milliseconds a timeout between two
successive read operations for receiving a request from your upstream
service.  Defaults to <code class="language-plaintext highlighter-rouge">60000</code>.</li>
</ul>

<p>Kong will send the request over HTTP/1.1, and set the following headers:</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">Host: &lt;your_upstream_host&gt;</code>, as previously described in this document.</li>
  <li>
<code class="language-plaintext highlighter-rouge">Connection: keep-alive</code>, to allow for reusing the upstream connections.</li>
  <li>
<code class="language-plaintext highlighter-rouge">X-Real-IP: &lt;remote_addr&gt;</code>, where <code class="language-plaintext highlighter-rouge">$remote_addr</code> is the variable bearing
the same name provided by
<a href="http://nginx.org/en/docs/http/ngx_http_core_module.html#var_remote_addr" target="_blank" rel="noopener nofollow noreferrer "><code class="language-plaintext highlighter-rouge">ngx_http_core_module</code></a>. Please note that the
<code class="language-plaintext highlighter-rouge">$remote_addr</code> is likely overridden by
<a href="http://nginx.org/en/docs/http/ngx_http_realip_module.html" target="_blank" rel="noopener nofollow noreferrer "><code class="language-plaintext highlighter-rouge">ngx_http_realip_module</code></a>.</li>
  <li>
<code class="language-plaintext highlighter-rouge">X-Forwarded-For: &lt;address&gt;</code>, where <code class="language-plaintext highlighter-rouge">&lt;address&gt;</code> is the content of
<code class="language-plaintext highlighter-rouge">$realip_remote_addr</code> provided by
<a href="http://nginx.org/en/docs/http/ngx_http_realip_module.html" target="_blank" rel="noopener nofollow noreferrer "><code class="language-plaintext highlighter-rouge">ngx_http_realip_module</code></a> appended to the request
header with the same name.</li>
  <li>
<code class="language-plaintext highlighter-rouge">X-Forwarded-Proto: &lt;protocol&gt;</code>, where <code class="language-plaintext highlighter-rouge">&lt;protocol&gt;</code> is the protocol used by
the client. In the case where <code class="language-plaintext highlighter-rouge">$realip_remote_addr</code> is one of the <strong>trusted</strong>
addresses, the request header with the same name gets forwarded if provided.
Otherwise, the value of the <code class="language-plaintext highlighter-rouge">$scheme</code> variable provided by
<a href="http://nginx.org/en/docs/http/ngx_http_core_module.html#var_scheme" target="_blank" rel="noopener nofollow noreferrer "><code class="language-plaintext highlighter-rouge">ngx_http_core_module</code></a> will be used.</li>
  <li>
<code class="language-plaintext highlighter-rouge">X-Forwarded-Host: &lt;host&gt;</code>, where <code class="language-plaintext highlighter-rouge">&lt;host&gt;</code> is the host name sent by
the client. In the case where <code class="language-plaintext highlighter-rouge">$realip_remote_addr</code> is one of the <strong>trusted</strong>
addresses, the request header with the same name gets forwarded if provided.
Otherwise, the value of the <code class="language-plaintext highlighter-rouge">$host</code> variable provided by
<a href="http://nginx.org/en/docs/http/ngx_http_core_module.html#var_host" target="_blank" rel="noopener nofollow noreferrer "><code class="language-plaintext highlighter-rouge">ngx_http_core_module</code></a> will be used.</li>
  <li>
<code class="language-plaintext highlighter-rouge">X-Forwarded-Port: &lt;port&gt;</code>, where <code class="language-plaintext highlighter-rouge">&lt;port&gt;</code> is the port of the server which
accepted a request. In the case where <code class="language-plaintext highlighter-rouge">$realip_remote_addr</code> is one of the
<strong>trusted</strong> addresses, the request header with the same name gets forwarded
if provided. Otherwise, the value of the <code class="language-plaintext highlighter-rouge">$server_port</code> variable provided by
<a href="http://nginx.org/en/docs/http/ngx_http_core_module.html#var_server_port" target="_blank" rel="noopener nofollow noreferrer "><code class="language-plaintext highlighter-rouge">ngx_http_core_module</code></a> will be used.</li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">X-Forwarded-Prefix: &lt;path&gt;</code>, where <code class="language-plaintext highlighter-rouge">&lt;path&gt;</code> is the path of the request which
was accepted by Kong. In the case where <code class="language-plaintext highlighter-rouge">$realip_remote_addr</code> is one of the
<strong>trusted</strong> addresses, the request header with the same name gets forwarded
if provided. Otherwise, the value of the <code class="language-plaintext highlighter-rouge">$request_uri</code> variable (with
the query string stripped) provided by <a href="http://nginx.org/en/docs/http/ngx_http_core_module.html#var_server_port" target="_blank" rel="noopener nofollow noreferrer "><code class="language-plaintext highlighter-rouge">ngx_http_core_module</code></a>
will be used.</p>

    <blockquote class="note">
      <p><strong>Note</strong>: Kong returns <code class="language-plaintext highlighter-rouge">"/"</code> for an empty path, but it doesn’t do any other 
normalization on the request path.</p>
    </blockquote>
  </li>
</ul>

<p>All the other request headers are forwarded as-is by Kong.</p>

<p>One exception to this is made when using the WebSocket protocol. If so, Kong
will set the following headers to allow for upgrading the protocol between the
client and your upstream services:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">Connection: Upgrade</code></li>
  <li><code class="language-plaintext highlighter-rouge">Upgrade: websocket</code></li>
</ul>

<p>More information on this topic is covered in the
<a href="/gateway/2.7.x/reference/proxy/#proxy-websocket-traffic">Proxy WebSocket traffic</a> section.</p>

<h3 id="4-errors-and-retries">4. Errors and retries</h3>

<p>Whenever an error occurs during proxying, Kong will use the underlying
Nginx <a href="http://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_next_upstream_tries" target="_blank" rel="noopener nofollow noreferrer ">retries</a> mechanism to pass the request on to
the next upstream.</p>

<p>There are two configurable elements here:</p>

<ol>
  <li>
    <p>The number of retries: this can be configured per Service using the
<code class="language-plaintext highlighter-rouge">retries</code> property. See the <a href="/gateway/2.7.x/admin-api">Admin API</a> for more details on this.</p>
  </li>
  <li>
    <p>What exactly constitutes an error: here Kong uses the Nginx defaults, which
means an error or timeout occurring while establishing a connection with the
server, passing a request to it, or reading the response headers.</p>
  </li>
</ol>

<p>The second option is based on Nginx’s
[proxy_next_upstream][proxy_next_upstream] directive. This option is not
directly configurable through Kong, but can be added using a custom Nginx
configuration. See the <a href="/gateway/2.7.x/reference/configuration/">configuration reference</a> for
more details.</p>

<h3 id="5-response">5. Response</h3>

<p>Kong receives the response from the upstream service and sends it back to the
downstream client in a streaming fashion. At this point Kong will execute
subsequent plugins added to the Route and/or Service that implement a hook in
the <code class="language-plaintext highlighter-rouge">header_filter</code> phase.</p>

<p>Once the <code class="language-plaintext highlighter-rouge">header_filter</code> phase of all registered plugins has been executed, the
following headers will be added by Kong and the full set of headers be sent to
the client:</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">Via: kong/x.x.x</code>, where <code class="language-plaintext highlighter-rouge">x.x.x</code> is the Kong version in use</li>
  <li>
<code class="language-plaintext highlighter-rouge">X-Kong-Proxy-Latency: &lt;latency&gt;</code>, where <code class="language-plaintext highlighter-rouge">latency</code> is the time in milliseconds
between Kong receiving the request from the client and sending the request to
your upstream service.</li>
  <li>
<code class="language-plaintext highlighter-rouge">X-Kong-Upstream-Latency: &lt;latency&gt;</code>, where <code class="language-plaintext highlighter-rouge">latency</code> is the time in
milliseconds that Kong was waiting for the first byte of the upstream service
response.</li>
</ul>

<p>Once the headers are sent to the client, Kong will start executing
registered plugins for the Route and/or Service that implement the
<code class="language-plaintext highlighter-rouge">body_filter</code> hook. This hook may be called multiple times, due to the
streaming nature of Nginx. Each chunk of the upstream response that is
successfully processed by such <code class="language-plaintext highlighter-rouge">body_filter</code> hooks is sent back to the client.
You can find more information about the <code class="language-plaintext highlighter-rouge">body_filter</code> hook in the <a href="/gateway/2.7.x/plugin-development">Plugin
development guide</a>.</p>

<h2 id="configuring-a-fallback-route">Configuring a fallback Route</h2>

<p>As a practical use-case and example of the flexibility offered by Kong’s
proxying capabilities, let’s try to implement a “fallback Route”, so that in
order to avoid Kong responding with an HTTP <code class="language-plaintext highlighter-rouge">404</code>, “no route found”, we can
catch such requests and proxy them to a special upstream service, or apply a
plugin to it (such a plugin could, for example, terminate the request with a
different status code or response without proxying the request).</p>

<p>Here is an example of such a fallback Route:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"paths"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"/"</span><span class="p">],</span><span class="w">
    </span><span class="nl">"service"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"..."</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>As you can guess, any HTTP request made to Kong would actually match this
Route, since all URIs are prefixed by the root character <code class="language-plaintext highlighter-rouge">/</code>. As we know from
the <a href="#request-path">Request path</a> section, the longest URL paths are
evaluated first by Kong, so the <code class="language-plaintext highlighter-rouge">/</code> path will eventually be evaluated last by
Kong, and effectively provide a “fallback” Route, only matched as a last
resort. You can then send traffic to a special Service or apply any plugin you
wish on this Route.</p>

<h2 id="configuring-tls-for-a-route">Configuring TLS for a Route</h2>

<p>Kong provides a way to dynamically serve TLS certificates on a per-connection
basis. TLS certificates are directly handled by the core, and configurable via
the Admin API. Clients connecting to Kong over TLS must support the <a href="https://en.wikipedia.org/wiki/Server_Name_Indication" target="_blank" rel="noopener nofollow noreferrer ">Server
Name Indication</a> extension to make use of this feature.</p>

<p>TLS certificates are handled by two resources in the Kong Admin API:</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">/certificates</code>, which stores your keys and certificates.</li>
  <li>
<code class="language-plaintext highlighter-rouge">/snis</code>, which associates a registered certificate with a Server Name
Indication.</li>
</ul>

<p>You can find the documentation for those two resources in the
<a href="/gateway/2.7.x/admin-api">Admin API Reference</a>.</p>

<p>Here is how to configure a TLS certificate on a given Route: first, upload
your TLS certificate and key via the Admin API:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>curl <span class="nt">-i</span> <span class="nt">-X</span> POST http://localhost:8001/certificates <span class="se">\</span>
    <span class="nt">-F</span> <span class="s2">"cert=@/path/to/cert.pem"</span> <span class="se">\</span>
    <span class="nt">-F</span> <span class="s2">"key=@/path/to/cert.key"</span> <span class="se">\</span>
    <span class="nt">-F</span> <span class="s2">"snis=*.tls-example.com,other-tls-example.com"</span>
HTTP/1.1 201 Created
...
</code></pre></div></div>

<p>The <code class="language-plaintext highlighter-rouge">snis</code> form parameter is a sugar parameter, directly inserting an SNI and
associating the uploaded certificate to it.</p>

<p>Note that one of the SNI names defined in <code class="language-plaintext highlighter-rouge">snis</code> above contains a wildcard
(<code class="language-plaintext highlighter-rouge">*.tls-example.com</code>). An SNI may contain a single wildcard in the leftmost (prefix) or
rightmost (suffix) position. This can be useful when maintaining multiple subdomains. A
single <code class="language-plaintext highlighter-rouge">sni</code> configured with a wildcard name can be used to match multiple
subdomains, instead of creating an SNI for each.</p>

<p>Valid wildcard positions are <code class="language-plaintext highlighter-rouge">mydomain.*</code>, <code class="language-plaintext highlighter-rouge">*.mydomain.com</code>, and <code class="language-plaintext highlighter-rouge">*.www.mydomain.com</code>.</p>

<p>A default certificate can be added using the following parameters in Kong configuration:</p>
<ol>
  <li><a href="/gateway/2.7.x/reference/configuration/#ssl_cert"><code class="language-plaintext highlighter-rouge">ssl_cert</code></a></li>
  <li><a href="/gateway/2.7.x/reference/configuration/#ssl_cert_key"><code class="language-plaintext highlighter-rouge">ssl_cert_key</code></a></li>
</ol>

<p>Or, by dynamically configuring the default certificate with an SNI of <code class="language-plaintext highlighter-rouge">*</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>curl <span class="nt">-i</span> <span class="nt">-X</span> POST http://localhost:8001/certificates <span class="se">\</span>
    <span class="nt">-F</span> <span class="s2">"cert=@/path/to/default-cert.pem"</span> <span class="se">\</span>
    <span class="nt">-F</span> <span class="s2">"key=@/path/to/default-cert.key"</span> <span class="se">\</span>
    <span class="nt">-F</span> <span class="s2">"snis=*"</span>
HTTP/1.1 201 Created
...
</code></pre></div></div>

<p>Matching of <code class="language-plaintext highlighter-rouge">snis</code> respects the following priority:</p>

<ol>
  <li>Exact SNI matching certificate</li>
  <li>Search for a certificate by prefix wildcard</li>
  <li>Search for a certificate by suffix wildcard</li>
  <li>Search for a certificate associated with the SNI <code class="language-plaintext highlighter-rouge">*</code>
</li>
  <li>The default certificate on the file system</li>
</ol>

<p>You must now register the following Route within Kong. We will match requests
to this Route using only the Host header for convenience:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>curl <span class="nt">-i</span> <span class="nt">-X</span> POST http://localhost:8001/routes <span class="se">\</span>
    <span class="nt">-d</span> <span class="s1">'hosts=prefix.tls-example.com,other-tls-example.com'</span> <span class="se">\</span>
    <span class="nt">-d</span> <span class="s1">'service.id=d54da06c-d69f-4910-8896-915c63c270cd'</span>
HTTP/1.1 201 Created
...
</code></pre></div></div>

<p>You can now expect the Route to be served over HTTPS by Kong:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>curl <span class="nt">-i</span> https://localhost:8443/ <span class="se">\</span>
  <span class="nt">-H</span> <span class="s2">"Host: prefix.tls-example.com"</span>
HTTP/1.1 200 OK
...
</code></pre></div></div>

<p>When establishing the connection and negotiating the TLS handshake, if your
client sends <code class="language-plaintext highlighter-rouge">prefix.tls-example.com</code> as part of the SNI extension, Kong will serve
the <code class="language-plaintext highlighter-rouge">cert.pem</code> certificate previously configured. This is the same for both HTTPS and
TLS connections.</p>

<h3 id="restricting-the-client-protocol">Restricting the client protocol</h3>

<p>Routes have a <code class="language-plaintext highlighter-rouge">protocols</code> property to restrict the client protocol they should
listen for. This attribute accepts a set of values, which can be <code class="language-plaintext highlighter-rouge">"http"</code>,
<code class="language-plaintext highlighter-rouge">"https"</code>, <code class="language-plaintext highlighter-rouge">"grpc"</code>, <code class="language-plaintext highlighter-rouge">"grpcs"</code>, <code class="language-plaintext highlighter-rouge">"tcp"</code>, or <code class="language-plaintext highlighter-rouge">"tls"</code>.</p>

<p>A Route with <code class="language-plaintext highlighter-rouge">http</code> and <code class="language-plaintext highlighter-rouge">https</code> will accept traffic in both protocols.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"hosts"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"..."</span><span class="p">],</span><span class="w">
    </span><span class="nl">"paths"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"..."</span><span class="p">],</span><span class="w">
    </span><span class="nl">"methods"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"..."</span><span class="p">],</span><span class="w">
    </span><span class="nl">"protocols"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"http"</span><span class="p">,</span><span class="w"> </span><span class="s2">"https"</span><span class="p">],</span><span class="w">
    </span><span class="nl">"service"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"..."</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Not specifying any protocol has the same effect, since routes default to
<code class="language-plaintext highlighter-rouge">["http", "https"]</code>.</p>

<p>However, a Route with <em>only</em> <code class="language-plaintext highlighter-rouge">https</code> would <em>only</em> accept traffic over HTTPS. It
would <em>also</em> accept unencrypted traffic <em>if</em> TLS termination previously
occurred from a trusted IP. TLS termination is considered valid when the
request comes from one of the configured IPs in
<a href="/gateway/2.7.x/reference/configuration/#trusted_ips">trusted_ips</a> and if the <code class="language-plaintext highlighter-rouge">X-Forwarded-Proto: https</code>
header is set:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"hosts"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"..."</span><span class="p">],</span><span class="w">
    </span><span class="nl">"paths"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"..."</span><span class="p">],</span><span class="w">
    </span><span class="nl">"methods"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"..."</span><span class="p">],</span><span class="w">
    </span><span class="nl">"protocols"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"https"</span><span class="p">],</span><span class="w">
    </span><span class="nl">"service"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"..."</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>If a Route such as the above matches a request, but that request is in
plain-text without valid prior TLS termination, Kong responds with:</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">426</span> <span class="ne">Upgrade Required</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json; charset=utf-8</span>
<span class="na">Transfer-Encoding</span><span class="p">:</span> <span class="s">chunked</span>
<span class="na">Connection</span><span class="p">:</span> <span class="s">Upgrade</span>
<span class="na">Upgrade</span><span class="p">:</span> <span class="s">TLS/1.2, HTTP/1.1</span>
<span class="na">Server</span><span class="p">:</span> <span class="s">kong/x.y.z</span>

<span class="p">{</span><span class="nl">"message"</span><span class="p">:</span><span class="s2">"Please use HTTPS protocol"</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>It’s possible to create routes for raw TCP (not necessarily HTTP)
connections by using <code class="language-plaintext highlighter-rouge">"tcp"</code> in the <code class="language-plaintext highlighter-rouge">protocols</code> attribute:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"hosts"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"..."</span><span class="p">],</span><span class="w">
    </span><span class="nl">"paths"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"..."</span><span class="p">],</span><span class="w">
    </span><span class="nl">"methods"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"..."</span><span class="p">],</span><span class="w">
    </span><span class="nl">"protocols"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"tcp"</span><span class="p">],</span><span class="w">
    </span><span class="nl">"service"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"..."</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Similarly, we can create routes which accept raw TLS traffic (not necessarily HTTPS) with
the <code class="language-plaintext highlighter-rouge">"tls"</code> value:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"hosts"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"..."</span><span class="p">],</span><span class="w">
    </span><span class="nl">"paths"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"..."</span><span class="p">],</span><span class="w">
    </span><span class="nl">"methods"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"..."</span><span class="p">],</span><span class="w">
    </span><span class="nl">"protocols"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"tls"</span><span class="p">],</span><span class="w">
    </span><span class="nl">"service"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"..."</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>A Route with <em>only</em> <code class="language-plaintext highlighter-rouge">TLS</code> would <em>only</em> accept traffic over TLS.</p>

<p>It is also possible to accept both TCP and TLS simultaneously:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
    "hosts": ["..."],
    "paths": ["..."],
    "methods": ["..."],
    "protocols": ["tcp", "tls"],
    "service": {
        "id": "..."
    }
}

</code></pre></div></div>

<p>For L4 TLS proxy to work, it is necessary to create route that accepts
the <code class="language-plaintext highlighter-rouge">tls</code> <code class="language-plaintext highlighter-rouge">protocol</code>, as well as having the appropriate TLS certificate
uploaded and their <code class="language-plaintext highlighter-rouge">sni</code> attribute properly set to match incoming connection’s
SNI. Please refer to the <a href="#configuring-tls-for-a-route">Configuring TLS for a Route</a>
section above for instructions on setting this up.</p>

<h2 id="proxy-websocket-traffic">Proxy WebSocket traffic</h2>

<p>Kong supports WebSocket traffic thanks to the underlying Nginx implementation.
When you wish to establish a WebSocket connection between a client and your
upstream services <em>through</em> Kong, you must establish a WebSocket handshake.
This is done via the HTTP Upgrade mechanism. This is what your client request
made to Kong would look like:</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Connection</span><span class="p">:</span> <span class="s">Upgrade</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">my-websocket-api.com</span>
<span class="na">Upgrade</span><span class="p">:</span> <span class="s">WebSocket</span>
</code></pre></div></div>

<p>This will make Kong forward the <code class="language-plaintext highlighter-rouge">Connection</code> and <code class="language-plaintext highlighter-rouge">Upgrade</code> headers to your
upstream service, instead of dismissing them due to the hop-by-hop nature of a
standard HTTP proxy.</p>

<h3 id="websocket-and-tls">WebSocket and TLS</h3>

<p>Kong will accept <code class="language-plaintext highlighter-rouge">ws</code> and <code class="language-plaintext highlighter-rouge">wss</code> connections on its respective <code class="language-plaintext highlighter-rouge">http</code> and
<code class="language-plaintext highlighter-rouge">https</code> ports. To enforce TLS connections from clients, set the <code class="language-plaintext highlighter-rouge">protocols</code>
property of the <a href="/gateway/2.7.x/admin-api/#add-route">Route</a> to <code class="language-plaintext highlighter-rouge">https</code> only.</p>

<p>When setting up the <a href="/gateway/2.7.x/admin-api/#add-service">Service</a> to point to your upstream
WebSocket service, you should carefully pick the protocol you want to use
between Kong and the upstream. If you want to use TLS (<code class="language-plaintext highlighter-rouge">wss</code>), then the
upstream WebSocket service must be defined using the <code class="language-plaintext highlighter-rouge">https</code> protocol in the
Service <code class="language-plaintext highlighter-rouge">protocol</code> property, and the proper port (usually 443). To connect
without TLS (<code class="language-plaintext highlighter-rouge">ws</code>), then the <code class="language-plaintext highlighter-rouge">http</code> protocol and port (usually 80) should be
used in <code class="language-plaintext highlighter-rouge">protocol</code> instead.</p>

<p>If you want Kong to terminate TLS, you can accept <code class="language-plaintext highlighter-rouge">wss</code> only from the
client, but proxy to the upstream service over plain text, or <code class="language-plaintext highlighter-rouge">ws</code>.</p>

<h2 id="proxy-grpc-traffic">Proxy gRPC traffic</h2>

<p>gRPC proxying is natively supported in Kong. In order
to manage gRPC services and proxy gRPC requests with Kong, create Services and
Routes for your gRPC Services (check out the <a href="/gateway/2.7.x/get-started/quickstart/configuring-a-grpc-service">Configuring a gRPC Service guide</a>).</p>

<p>Only observability and logging plugins are supported with
gRPC - plugins known to be supported with gRPC have “grpc” and “grpcs” listed
under the supported protocols field in their Kong Hub page - for example,
check out the <a href="/hub/kong-inc/file-log">File Log</a> plugin’s page.</p>

<h2 id="proxy-tcptls-traffic">Proxy TCP/TLS traffic</h2>

<p>TCP and TLS proxying is natively supported in Kong.</p>

<p>In this mode, data of incoming connections reaching the <code class="language-plaintext highlighter-rouge">stream_listen</code> endpoints will
be passed through to the upstream. It is possible to terminate TLS connections
from clients using this mode as well.</p>

<p>To use this mode, aside from defining <code class="language-plaintext highlighter-rouge">stream_listen</code>, appropriate Route/Service
object with protocol types of <code class="language-plaintext highlighter-rouge">tcp</code> or <code class="language-plaintext highlighter-rouge">tls</code> should be created.</p>

<p>If TLS termination by Kong is desired, the following conditions must be met:</p>

<ol>
  <li>The Kong port where TLS connection connects to must have the <code class="language-plaintext highlighter-rouge">ssl</code> flag enabled</li>
  <li>A certificate/key that can be used for TLS termination must be present inside Kong,
as shown in <a href="#configuring-tls-for-a-route">Configuring TLS for a Route</a>
</li>
</ol>

<p>Kong will use the connecting client’s TLS SNI server name extension to find
the appropriate TLS certificate to use.</p>

<p>On the Service side, depends on whether connection between Kong and the upstream
service need to be encrypted, <code class="language-plaintext highlighter-rouge">tcp</code> or <code class="language-plaintext highlighter-rouge">tls</code> protocol types can be set accordingly.
This means all of the below setup are supported in this mode:</p>

<ol>
  <li>Client &lt;- TLS -&gt; Kong &lt;- TLS -&gt; Upstream</li>
  <li>Client &lt;- TLS -&gt; Kong &lt;- Cleartext -&gt; Upstream</li>
  <li>Client &lt;- Cleartext -&gt; Kong &lt;- TLS -&gt; Upstream</li>
</ol>

<p><strong>Note:</strong> In L4 proxy mode, only plugins that has <code class="language-plaintext highlighter-rouge">tcp</code> or <code class="language-plaintext highlighter-rouge">tls</code> in the supported
protocol list are supported. This list can be found in their respective documentation
on the <a href="/hub/">Kong Plugin Hub</a>.</p>

<p><a href="#introduction">Back to top</a></p>

<h2 id="proxy-tls-passthrough-traffic">Proxy TLS passthrough traffic</h2>

<p>Kong Gateway supports proxying a TLS request without terminating or known
as SNI proxy.</p>

<p>Kong Gateway uses the connecting 
client’s TLS SNI extension to find the matching Route and Service and forward the
complete TLS request upstream, without decrypting the incoming TLS traffic.</p>

<p>In this mode, you need to:</p>
<ul>
  <li>Create a Route object with the protocol <code class="language-plaintext highlighter-rouge">tls_passthrough</code>, and the 
<code class="language-plaintext highlighter-rouge">snis</code> field set to one or more SNIs.</li>
  <li>Set the corresponding Service object’s protocol to <code class="language-plaintext highlighter-rouge">tcp</code>.</li>
  <li>Send requests to a port that has the <code class="language-plaintext highlighter-rouge">ssl</code> flag in its <code class="language-plaintext highlighter-rouge">stream_listen</code> 
directive.</li>
</ul>

<p>Separate SNI and Certificate entities aren’t required and won’t be used.</p>

<p>Routes are not allowed to match <code class="language-plaintext highlighter-rouge">tls</code> and <code class="language-plaintext highlighter-rouge">tls_passthrough</code> protocols at same time. 
However, the same SNI is allowed to match <code class="language-plaintext highlighter-rouge">tls</code> and <code class="language-plaintext highlighter-rouge">tls_passthrough</code> in different 
Routes.</p>

<p>It’s also possible to set Route to <code class="language-plaintext highlighter-rouge">tls_passthrough</code> and Service to <code class="language-plaintext highlighter-rouge">tls</code>. In this 
mode, the connection to the upstream will be TLS-encrypted twice.</p>

<blockquote class="note">
  <p><strong>Note:</strong>  To run any plugins in this mode, the plugin’s <code class="language-plaintext highlighter-rouge">protocols</code> field must
include <code class="language-plaintext highlighter-rouge">tls_passthrough</code>.</p>
</blockquote>

<p><a href="#introduction">Back to top</a></p>

<h2 id="conclusion">Conclusion</h2>

<p>Through this guide, we hope you gained knowledge of the underlying proxying
mechanism of Kong, from how does a request match a Route to be routed to its
associated Service, on to how to allow for using the WebSocket protocol or
setup dynamic TLS certificates.</p>

<p>This website is open-source and can be found at
<a href="https://github.com/Kong/docs.konghq.com/" target="_blank" rel="noopener nofollow noreferrer ">github.com/Kong/docs.konghq.com</a>.
Feel free to provide feedback to this document there, or propose improvements!</p>

<p>If you haven’t already, we suggest that you also read the <a href="/gateway/2.7.x/reference/loadbalancing">Load balancing
Reference</a>, as it closely relates to the topic we
just covered.</p>

<!--vale off-->



          

        </div>
      </div>
    </div>
    
      <div id="scroll-to-top-button">
        <i class="fas fa-chevron-up"></i>
      </div>
      
        <div class="feedback-widget-container">
  <input id="feedback-widget-checkbox" type="checkbox">
  <label for="feedback-widget-checkbox">
    <img src="/assets/images/icons/feedback-widget.svg" alt="Feedback widget">
  </label>
  <div class="feedback-container">
    <div class="feedback-thankyou">
      Thank you for your feedback.
    </div>
    <div class="feedback-comment">
      <textarea id="feedback-comment-text" rows="3" placeholder="Please let us know what we can improve on this page..."></textarea>
      <div class="feedback-comment-buttons">
        <button id="feedback-comment-button-back">Back</button>
        <button id="feedback-comment-button-submit" class="button-primary">Submit</button>
      </div>
    </div>
    <div class="feedback-options">
      <div class="feedback-options-title">Was this page useful?</div>
      <div class="feedback-options-buttons">
        <i data-feedback-result="yes" class="feedback-options-button far fa-thumbs-up"></i>
        <i data-feedback-result="no" class="feedback-options-button far fa-thumbs-down"></i>
      </div>
    </div>
  </div>
</div>

      
    
  </div>

  <div id="image-modal" data-image-expand-disabled="">
  <div class="image-modal-backdrop"></div>
  <div class="image-container">
    <img src="" alt="">
    <i class="fa fa-times"></i>
  </div>
</div>




  <div class="modal closed" id="modal" role="dialog" aria-hidden="true" aria-labelledby="title" aria-describedby="description">
    <div class="konnect-cta-card">
      <div class="title">
      Too much on your plate?
      <a href="#" class="cta-card-close modal-close" id="modal-close">
          <img src="/assets/images/icons/documentation/close.svg" alt="close cta icon">
        </a>
      </div>
      <div class="description">More features, less infrastructure with Kong Konnect. 1M requests per month for free.</div>
      <a href="https://konghq.com/products/kong-konnect/register?utm_medium=referral&amp;utm_source=docs&amp;utm_campaign=gateway-konnect&amp;utm_campaign=right-nav-card&amp;utm_content=gateway" class="button" target="_blank" rel="noopener nofollow noreferrer ">
      Try it for Free
    </a>
    </div>
  </div>
  <div id="modal-open" class="modal-open"></div>
  <div class="modal-overlay closed" id="modal-overlay"></div>



    <footer class="marketing-footer--light-gray">
  <section>
    <ul class="newsletter">
      <li class="logo-wrapper">
        <div class="logo">
          <img src="/assets/images/logos/kong-logo-blue.svg" alt="Kong">
        </div>
        <div class="footer-title">Powering the API world</div>
        <p>
          Increase developer productivity, security, and performance at scale with the unified platform for API management, service mesh, and ingress controller.
        </p>
        <div class="footer-form-container">
          <form id="subscribe-form" method="POST" action="/assets/javascripts/subscribe.js">
            <input required id="subscribe-input" type="email" name="email" placeholder="Email" aria-required="true" aria-invalid="false">
            <input id="footer-form-button" type="submit" form="subscribe-form" value="Subscribe">
          </form>

          <div id="form-response"></div>
        </div>
      </li>

      <li class="footer-columns">
        <ul class="footer-columns-product-list">
          <li>
            <nav>
              <div class="footer-category">Products</div>
              <ul>
                <li>
                  <a href="https://konghq.com/products/kong-konnect" target="_blank" rel="noopener nofollow noreferrer ">Kong Konnect</a>
                </li>
                <li>
                  <a href="https://konghq.com/products/kong-enterprise" target="_blank" rel="noopener nofollow noreferrer ">Kong Gateway Enterprise</a>
                </li>
                <li>
                  <a href="https://konghq.com/products/kong-gateway" target="_blank" rel="noopener nofollow noreferrer ">Kong Gateway</a>
                </li>
                <li>
                  <a href="https://konghq.com/products/kong-mesh" target="_blank" rel="noopener nofollow noreferrer ">Kong Mesh</a>
                </li>
                <li>
                  <a href="https://konghq.com/products/kong-ingress-controller" target="_blank" rel="noopener nofollow noreferrer ">Kong Ingress Controller</a>
                </li>
                <li>
                  <a href="https://insomnia.rest/" target="_blank" rel="noopener nofollow noreferrer noopener nofollow noreferrer">Kong Insomnia</a>
                </li>
                <li>
                  <a href="https://konghq.com/product-updates" target="_blank" rel="noopener nofollow noreferrer ">Product Updates</a>
                </li>
                <li>
                  <a href="https://konghq.com/contact-sales" target="_blank" rel="noopener nofollow noreferrer ">Get Started</a>
                </li>
              </ul>
            </nav>
          </li>
          <li>
            <nav>
              <div class="footer-category">Documentation</div>
              <ul>
                <li>
                  <a href="/konnect/">Kong Konnect Docs</a>
                </li>
                <li>
                  <a href="/gateway/latest/">Kong Gateway Docs</a>
                </li>
                <li>
                  <a href="/gateway/latest/kong-enterprise/">Kong Gateway Enterprise Docs</a>
                </li>
                <li>
                  <a href="/mesh/latest/">Kong Mesh Docs</a>
                </li>
                <li>
                  <a href="https://docs.insomnia.rest/" target="_blank" rel="noopener nofollow noreferrer noopener nofollow noreferrer">Kong Insomnia Docs</a>
                </li>
                <li>
                  <a href="/hub/">Kong Konnect Plugin Hub</a>
                </li>
              </ul>
            </nav>
          </li>
          <li>
            <nav>
              <div class="footer-category">Open Source</div>
              <ul>
                <li>
                  <a href="https://konghq.com/install/#kong-community" target="_blank" rel="noopener nofollow noreferrer ">Kong Gateway</a>
                </li>
                <li>
                  <a href="https://kuma.io/" target="_blank" rel="noopener nofollow noreferrer noopener nofollow noreferrer">Kuma</a>
                </li>
                <li>
                  <a href="https://insomnia.rest/" target="_blank" rel="noopener nofollow noreferrer noopener nofollow noreferrer">Insomnia</a>
                </li>
                <li>
                  <a href="https://konghq.com/community" target="_blank" rel="noopener nofollow noreferrer ">Kong Community</a>
                </li>
              </ul>
            </nav>
          </li>
          <li>
            <nav>
              <div class="footer-category">Company</div>
              <ul>
                <li>
                  <a href="https://konghq.com/company/about-us" target="_blank" rel="noopener nofollow noreferrer ">About Kong</a>
                </li>
                <li>
                  <a href="https://konghq.com/customers" target="_blank" rel="noopener nofollow noreferrer ">Customers</a>
                </li>
                <li>
                  <a href="https://konghq.com/company/careers" target="_blank" rel="noopener nofollow noreferrer ">Careers</a>
                </li>
                <li>
                  <a href="https://konghq.com/press-room" target="_blank" rel="noopener nofollow noreferrer ">Press</a>
                </li>
                <li>
                  <a href="https://konghq.com/events" target="_blank" rel="noopener nofollow noreferrer ">Events</a>
                </li>
                <li>
                  <a href="https://konghq.com/company/contact-us" target="_blank" rel="noopener nofollow noreferrer ">Contact</a>
                </li>
              </ul>
            </nav>
          </li>
        </ul>
      </li>

    </ul>
  </section>

  <section class="legal">
    <div class="container d-flex">
      <div class="social">
        <div class="social-link">
          <a href="https://www.facebook.com/konghq/" title="Facebook" target="_blank" rel="noopener nofollow noreferrer "><i aria-label="Facebook" class="fa fa-facebook-official" aria-hidden="true"></i></a>
        </div>
        <div class="social-link">
          <a href="https://twitter.com/thekonginc" title="Twitter" target="_blank" rel="noopener nofollow noreferrer "><i aria-label="Twitter" class="fa fa-twitter" aria-hidden="true"></i></a>
        </div>
        <div class="social-link">
          <a href="https://www.meetup.com/topics/kong/all/" title="Meetup" target="_blank" rel="noopener nofollow noreferrer "><i aria-label="Meetup" class="fa fa-meetup" aria-hidden="true"></i></a>
        </div>
        <div class="social-link">
          <a href="https://linkedin.com/company/278819" title="LinkedIn" target="_blank" rel="noopener nofollow noreferrer "><i aria-label="GitHub" class="fa fa-linkedin" aria-hidden="true"></i></a>
        </div>
        <div class="social-link">
          <a href="https://github.com/kong/kong" target="_blank" class="btn-gh" title="GitHub" rel="noopener nofollow noreferrer ">
            <i class="fa fa-github" aria-hidden="true" aria-label="GitHub"></i>
          </a>
        </div>
      </div>
      <ul>
        <li>
          <span class="mashape-footer-content">
            <a href="https://konghq.com/terms" target="_blank" rel="noopener nofollow noreferrer ">Terms</a><b>•</b>
            <a href="https://konghq.com/privacy" target="_blank" rel="noopener nofollow noreferrer ">Privacy</a><b>•</b>
            <a href="https://konghq.com/compliance" target="_blank" rel="noopener nofollow noreferrer ">Trust and Compliance</a>
          </span>
        </li>
      </ul>
      <div>
        <span>© Kong Inc. 2024  </span>
      </div>
    </div>
  </section>

  <script type="text/javascript">
    function onSubmit(response) {
      document.getElementById("subscription_form").submit();
      document.getElementById("follow_up_subscription_form").submit();
      if (response.length == 0) {
        alert("reCaptcha verification failed");
      }
    }
  </script>
</footer>
 <script>
  var anchorForId = function (id) {
    var anchor = document.createElement("a");
    anchor.className = "header-link";
    anchor.href      = "#" + id;
    anchor.innerHTML = "<i class=\"fa fa-link\"></i>";
    anchor.title = `${id} Permalink`;
    return anchor;
  };

  document.onreadystatechange = function () {
    if (this.readyState === "complete") {
      var className =
        ".show-anchor-links h1, .show-anchor-links h2, .show-anchor-links h3, " +
        ".show-anchor-links h4, .show-anchor-links h5, .show-anchor-links h6";
      var headers = document.querySelectorAll(className);

      for (var i = 0; i < headers.length; i++) {
        var header = headers[i];
        if (typeof header.id !== "undefined" && header.id !== "") {
          header.prepend(anchorForId(header.id));
        }
      }
    }
  };
</script>


    
      <script>
        (function stp(){
          if (typeof analytics == "undefined"){
            return setTimeout(stp, 30);
          }
          analytics.page();
        })();
      </script>
    

    <div id="fb-root"></div>
    <script id="github-bjs" src="https://buttons.github.io/buttons.js" async defer></script>

    <script type="text/javascript">
      var _vwo_code = (function() {
        var account_id = 125292,
          settings_tolerance = 2000,
          library_tolerance = 2500,
          use_existing_jquery = true,
          // DO NOT EDIT BELOW THIS LINE
          f = false,
          d = document;
        return {
          use_existing_jquery: function() {
            return use_existing_jquery;
          },
          library_tolerance: function() {
            return library_tolerance;
          },
          finish: function() {
            if (!f) {
              f = true;
              var a = d.getElementById('_vis_opt_path_hides');
              if (a) a.parentNode.removeChild(a);
            }
          },
          finished: function() {
            return f;
          },
          load: function(a) {
            var b = d.createElement('script');
            b.src = a;
            b.type = 'text/javascript';
            b.innerText;
            b.onerror = function() {
              _vwo_code.finish();
            };
            d.getElementsByTagName('head')[0].appendChild(b);
          },
          init: function() {
            settings_timer = setTimeout(
              '_vwo_code.finish()',
              settings_tolerance
            );
            this.load(
              '//dev.visualwebsiteoptimizer.com/j.php?a=' +
                account_id +
                '&u=' +
                encodeURIComponent(d.URL) +
                '&r=' +
                Math.random()
            );
            var a = d.createElement('style'),
              b = '',
              h = d.getElementsByTagName('head')[0];
            a.setAttribute('id', '_vis_opt_path_hides');
            a.setAttribute('type', 'text/css');
            if (a.styleSheet) a.styleSheet.cssText = b;
            else a.appendChild(d.createTextNode(b));
            h.appendChild(a);
            return settings_timer;
          }
        };
      })();
      _vwo_settings_timer = _vwo_code.init();
    </script>

    <script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script>

    
      <script type="text/javascript">
        docsearch({
          appId: '05Y6TLHNFZ',
          apiKey: '80483bfe28d9fd036a11a6f6a06454f8',
          indexName: 'konghq',
          container: '#getkong-algolia-search-input',
          disableUserPersonalization: true,
          placeholder: 'Search the docs...',
          // Override selected event to allow for local environment navigation
          transformItems(items) {
            return items.map((item) => {
              var modifiedUrl = window.location.protocol + '//' + window.location.host + item.url.split('docs.konghq.com')[1];
              return { ...item, url: modifiedUrl };
            });
          },
          translations: {
            button: {
              buttonText: 'Search the docs..',
              buttonAriaLabel: 'Search the docs...'
            }
          },
          resultsFooterComponent({ state }) {
            var facetParameters = {};
            
              facetParameters = {"version[0]":"2.7.x","product[0]":"Kong Gateway"};
            

            var queryParams = new URLSearchParams(facetParameters);
            queryParams.set('query', state.query);

            return {
              // The HTML `tag`
              type: 'a',
              ref: undefined,
              constructor: undefined,
              key: state.query,
              // Its props
              props: {
                href: `/search/?${queryParams.toString()}`,
                target: '_blank',
                // Raw text rendered in the HTML element
                children: 'See more >'
              },
              __v: null,
            };
          },
          
           searchParameters: {
              optionalFilters: ['product:deck<score=1>', 'product:Plugin Hub<score=2>', 'product:Kong Gateway<score=3>'],
              facetFilters: [ 'version:2.7.x']
            }
            
          });
      </script>
    
  </div>
</body>

  

</html>

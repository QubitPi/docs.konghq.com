<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/Article">

  

<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
    <!-- OneTrust Cookies Consent Notice start for konghq.com -->
    <script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" type="text/javascript" charset="UTF-8" data-domain-script="2c4de954-6bec-4e93-8086-64cb113f151a">
    </script>
    <script type="text/javascript">
    function OptanonWrapper() { }
    </script>
    <!-- OneTrust Cookies Consent Notice end for konghq.com -->

    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-NL48VKT');</script>
    <!-- End Google Tag Manager -->
  

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Fallback Configuration - Kong Ingress Controller - v3.3.x | Kong Docs</title>
  <meta name="description" content="Documentation for Kong, the Cloud Connectivity Company for APIs and Microservices.">
  <meta name="author" content="KongHQ">
  <meta property="og:title" content="Fallback Configuration - Kong Ingress Controller - v3.3.x | Kong Docs">
  <meta property="og:site_name" content="Kong Docs">
  <!-- use share link for facebook -->
  <meta property="og:url" content="https://docs.konghq.com">
  <meta property="og:description" content="Documentation for Kong, the Cloud Connectivity Company for APIs and Microservices.">
  <meta property="og:type" content="website">
  <meta property="og:locale" content="en_US">
  <meta property="og:image" content="https://docs.konghq.com/assets/images/share.png">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@thekonginc">
  <meta name="twitter:creator" content="@thekonginc">
  <meta name="twitter:url" content="https://docs.konghq.com">
  <meta name="twitter:description" content="Documentation for Kong, the Cloud Connectivity Company for APIs and Microservices.">
  <meta name="twitter:image" content="https://docs.konghq.com/assets/images/share.png">
  <meta property="fb:admins" content="227304446">
  <meta property="fb:admins" content="576641408">
  <meta name="google-site-verification" content="CrU3zp02dNKTe8NSAipL4NCPkrIjDXG8fViTZ-MIzP4">

  

  <script type="application/ld+json">
    {
      "@context": "http://schema.org",
      "@type": "Organization",
      "name": "KongHQ",
      "url": "https://docs.konghq.com",
      "logo": "https://docs.konghq.com/assets/images/logo.png",
      "sameAs": [
        "https://www.facebook.com/konginc",
        "https://twitter.com/thekonginc",
        "https://plus.google.com/+mashape"
      ]
    }
  </script>

  <!-- Preload assets -->
  <link rel="dns-prefetch" href="https://cloud.typography.com">
  <link rel="dns-prefetch" href="https://dev.visualwebsiteoptimizer.com">
  <link rel="dns-prefetch" href="https://cdn.segment.com">

  <link rel="icon" type="image/x-icon" href="/assets/images/favicon.ico">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3">

  
    <link rel="canonical" href="https://docs.konghq.com/kubernetes-ingress-controller/latest/guides/high-availability/fallback-config/">
  

  
    <meta name="robots" content="follow,noindex">
  

  <!-- FontAwesome icon font -->
  <script src="https://kit.fontawesome.com/1332a92967.js" crossorigin="anonymous">
  </script>

  
  <script src="/vite/assets/application-DqmI9sc2.js" crossorigin="anonymous" type="module"></script>
<link href="/vite/assets/_commonjsHelpers-Cpj98o6Y.js" rel="modulepreload" as="script" crossorigin="anonymous">


  

  

  <link rel="stylesheet" href="/vite/assets/application-CrIf7Il_.css" media="screen">

  
</head>


  <body id="" data-spy="scroll" data-target="#scroll-sidebar" data-offset="350">

    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NL48VKT" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->

    <header class="navbar-v2 closed">
  <a class="skip-main" href="#main">Skip to content</a>
  <!-- uncomment the promo-banner div when adding a new promo banner-->
  <!--also uncomment the promo banner sections in app/assets/stylesheets/header.less and application.js-->
  <!-- <div id="promo-banner">
    <div class="container">
      <div class="closebanner"></div> <strong>2024 API Summit Hackathon: Experiment with API Innovation & AI. Submit by Sept 11 &nbsp;&mdash;<a href="https://konghq.com/conferences/kong-summit/hackathon?utm_medium=website&utm_source=docs-konghq-com&utm_campaign=docs-banner">Enter Now &rarr;</a> </strong>
    </div>
  </div> -->
  <div class="navbar-content">
    <a href="https://konghq.com" class="navbar-brand col col-xl-auto" target="_blank" rel="noopener noreferrer">
      <img src="/assets/images/logos/konglogo-dark-theme.svg" alt="Kong Logo" id="kong-logo">
    </a>
    <span class="logo-divider">|</span>
    <a href="/" class="navbar-brand col col-xl-auto">
      <img src="/assets/images/logos/docslogo-dark-theme.svg" alt="Kong Docs Logo" id="kong-docs-logo">
    </a>

    <div class="separator mobile"></div>
      <div class="search-input-wrapper" id="getkong-algolia-search-input">
    </div>

    <div class="search-results-wrapper"></div>

    <div class="navbar-items" role="navigation" aria-label="Main menu">
      <ul class="navbar-items" role="menubar">
        <li id="top-module-list" aria-haspopup="true" role="menuitem" aria-expanded="false" class="navbar-item main-menu-item with-submenu  active">
          <span tabindex="0" id="docs-link" class="main-menu-item-title">Docs</span>
          <span class="caret"></span>
          <ul class="navbar-item-submenu" role="menu">
            <div class="submenu-section">
              <li role="menuitem" class="docs-dropdown-li">
                <a href="/api/" class="docs-dropdown-li__link" tabindex="-1">
                  <div class="docs-dropdown-li__card">
                    <span class="heading">Explore the API Specs</span>
                    <div class="docs-dropdown-li__card-link">
                      <img src="/assets/images/landing-page/view-all-api-specs.png" alt="View all API Specs">
                      <span class="docs-dropdown-li__card-image">
                        View all API Specs
                        <img src="/assets/images/landing-page/arrow-right.svg" alt="View all API Specs arrow image">
                      </span>
                    </div>
                  </div>
                </a>
              </li>

              <li role="menuitem" class="docs-dropdown-li" tabindex="-1">
                <div class="docs-dropdown-li__section">
                  <div class="docs-dropdown-li__section-title">
                    <span class="heading">Documentation</span>
                  </div>

                  <div class="docs-dropdown-li__section-items">
                    <a class="item item-all" href="/api/" tabindex="-1">
                      <div class="item__description">
                        <div class="item__description-title">API Specs</div>
                      </div>
                    </a>
                    
                      <a class="item" href="/gateway/latest/" tabindex="-1">
                        
                        <div class="item__description">
                          <div class="item__description-title">Kong Gateway</div>
                          <div class="item__description-desc">Lightweight, fast, and flexible cloud-native API gateway</div>
                        </div>
                      </a>
                    
                      <a class="item" href="/konnect/" tabindex="-1">
                        
                        <div class="item__description">
                          <div class="item__description-title">Kong Konnect</div>
                          <div class="item__description-desc">Single platform for SaaS end-to-end connectivity</div>
                        </div>
                      </a>
                    
                      <a class="item" href="/gateway/latest/ai-gateway/" tabindex="-1">
                        
                        <div class="item__description">
                          <div class="item__description-title">Kong AI Gateway</div>
                          <div class="item__description-desc">Multi-LLM AI Gateway for GenAI infrastructure</div>
                        </div>
                      </a>
                    
                      <a class="item" href="/mesh/latest/" tabindex="-1">
                        
                        <div class="item__description">
                          <div class="item__description-title">Kong Mesh</div>
                          <div class="item__description-desc">Enterprise service mesh based on Kuma and Envoy</div>
                        </div>
                      </a>
                    
                      <a class="item" href="/deck/latest/" tabindex="-1">
                        
                        <div class="item__description">
                          <div class="item__description-title">decK</div>
                          <div class="item__description-desc">Helps manage Kongâ€™s configuration in a declarative fashion</div>
                        </div>
                      </a>
                    
                      <a class="item" href="/kubernetes-ingress-controller/latest/" tabindex="-1">
                        
                        <div class="item__description">
                          <div class="item__description-title">Kong Ingress Controller</div>
                          <div class="item__description-desc">Works inside a Kubernetes cluster and configures Kong to proxy traffic</div>
                        </div>
                      </a>
                    
                      <a class="item" href="/gateway-operator/latest/" tabindex="-1">
                        
                        <div class="item__description">
                          <div class="item__description-title">Kong Gateway Operator</div>
                          <div class="item__description-desc">Manage your Kong deployments on Kubernetes using YAML Manifests</div>
                        </div>
                      </a>
                    
                      <a class="item" href="https://docs.insomnia.rest/" tabindex="-1" target="_blank" rel="noopener nofollow noreferrer ">
                        
                        <div class="item__description">
                          <div class="item__description-title">Insomnia</div>
                          <div class="item__description-desc">Collaborative API development platform</div>
                        </div>
                      </a>
                    
                  </div>
                </div>
              </li>

            </div>
          </ul>
        </li>

        <li role="menuitem" aria-haspopup="true" aria-expanded="false" class="navbar-item main-menu-item with-submenu navbar-item-hub">
          <span id="plugin-link" class="main-menu-item-title" tabindex="0">Plugin Hub</span>
          <span class="caret"></span>
          <ul class="navbar-item-submenu" role="menu">
            <div class="submenu-section">
              <li role="menuitem" class="docs-dropdown-li">
                <a href="/hub/" class="docs-dropdown-li__link" tabindex="-1">
                  <div class="docs-dropdown-li__card">
                    <span class="heading">Explore the Plugin Hub</span>
                    <div class="docs-dropdown-li__card-link">
                      <img src="/assets/images/landing-page/view-all-plugins.svg" alt="View all plugins">
                      <span class="docs-dropdown-li__card-image">
                        View all plugins
                        <img src="/assets/images/landing-page/arrow-right.svg" alt="View all plugins arrow image">
                      </span>
                    </div>
                  </div>
                </a>
              </li>

              <li role="menuitem" class="docs-dropdown-li">
                <div class="docs-dropdown-li__section">
                  <div class="docs-dropdown-li__section-title">
                    <span class="heading">Functionality</span>
                    <a href="/hub/" class="view-all" tabindex="-1">
                      View all
                      <img src="/assets/images/landing-page/arrow-right.svg" alt="View all arrow image">
                    </a>
                  </div>

                  <div class="docs-dropdown-li__section-items">
                    <a class="item item-all" href="/hub/" tabindex="-1">
                      <div class="item__description">
                        <div class="item__description-title">View all plugins</div>
                      </div>
                    </a>

                    
                      <a class="item" href="/hub/?category=ai" tabindex="-1">
                        <div>
                          <img src="/assets/images/nav/hub/ai.svg" alt="AI's icon">
                        </div>
                        <div class="item__description">
                          <div class="item__description-title">AI</div>
                          <div class="item__description-desc">Govern, secure, and control AI traffic with multi-LLM AI Gateway plugins</div>
                        </div>
                      </a>
                    
                      <a class="item" href="/hub/?category=authentication" tabindex="-1">
                        <div>
                          <img src="/assets/images/nav/hub/lock_person.svg" alt="Authentication's icon">
                        </div>
                        <div class="item__description">
                          <div class="item__description-title">Authentication</div>
                          <div class="item__description-desc">Protect your services with an authentication layer</div>
                        </div>
                      </a>
                    
                      <a class="item" href="/hub/?category=security" tabindex="-1">
                        <div>
                          <img src="/assets/images/nav/hub/shield.svg" alt="Security's icon">
                        </div>
                        <div class="item__description">
                          <div class="item__description-title">Security</div>
                          <div class="item__description-desc">Protect your services with additional security layer</div>
                        </div>
                      </a>
                    
                      <a class="item" href="/hub/?category=traffic-control" tabindex="-1">
                        <div>
                          <img src="/assets/images/nav/hub/route.svg" alt="Traffic Control's icon">
                        </div>
                        <div class="item__description">
                          <div class="item__description-title">Traffic Control</div>
                          <div class="item__description-desc">Manage, throttle and restrict inbound and outbound API traffic</div>
                        </div>
                      </a>
                    
                      <a class="item" href="/hub/?category=serverless" tabindex="-1">
                        <div>
                          <img src="/assets/images/nav/hub/serverless.svg" alt="Serverless's icon">
                        </div>
                        <div class="item__description">
                          <div class="item__description-title">Serverless</div>
                          <div class="item__description-desc">Invoke serverless functions in combination with other plugins</div>
                        </div>
                      </a>
                    
                      <a class="item" href="/hub/?category=analytics-monitoring" tabindex="-1">
                        <div>
                          <img src="/assets/images/nav/hub/bar_chart.svg" alt="Analytics &amp; Monitoring's icon">
                        </div>
                        <div class="item__description">
                          <div class="item__description-title">Analytics &amp; Monitoring</div>
                          <div class="item__description-desc">Visualize, inspect and monitor APIs and microservices traffic</div>
                        </div>
                      </a>
                    
                      <a class="item" href="/hub/?category=transformations" tabindex="-1">
                        <div>
                          <img src="/assets/images/nav/hub/swap_horiz.svg" alt="Transformations's icon">
                        </div>
                        <div class="item__description">
                          <div class="item__description-title">Transformations</div>
                          <div class="item__description-desc">Transform request and responses on the fly on Kong</div>
                        </div>
                      </a>
                    
                      <a class="item" href="/hub/?category=logging" tabindex="-1">
                        <div>
                          <img src="/assets/images/nav/hub/list_alt.svg" alt="Logging's icon">
                        </div>
                        <div class="item__description">
                          <div class="item__description-title">Logging</div>
                          <div class="item__description-desc">Log request and response data using the best transport for your infrastructure</div>
                        </div>
                      </a>
                    

                  </div>
                </div>
              </li>
            </div>
          </ul>
        </li>
        <li role="menuitem" class="main-menu-item">
          <a href="https://support.konghq.com/" class="navbar-item" target="_blank" rel="noopener nofollow noreferrer ">Support</a>
        </li>
        <li role="menuitem" class="main-menu-item">
          <a href="https://konghq.com/community/" class="navbar-item" target="_blank" rel="noopener noreferrer">Community</a>
        </li>
        <li role="menuitem" class="main-menu-item">
          <a href="https://education.konghq.com" class="navbar-item" target="_blank" rel="noopener nofollow noreferrer ">Kong Academy</a>
        </li>
      </ul>
      <a id="top-cta" href="https://konghq.com/contact-sales?utm_source=docs.konghq.com" class="navbar-button" target="_blank" rel="noopener nofollow noreferrer ">
        Get a Demo
      </a>
      <a id="konnect-cta" href="https://konghq.com/products/kong-konnect/register?utm_medium=referral&amp;utm_source=docs&amp;utm_campaign=gateway-konnect&amp;utm_content=top-nav" class="navbar-button" target="_blank" rel="noopener nofollow noreferrer ">
        Start Free Trial
      </a>
    </div>
    <div id="navbar-menu-toggle-button" class="small-screen-button" aria-label="Toggle navigation">
      <div></div>
      <div></div>
      <div></div>
    </div>
  </div>
</header>


    

<div class="page v2 " data-url="/kubernetes-ingress-controller/3.3.x/guides/high-availability/fallback-config/">
  <div class="page--header-background page--header-background-doc"></div>
  <div class="container">

    <header class="page-header page-header-doc">
      <div class="page-header-product-version">
        <div class="edition">
          Kong Ingress Controller
          
        </div>
        
        <div class="version">
          3.3.x
          
            <span>(latest)</span>
          
          
        </div>
        
      </div>
      <div class="page-header--nav">
        <i class="sidebar-toggle"></i>

        
          









  <ul class="breadcrumbs">
    <li class="breadcrumb-item">
      <a href="/">
        <img src="/assets/images/icons/hub-layout/icn-breadcrumbs.svg" alt="Home icon">
      </a>
    </li>
    <li class="breadcrumb-item">
      <a href="/kubernetes-ingress-controller/3.3.x/">Kong Ingress Controller</a>
    </li>

    
    
      

      

      
      

      
      

      
        <li class="breadcrumb-item">
          
          Guides
          
        </li>
      
    
      

      

      
      

      
      

      
        <li class="breadcrumb-item">
          
          High Availability
          
        </li>
      
    
      

      

      
      

      
      

      
    

    
    
    <li class="breadcrumb-item">
      <a href="/kubernetes-ingress-controller/3.3.x/guides/high-availability/fallback-config/">Fallback Configuration</a>
    </li>
  </ul>

        

        

        <div class="github-links">
  <div class="github-links--edit">
    
      <a href="https://github.com/Kong/docs.konghq.com/edit/main/app/_src/kubernetes-ingress-controller/guides/high-availability/fallback-config.md" target="_blank" rel="noopener nofollow noreferrer ">
        <img src="/assets/images/icons/third-party/logo-github-white.svg" alt="github-edit-page">Edit this page
      </a>
    
  </div>
  <div class="github-links--issues">
    <a href="https://github.com/Kong/docs.konghq.com/issues" target="_blank" rel="noopener nofollow noreferrer ">
      <img src="/assets/images/icons/documentation/icn-monitoring-white.svg" alt="report-issue">Report an issue</a>
  </div>
</div>


      </div>
    </header>

    

<aside class="docs-sidebar">
  <i class="fa fa-times close-sidebar"></i>

  <div class="sidebar-title-container">
    <div class="docsets-dropdown dropdown">
      <button class="dropdown-button" id="module-dropdown" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" tabindex="0">
        <span>
          Kong Ingress Controller
          
        </span>
        <span class="caret"></span>
      </button>
      <ul class="dropdown-menu dropdown-menu-right with-submenu" id="module-list" role="menu" aria-labelledby="module-dropdown" aria-hidden="true">

        <li role="menuitem" tabindex="-1">
          <a href="/gateway/latest/">Kong Gateway</a>
        </li>
        <li role="menuitem" tabindex="-1">
          <a href="/konnect/">Kong Konnect</a>
        </li>
        <li role="menuitem" tabindex="-1">
          <a href="/mesh/latest/">Kong Mesh</a>
        </li>
        <li role="menuitem" tabindex="-1">
          <a href="/hub/?category=ai">Kong AI Gateway</a>
        </li>
        <li role="menuitem" tabindex="-1">
          <a href="/hub/">Plugin Hub</a>
        </li>
        <li role="menuitem" tabindex="-1">
          <a href="/deck/latest/">decK</a>
        </li>
        <li role="menuitem" tabindex="-1" class="active">
          <a href="/kubernetes-ingress-controller/latest/" class="active">Kong Ingress Controller</a>
        </li>
        <li role="menuitem" tabindex="-1">
          <a href="/gateway-operator/latest/">Kong Gateway Operator</a>
        </li>
        <li>
          <a href="https://docs.insomnia.rest/" target="_blank" rel="noopener nofollow noreferrer ">Insomnia</a>
        </li>
        <li role="menuitem" tabindex="-1">
          <a href="https://kuma.io/docs/" target="_blank" rel="noopener nofollow noreferrer ">Kuma</a>
        </li>
        <hr>
        <li role="menuitem" tabindex="-1">
          <a href="/contributing/">Docs contribution guidelines</a>
        </li>
      </ul>
    </div>

    
    <div class="versions-dropdown dropdown">
      <button class="dropdown-button" id="version-dropdown" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" tabindex="0">
        <span>
          Version 3.3.x
          
            <span>(latest)</span>
          
          
        </span>
        <span class="caret"></span>
      </button>
      <ul class="dropdown-menu dropdown-menu-right" id="version-list" role="menu" aria-labelledby="version-dropdown" aria-hidden="true">
        
          <li class="active" role="menuitem" tabindex="-1">
            <a href="/kubernetes-ingress-controller/3.3.x/guides/high-availability/fallback-config/" class="active" data-version-id="3.3.x">
              3.3.x <em>(latest)</em>
            </a>
          </li>
        
          <li role="menuitem" tabindex="-1">
            <a href="/kubernetes-ingress-controller/3.2.x/guides/high-availability/fallback-config/" data-version-id="3.2.x">
              3.2.x
            </a>
          </li>
        
          <li role="menuitem" tabindex="-1">
            <a href="/kubernetes-ingress-controller/3.1.x/" data-version-id="3.1.x">
              3.1.x
            </a>
          </li>
        
          <li role="menuitem" tabindex="-1">
            <a href="/kubernetes-ingress-controller/3.0.x/" data-version-id="3.0.x">
              3.0.x
            </a>
          </li>
        
          <li role="menuitem" tabindex="-1">
            <a href="/kubernetes-ingress-controller/2.12.x/" data-version-id="2.12.x">
              2.12.x (LTS)
            </a>
          </li>
        
          <li role="menuitem" tabindex="-1">
            <a href="/kubernetes-ingress-controller/2.11.x/" data-version-id="2.11.x">
              2.11.x
            </a>
          </li>
        
          <li role="menuitem" tabindex="-1">
            <a href="/kubernetes-ingress-controller/2.10.x/" data-version-id="2.10.x">
              2.10.x
            </a>
          </li>
        
          <li role="menuitem" tabindex="-1">
            <a href="/kubernetes-ingress-controller/2.9.x/" data-version-id="2.9.x">
              2.9.x
            </a>
          </li>
        
          <li role="menuitem" tabindex="-1">
            <a href="/kubernetes-ingress-controller/2.8.x/" data-version-id="2.8.x">
              2.8.x
            </a>
          </li>
        
          <li role="menuitem" tabindex="-1">
            <a href="/kubernetes-ingress-controller/2.7.x/" data-version-id="2.7.x">
              2.7.x
            </a>
          </li>
        
          <li role="menuitem" tabindex="-1">
            <a href="/kubernetes-ingress-controller/2.6.x/" data-version-id="2.6.x">
              2.6.x
            </a>
          </li>
        
          <li role="menuitem" tabindex="-1">
            <a href="/kubernetes-ingress-controller/2.5.x/" data-version-id="2.5.x">
              2.5.x (LTS)
            </a>
          </li>
        
        
      </ul>
    </div>
    
  </div>

  <ul class="sidebar-container" role="tree" aria-label="Documentation">
    
      <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label" aria-expanded="false" aria-owns="id-1-introduction-subtree">
    
      
  <img src="/assets/images/icons/documentation/icn-flag.svg" alt="">


Introduction

    

    
      <button class="sidebar-tree-toggle" aria-label="toggle Introduction subtree" tabindex="-1">
        <i class="fa fa-chevron-down"></i>
      </button>
    
  </span>

  
    <ul class="items" id="id-1-introduction-subtree" role="group" aria-label="Introduction">
      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/">
        

Overview

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/gateway-api/">
        

Kubernetes Gateway API

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/support-policy/">
        

Version Support Policy

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="https://github.com/Kong/kubernetes-ingress-controller/blob/main/CHANGELOG.md/" target="_blank" rel="noopener nofollow noreferrer ">
        

Changelog

      </a>
    

    
  </span>

  
</li>

      
    </ul>
  
</li>

    
      <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label" aria-expanded="false" aria-owns="id-2-how-kic-works-subtree">
    
      
  <img src="/assets/images/icons/documentation/icn-kubernetes-color.svg" alt="">


How KIC Works

    

    
      <button class="sidebar-tree-toggle" aria-label="toggle How KIC Works subtree" tabindex="-1">
        <i class="fa fa-chevron-down"></i>
      </button>
    
  </span>

  
    <ul class="items" id="id-2-how-kic-works-subtree" role="group" aria-label="How KIC Works">
      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/concepts/architecture/">
        

Architecture

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/concepts/gateway-api/">
        

Gateway API

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/concepts/ingress/">
        

Ingress

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/concepts/custom-resources/">
        

Custom Resources

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/concepts/annotations/">
        

Using Annotations

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/concepts/admission-webhook/">
        

Admission Webhook

      </a>
    

    
  </span>

  
</li>

      
    </ul>
  
</li>

    
      <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label" aria-expanded="false" aria-owns="id-3-get-started-subtree">
    
      
  <img src="/assets/images/icons/documentation/icn-learning.svg" alt="">


Get Started

    

    
      <button class="sidebar-tree-toggle" aria-label="toggle Get Started subtree" tabindex="-1">
        <i class="fa fa-chevron-down"></i>
      </button>
    
  </span>

  
    <ul class="items" id="id-3-get-started-subtree" role="group" aria-label="Get Started">
      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/get-started/">
        

Install KIC

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/get-started/services-and-routes/">
        

Services and Routes

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/get-started/rate-limiting/">
        

Rate Limiting

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/get-started/proxy-caching/">
        

Proxy Caching

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/get-started/key-authentication/">
        

Key Authentication

      </a>
    

    
  </span>

  
</li>

      
    </ul>
  
</li>

    
      <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label" aria-expanded="false" aria-owns="id-4-kic-in-production-subtree">
    
      
  <img src="/assets/images/icons/documentation/icn-deployment-color.svg" alt="">


KIC in Production

    

    
      <button class="sidebar-tree-toggle" aria-label="toggle KIC in Production subtree" tabindex="-1">
        <i class="fa fa-chevron-down"></i>
      </button>
    
  </span>

  
    <ul class="items" id="id-4-kic-in-production-subtree" role="group" aria-label="KIC in Production">
      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label" aria-expanded="false" aria-owns="id-4-1-deployment-topologies-subtree">
    
      

Deployment Topologies

    

    
      <button class="sidebar-tree-toggle" aria-label="toggle Deployment Topologies subtree" tabindex="-1">
        <i class="fa fa-chevron-down"></i>
      </button>
    
  </span>

  
    <ul class="items" id="id-4-1-deployment-topologies-subtree" role="group" aria-label="Deployment Topologies">
      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/production/deployment-topologies/">
        

Overview

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/production/deployment-topologies/gateway-discovery/">
        

Gateway Discovery

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/production/deployment-topologies/db-backed/">
        

Database Backed

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/production/deployment-topologies/sidecar/">
        

Traditional (sidecar)

      </a>
    

    
  </span>

  
</li>

      
    </ul>
  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label" aria-expanded="false" aria-owns="id-4-2-installation-methods-subtree">
    
      

Installation Methods

    

    
      <button class="sidebar-tree-toggle" aria-label="toggle Installation Methods subtree" tabindex="-1">
        <i class="fa fa-chevron-down"></i>
      </button>
    
  </span>

  
    <ul class="items" id="id-4-2-installation-methods-subtree" role="group" aria-label="Installation Methods">
      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/install/helm/">
        

Helm

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/install/gateway-operator/">
        

Kong Gateway Operator

      </a>
    

    
  </span>

  
</li>

      
    </ul>
  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label" aria-expanded="false" aria-owns="id-4-3-cloud-deployment-subtree">
    
      

Cloud Deployment

    

    
      <button class="sidebar-tree-toggle" aria-label="toggle Cloud Deployment subtree" tabindex="-1">
        <i class="fa fa-chevron-down"></i>
      </button>
    
  </span>

  
    <ul class="items" id="id-4-3-cloud-deployment-subtree" role="group" aria-label="Cloud Deployment">
      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/install/cloud/aks/">
        

Azure

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/install/cloud/eks/">
        

Amazon

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/install/cloud/gke/">
        

Google

      </a>
    

    
  </span>

  
</li>

      
    </ul>
  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/license/">
        

Enterprise License

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label" aria-expanded="false" aria-owns="id-4-5-observability-subtree">
    
      

Observability

    

    
      <button class="sidebar-tree-toggle" aria-label="toggle Observability subtree" tabindex="-1">
        <i class="fa fa-chevron-down"></i>
      </button>
    
  </span>

  
    <ul class="items" id="id-4-5-observability-subtree" role="group" aria-label="Observability">
      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/production/observability/prometheus/">
        

Prometheus Metrics

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/production/observability/prometheus-grafana/">
        

Configuring Prometheus and Grafana

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/production/observability/events/">
        

Kubernetes Events

      </a>
    

    
  </span>

  
</li>

      
    </ul>
  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label" aria-expanded="false" aria-owns="id-4-6-upgrading-subtree">
    
      

Upgrading

    

    
      <button class="sidebar-tree-toggle" aria-label="toggle Upgrading subtree" tabindex="-1">
        <i class="fa fa-chevron-down"></i>
      </button>
    
  </span>

  
    <ul class="items" id="id-4-6-upgrading-subtree" role="group" aria-label="Upgrading">
      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/upgrade/gateway/">
        

Kong Gateway

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/upgrade/kic/">
        

Ingress Controller

      </a>
    

    
  </span>

  
</li>

      
    </ul>
  
</li>

      
    </ul>
  
</li>

    
      <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label" aria-expanded="false" aria-owns="id-5-guides-subtree">
    
      
  <img src="/assets/images/icons/documentation/icn-solution-guide.svg" alt="">


Guides

    

    
      <button class="sidebar-tree-toggle" aria-label="toggle Guides subtree" tabindex="-1">
        <i class="fa fa-chevron-down"></i>
      </button>
    
  </span>

  
    <ul class="items" id="id-5-guides-subtree" role="group" aria-label="Guides">
      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label" aria-expanded="false" aria-owns="id-5-1-service-configuration-subtree">
    
      

Service Configuration

    

    
      <button class="sidebar-tree-toggle" aria-label="toggle Service Configuration subtree" tabindex="-1">
        <i class="fa fa-chevron-down"></i>
      </button>
    
  </span>

  
    <ul class="items" id="id-5-1-service-configuration-subtree" role="group" aria-label="Service Configuration">
      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/guides/services/http/">
        

HTTP Service

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/guides/services/tcp/">
        

TCP Service

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/guides/services/udp/">
        

UDP Service

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/guides/services/grpc/">
        

gRPC Service

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/guides/services/tls/">
        

TLS

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/guides/services/external/">
        

External Service

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/guides/services/https-redirect/">
        

HTTPS Redirects

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/guides/services/multiple-backends/">
        

Multiple Backend Services

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/guides/services/cross-namespace/">
        

Configuring Gateway API resources across namespaces

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/guides/services/custom-entity/">
        

Configuring Custom Kong Entities

      </a>
    

    
  </span>

  
</li>

      
    </ul>
  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label" aria-expanded="false" aria-owns="id-5-2-request-manipulation-subtree">
    
      

Request Manipulation

    

    
      <button class="sidebar-tree-toggle" aria-label="toggle Request Manipulation subtree" tabindex="-1">
        <i class="fa fa-chevron-down"></i>
      </button>
    
  </span>

  
    <ul class="items" id="id-5-2-request-manipulation-subtree" role="group" aria-label="Request Manipulation">
      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/guides/requests/rewrite-host-and-paths/">
        

Rewriting Hosts and Paths

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/guides/requests/rewrite-annotation/">
        

Rewrite Annotation

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/guides/requests/customizing-load-balancing/">
        

Customizing load-balancing behavior

      </a>
    

    
  </span>

  
</li>

      
    </ul>
  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label" aria-expanded="false" aria-owns="id-5-3-high-availability-subtree">
    
      

High Availability

    

    
      <button class="sidebar-tree-toggle" aria-label="toggle High Availability subtree" tabindex="-1">
        <i class="fa fa-chevron-down"></i>
      </button>
    
  </span>

  
    <ul class="items" id="id-5-3-high-availability-subtree" role="group" aria-label="High Availability">
      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/guides/high-availability/kic/">
        

KIC High Availability

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/guides/high-availability/health-checks/">
        

Service Health Checks

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/guides/high-availability/last-known-good-config/">
        

Last Known Good Config

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/guides/high-availability/fallback-config/">
        

Fallback Configuration

      </a>
    

    
  </span>

  
</li>

      
    </ul>
  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label" aria-expanded="false" aria-owns="id-5-4-security-subtree">
    
      

Security

    

    
      <button class="sidebar-tree-toggle" aria-label="toggle Security subtree" tabindex="-1">
        <i class="fa fa-chevron-down"></i>
      </button>
    
  </span>

  
    <ul class="items" id="id-5-4-security-subtree" role="group" aria-label="Security">
      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/guides/security/kong-vault/">
        

Kong Vaults

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/guides/security/workspaces/">
        

Using Workspaces

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/guides/security/client-ip/">
        

Preserving Client IP

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/guides/security/plugin-secrets/">
        

Kubernetes Secrets in Plugins

      </a>
    

    
  </span>

  
</li>

      
    </ul>
  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label" aria-expanded="false" aria-owns="id-5-5-migrate-subtree">
    
      

Migrate

    

    
      <button class="sidebar-tree-toggle" aria-label="toggle Migrate subtree" tabindex="-1">
        <i class="fa fa-chevron-down"></i>
      </button>
    
  </span>

  
    <ul class="items" id="id-5-5-migrate-subtree" role="group" aria-label="Migrate">
      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/guides/migrate/kongingress/">
        

KongIngress to KongUpstreamPolicy

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/guides/migrate/ingress-to-gateway/">
        

Migrating from Ingress to Gateway

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/guides/migrate/credential-kongcredtype-label/">
        

Credential Type Labels

      </a>
    

    
  </span>

  
</li>

      
    </ul>
  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label" aria-expanded="false" aria-owns="id-5-6-customize-deployments-subtree">
    
      

Customize Deployments

    

    
      <button class="sidebar-tree-toggle" aria-label="toggle Customize Deployments subtree" tabindex="-1">
        <i class="fa fa-chevron-down"></i>
      </button>
    
  </span>

  
    <ul class="items" id="id-5-6-customize-deployments-subtree" role="group" aria-label="Customize Deployments">
      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/guides/customize/image/">
        

Images

      </a>
    

    
  </span>

  
</li>

      
    </ul>
  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label" aria-expanded="false" aria-owns="id-5-7-custom-ingress-class-subtree">
    
      

Custom Ingress Class

    

    
      <button class="sidebar-tree-toggle" aria-label="toggle Custom Ingress Class subtree" tabindex="-1">
        <i class="fa fa-chevron-down"></i>
      </button>
    
  </span>

  
    <ul class="items" id="id-5-7-custom-ingress-class-subtree" role="group" aria-label="Custom Ingress Class">
      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/guides/custom-class/internal-external/">
        

Internal / External Traffic

      </a>
    

    
  </span>

  
</li>

      
    </ul>
  
</li>

      
    </ul>
  
</li>

    
      <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label" aria-expanded="false" aria-owns="id-6-plugins-subtree">
    
      
  <img src="/assets/images/icons/documentation/icn-api-plugins-color.svg" alt="">


Plugins

    

    
      <button class="sidebar-tree-toggle" aria-label="toggle Plugins subtree" tabindex="-1">
        <i class="fa fa-chevron-down"></i>
      </button>
    
  </span>

  
    <ul class="items" id="id-6-plugins-subtree" role="group" aria-label="Plugins">
      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/plugins/custom/">
        

Custom Plugins

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/plugins/authentication/">
        

Authentication

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/plugins/acl/">
        

ACL

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/plugins/rate-limiting/">
        

Rate Limiting

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/plugins/mtls/">
        

mTLS

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/plugins/oidc/">
        

OIDC

      </a>
    

    
  </span>

  
</li>

      
    </ul>
  
</li>

    
      <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label" aria-expanded="false" aria-owns="id-7-reference-subtree">
    
      
  <img src="/assets/images/icons/documentation/icn-references-color.svg" alt="">


Reference

    

    
      <button class="sidebar-tree-toggle" aria-label="toggle Reference subtree" tabindex="-1">
        <i class="fa fa-chevron-down"></i>
      </button>
    
  </span>

  
    <ul class="items" id="id-7-reference-subtree" role="group" aria-label="Reference">
      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/reference/troubleshooting/">
        

Troubleshooting

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/reference/version-compatibility/">
        

Version Compatibility

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/reference/annotations/">
        

Annotations

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/reference/cli-arguments/">
        

Configuration Options

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/reference/feature-gates/">
        

Beta Feature Gates

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label" aria-expanded="false" aria-owns="id-7-6-faq-subtree">
    
      

FAQ

    

    
      <button class="sidebar-tree-toggle" aria-label="toggle FAQ subtree" tabindex="-1">
        <i class="fa fa-chevron-down"></i>
      </button>
    
  </span>

  
    <ul class="items" id="id-7-6-faq-subtree" role="group" aria-label="FAQ">
      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/hub/plugins/compatibility/">
        

Plugin Compatibility

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/reference/faq/router/">
        

Kong Router

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/reference/faq/nginx.conf/">
        

Custom nginx.conf

      </a>
    

    
  </span>

  
</li>

      
    </ul>
  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/reference/custom-resources/">
        

Custom Resource Definitions

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/reference/resource-requiring-ingress-class/">
        

Resources Requiring Setting Ingress Class

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/reference/ingress-to-gateway-migration/">
        

Gateway API migration

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/reference/required-permissions/">
        

Required Permissions for Installation

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/kubernetes-ingress-controller/3.3.x/reference/failure-modes/">
        

Categories of Failures

      </a>
    

    
  </span>

  
</li>

      
    </ul>
  
</li>

    
  </ul>
</aside>




      <aside class="docs-toc">
        <i class="fa fa-times close-sidebar"></i>
        <i class="fa fa-chevron-right collapse-toc"></i>
        <i class="far fa-list-alt expand-toc"></i>

        <div id="oss-ee-toggle" data-current="Enterprise" style="display: none">
          <span class="oss-ee-toggle-inner">
            <img src="/assets/images/icons/icn-enterprise-black.svg" alt="enterprise-switcher-icon">
            <span>Switch to <span id="switch-to-version">OSS</span></span>
          </span>
        </div>

        
        <div class="docs-toc-title">
<img src="/assets/images/icons/hub-layout/icn-on-this-page.svg" alt="On this page"><a href="#">On this page</a>
</div>
<ul>
  <li>
<a href="#prerequisites" class="active scroll-to">Prerequisites</a>
    <ul>
      <li><a href="#install-the-gateway-apis" class="scroll-to">Install the Gateway APIs</a></li>
      <li><a href="#install-kong" class="scroll-to">Install Kong</a></li>
      <li><a href="#test-connectivity-to-kong" class="scroll-to">Test connectivity to Kong</a></li>
    </ul>
  </li>
  <li><a href="#overview" class="scroll-to">Overview</a></li>
  <li><a href="#how-it-works" class="scroll-to">How it works</a></li>
  <li>
<a href="#example-scenario" class="scroll-to">Example Scenario</a>
    <ul>
      <li><a href="#excluding-broken-objects" class="scroll-to">Excluding broken objects</a></li>
      <li><a href="#backfilling-broken-objects" class="scroll-to">Backfilling broken objects</a></li>
      <li><a href="#inspecting-the-fallback-configuration-process" class="scroll-to">Inspecting the Fallback Configuration process</a></li>
    </ul>
  </li>
</ul>

        
      </aside>

    <div class="page-content-container page-content-container-doc v2 " id="documentation">
      <div class="toggles ">
          <i class="far fa-list-alt toc-sidebar-toggle"></i>
      </div>

      <div class="page-content">
        <div class="content show-anchor-links">
          

          <h1 tabindex="-1" id="main" class="page-content-title">Fallback Configuration
            

            
          </h1>

          

          
          

          <p>In this guide youâ€™ll learn about the Fallback Configuration feature. Weâ€™ll explain its
implementation details and provide an example scenario to demonstrate how it works in practice.</p>

<details class="custom">
  <summary>
<blockquote class="note">
  <p style="cursor: pointer">Before you begin ensure that you have <u>Installed Kong Ingress Controller</u> with Gateway API support in your Kubernetes cluster and are able to connect to Kong. </p>
</blockquote>
</summary>

  <h2 id="prerequisites">Prerequisites</h2>

  <h3 id="install-the-gateway-apis">Install the Gateway APIs</h3>

  <ol>
    <li>
      <p>Install the Gateway API CRDs before installing Kong Ingress Controller.</p>

      <div class="language-bash highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> kubectl apply <span class="nt">-f</span> https://github.com/kubernetes-sigs/gateway-api/releases/download/v1.1.0/standard-install.yaml
</code></pre></div>      </div>
    </li>
    <li>
      <p>Create a <code class="language-plaintext highlighter-rouge">Gateway</code> and <code class="language-plaintext highlighter-rouge">GatewayClass</code> instance to use.</p>

      <div class="language-bash highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s2">"
---
apiVersion: gateway.networking.k8s.io/v1
kind: GatewayClass
metadata:
  name: kong
  annotations:
    konghq.com/gatewayclass-unmanaged: 'true'

spec:
  controllerName: konghq.com/kic-gateway-controller
---
apiVersion: gateway.networking.k8s.io/v1
kind: Gateway
metadata:
  name: kong
spec:
  gatewayClassName: kong
  listeners:
  - name: proxy
    port: 80
    protocol: HTTP
"</span> | kubectl apply <span class="nt">-f</span> -
</code></pre></div>      </div>

      <p>The results should look like this:</p>
      <div class="language-text highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>gatewayclass.gateway.networking.k8s.io/kong created
gateway.gateway.networking.k8s.io/kong created
</code></pre></div>      </div>
    </li>
  </ol>

  <h3 id="install-kong">Install Kong</h3>
  <p>You can install Kong in your Kubernetes cluster using <a href="https://helm.sh/" target="_blank" rel="noopener nofollow noreferrer ">Helm</a>.</p>
  <ol>
    <li>
      <p>Add the Kong Helm charts:</p>

      <div class="language-bash highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> helm repo add kong https://charts.konghq.com
 helm repo update
</code></pre></div>      </div>
    </li>
    <li>
      <p>Install Kong Ingress Controller and Kong Gateway with Helm:</p>

      <div class="language-bash highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> helm <span class="nb">install </span>kong kong/ingress <span class="nt">-n</span> kong <span class="nt">--create-namespace</span> 
</code></pre></div>      </div>
    </li>
  </ol>

  <h3 id="test-connectivity-to-kong">Test connectivity to Kong</h3>

  <p>Kubernetes exposes the proxy through a Kubernetes service. Run the following commands to store the load balancer IP address in a variable named <code class="language-plaintext highlighter-rouge">PROXY_IP</code>:</p>

  <ol>
    <li>
      <p>Populate <code class="language-plaintext highlighter-rouge">$PROXY_IP</code> for future commands:</p>

      <div class="language-bash highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> <span class="nb">export </span><span class="nv">PROXY_IP</span><span class="o">=</span><span class="si">$(</span>kubectl get svc <span class="nt">--namespace</span> kong kong-gateway-proxy <span class="nt">-o</span> <span class="nv">jsonpath</span><span class="o">=</span><span class="s1">'{.status.loadBalancer.ingress[0].ip}'</span><span class="si">)</span>
 <span class="nb">echo</span> <span class="nv">$PROXY_IP</span>
</code></pre></div>      </div>
    </li>
    <li>
      <p>Ensure that you can call the proxy IP:</p>

      <div class="language-bash highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> curl <span class="nt">-i</span> <span class="nv">$PROXY_IP</span>
</code></pre></div>      </div>

      <p>The results should look like this:</p>

      <div class="language-bash highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> HTTP/1.1 404 Not Found
 Content-Type: application/json<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>utf-8
 Connection: keep-alive
 Content-Length: 48
 X-Kong-Response-Latency: 0
 Server: kong/3.0.0
  
 <span class="o">{</span><span class="s2">"message"</span>:<span class="s2">"no Route matched with those values"</span><span class="o">}</span>
</code></pre></div>      </div>
    </li>
  </ol>

</details>

<h2 id="overview">Overview</h2>

<p>Kong Ingress Controller 3.2.0 introduced the Fallback Configuration
feature. It is designed to isolate issues related to individual parts
of the configuration, allowing updates to the rest of it to proceed with no
interruption. If youâ€™re using Kong Ingress Controller in a multi-team environment, the
fallback configuration mechanism can help you avoid lock-ups when one teamâ€™s
configuration is broken.</p>

<blockquote class="note">
  <p><strong>Note:</strong> The Fallback Configuration is an opt-in feature. You must
enable it by setting <code class="language-plaintext highlighter-rouge">FallbackConfiguration=true</code> in the controllerâ€™s feature
gates configuration. See <a href="/kubernetes-ingress-controller/3.3.x/reference/feature-gates">Feature Gates</a>
to learn how to do that.</p>
</blockquote>

<h2 id="how-it-works">How it works</h2>

<p>Kong Ingress Controller translates Kubernetes objects it gets from the Kubernetes API and pushes
the translation result via Kongâ€™s Admin API to Kong Gateway instances. However, issues
can arise at various stages of this process:</p>

<ol>
  <li>Admission Webhook: Validates individual Kubernetes objects against schemas and basic rules.</li>
  <li>Translation Process: Detects issues like cross-object validation errors.</li>
  <li>Kong Response: Kong rejects the configuration and returns an error associated with a specific object.</li>
</ol>

<p>Fallback Configuration is triggered when an issue is detected in the 3rd stage and provides the following benefits:</p>
<ul>
  <li>Allows unaffected objects to be updated even when there are configuration errors.</li>
  <li>Automatically builds a fallback configuration that Kong will accept without requiring user intervention by
either:
    <ul>
      <li>Excluding the broken objects along with its dependants.</li>
      <li>Backfilling the broken object along with its dependants using the last valid Kubernetes objectsâ€™ in-memory cache (if <code class="language-plaintext highlighter-rouge">CONTROLLER_USE_LAST_VALID_CONFIG_FOR_FALLBACK</code> environment variable is set to <code class="language-plaintext highlighter-rouge">true</code>).</li>
    </ul>
  </li>
  <li>Enables users to inspect and identify what objects were excluded from or backfilled in the configuration using
diagnostic endpoints.</li>
</ul>

<p>Below table summarizes the behavior of the Fallback Configuration feature based on the configuration:</p>

<table>
  <thead>
    <tr>
      <th>
<code class="language-plaintext highlighter-rouge">FallbackConfiguration</code> feature gate value</th>
      <th>
<code class="language-plaintext highlighter-rouge">CONTROLLER_USE_LAST_VALID_CONFIG_FOR_FALLBACK</code> value</th>
      <th>Behavior</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">false</code></td>
      <td>
<code class="language-plaintext highlighter-rouge">false</code>/<code class="language-plaintext highlighter-rouge">true</code> (has no effect)</td>
      <td>The last valid configuration is used as a whole to recover (if stored).</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">true</code></td>
      <td><code class="language-plaintext highlighter-rouge">false</code></td>
      <td>The Fallback Configuration is triggered - broken objects and their dependants are excluded.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">true</code></td>
      <td><code class="language-plaintext highlighter-rouge">true</code></td>
      <td>The Fallback Configuration is triggered - broken objects and their dependants are excluded and backfilled with their last valid version (if stored).</td>
    </tr>
  </tbody>
</table>

<p>Below diagram illustrates how the Fallback Configuration feature works in detail:</p>

<!--vale off-->
<script type="module">
  import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
  mermaid.initialize({
    startOnLoad: true,
    theme: 'base',
    themeVariables: {
      'primaryColor': '#fff',
      'primaryBorderColor': '#4a86e8',
      'primaryTextColor': '#495c64',
      'secondaryColor': '#fff',
      'secondaryTextColor': '#5096f2',
      'tertiaryBorderColor': '#AAB4BB',
      'edgeLabelBackground': '#fff',
      'fontFamily': 'Roboto',
      'fontSize': '15px',
      'lineColor': '#99b0c0',
      'activationBorderColor': '#c2d4e0',
      'sequenceNumberColor': '#fff'
    }
  });
</script>

<pre class="mermaid"> 
flowchart TD
classDef sub opacity:0
classDef note stroke:#e1bb86,fill:#fdf3d8
classDef externalCall fill:#9e8ebf,stroke:none,color:#fff
classDef decision fill:#d0e1fb
classDef startEnd fill:#545454,stroke:none,color:#fff

    A([Update loop triggered]) --&gt; B[Generate Kubernetes objects' store
    snapshot to be passed to the Translator]
    B --&gt; C[Translator: generate Kong configuration
    based on the generated snapshot]
    C --&gt; D(Configure Kong Gateways using generated
    declarative configuration)
    D --&gt; E{Configuration
    rejected?}
    E --&gt; |No| G[Store the Kubernetes objects' snapshot
    to be used as the last valid state]
    E --&gt; |Yes| F[Build a dependency graph of Kubernetes
    objects - using the snapshot]
    G --&gt; H[Store the declarative configuration to be
    used as the last valid configuration]
    H --&gt; Z([End of the loop])
    F --&gt; I[Exclude an object along with all its
    dependants from the fallback Kubernetes objects snapshot]
    I --&gt; J[Add a previous valid version of the object along
    with its dependants' previous versions to the fallback snapshot]
    J --&gt; K[Translator: generate Kong configuration
    based on the fallback snapshot]
    K --&gt; L(Configure Kong Gateways using generated
    fallback declarative configuration)
    L --&gt; M{Fallback
    configuration
    rejected?}
    M --&gt; |Yes| N{Was the last
    valid configuration
    preserved?}
    N --&gt; |Yes| O(Configure Kong Gateways using the
    last valid declarative configuration)
    O --&gt; Z
    N --&gt; |No| Z
    M --&gt; |No| P[Store the fallback Kubernetes objects' snapshot
     to be used as the last valid state]
    P --&gt; R[Store the fallback declarative configuration
    to be used as the last valid configuration]
    R --&gt; Z

    subgraph subI [" "]
        I
        noteI[For every invalid object
        reported by the Gateway]
    end

    subgraph subJ [" "]
        J
        noteJ[Given there was a last valid
        Kubernetes objects' store snapshot
        preserved and the object is present]
    end

    class subI,subJ sub
    class noteI,noteJ note
    class D,L,O externalCall
    class A,Z startEnd
    class E,M,N decision

  </pre>
<!--vale on-->

<h2 id="example-scenario">Example Scenario</h2>

<p>In this example weâ€™ll demonstrate how the Fallback Configuration works in practice.</p>

<h3 id="excluding-broken-objects">Excluding broken objects</h3>

<p>First, weâ€™ll demonstrate the default behavior of the Fallback Configuration feature, which is to exclude broken objects
and their dependants from the configuration.</p>

<p>To test the Fallback Configuration, make sure your Kong Ingress Controller instance is running with
the Fallback Configuration feature and diagnostics server enabled.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>helm upgrade <span class="nt">--install</span> kong kong/ingress <span class="nt">-n</span> kong <span class="se">\</span>
  <span class="nt">--set</span> controller.ingressController.env.feature_gates<span class="o">=</span><span class="nv">FallbackConfiguration</span><span class="o">=</span><span class="nb">true</span> <span class="se">\</span>
  <span class="nt">--set</span> controller.ingressController.env.dump_config<span class="o">=</span><span class="nb">true</span>
</code></pre></div></div>

<p>In the example, weâ€™ll consider a situation where:</p>

<ol>
  <li>We have two <code class="language-plaintext highlighter-rouge">HTTPRoute</code>s pointing to the same <code class="language-plaintext highlighter-rouge">Service</code>. One of <code class="language-plaintext highlighter-rouge">HTTPRoute</code>s is configured with <code class="language-plaintext highlighter-rouge">KongPlugin</code>s providing
authentication and base rate-limiting. Everything works as expected.</li>
  <li>We add one more rate-limiting <code class="language-plaintext highlighter-rouge">KongPlugin</code> that is to be associated with the second <code class="language-plaintext highlighter-rouge">HTTPRoute</code> and a specific <code class="language-plaintext highlighter-rouge">KongConsumer</code>
so that it can be rate-limited in a different way than the base rate-limiting, but we forget associate the <code class="language-plaintext highlighter-rouge">KongConsumer</code>
with the <code class="language-plaintext highlighter-rouge">KongPlugin</code>. It results in the <code class="language-plaintext highlighter-rouge">HTTPRoute</code> being broken because of duplicated rate-limiting plugins.</li>
</ol>

<h4 id="deploying-valid-configuration">Deploying valid configuration</h4>

<p>First, letâ€™s deploy the <code class="language-plaintext highlighter-rouge">Service</code> and its backing <code class="language-plaintext highlighter-rouge">Deployment</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kubectl apply <span class="nt">-f</span> https://docs.konghq.com/assets/kubernetes-ingress-controller/examples/echo-service.yaml
</code></pre></div></div>
<p>The results should look like this:</p>
<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>service/echo created
deployment.apps/echo created
</code></pre></div></div>

<p>Next, letâ€™s deploy the <code class="language-plaintext highlighter-rouge">HTTPRoute</code>s. <code class="language-plaintext highlighter-rouge">route-b</code> will refer three <code class="language-plaintext highlighter-rouge">KongPlugin</code>s (<code class="language-plaintext highlighter-rouge">key-auth</code>, <code class="language-plaintext highlighter-rouge">rate-limit-base,</code> <code class="language-plaintext highlighter-rouge">rate-limit-consumer</code>):</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s1">'apiVersion: gateway.networking.k8s.io/v1
kind: HTTPRoute
metadata:
  name: route-a
spec:
  parentRefs:
  - name: kong
  rules:
  - matches:
    - path:
        type: PathPrefix
        value: /route-a
    backendRefs:
    - name: echo
      port: 1027
---
apiVersion: gateway.networking.k8s.io/v1
kind: HTTPRoute
metadata:
  name: route-b
  annotations:
    konghq.com/plugins: key-auth, rate-limit-base, rate-limit-consumer
spec:
  parentRefs:
  - name: kong
  rules:
  - matches:
    - path:
        type: PathPrefix
        value: /route-b
    backendRefs:
    - name: echo
      port: 1027
      '</span> | kubectl apply <span class="nt">-f</span> -
</code></pre></div></div>

<p>The results should look like this:</p>
<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>httproute.gateway.networking.k8s.io/route-a created
httproute.gateway.networking.k8s.io/route-b created
</code></pre></div></div>

<p>Letâ€™s also create the <code class="language-plaintext highlighter-rouge">KongPlugin</code>s:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s1">'apiVersion: configuration.konghq.com/v1
kind: KongPlugin
metadata:
  name: key-auth
plugin: key-auth
---
apiVersion: configuration.konghq.com/v1
kind: KongPlugin
metadata:
  name: rate-limit-base
plugin: rate-limiting
config:
  second: 1
  policy: local
---
apiVersion: configuration.konghq.com/v1
kind: KongPlugin
metadata:
  name: rate-limit-consumer
plugin: rate-limiting
config:
  second: 5
  policy: local'</span> | kubectl apply <span class="nt">-f</span> -
</code></pre></div></div>

<p>The results should look like this:</p>
<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kongplugin.configuration.konghq.com/key-auth created
kongplugin.configuration.konghq.com/rate-limit-base created
kongplugin.configuration.konghq.com/rate-limit-consumer created
</code></pre></div></div>

<p>And finally, letâ€™s create the <code class="language-plaintext highlighter-rouge">KongConsumer</code> with credentials and the <code class="language-plaintext highlighter-rouge">rate-limit-consumer</code> <code class="language-plaintext highlighter-rouge">KongPlugin</code> associated:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s1">'apiVersion: v1
kind: Secret
metadata:
  name: bob-key-auth
  labels:
    konghq.com/credential: key-auth
stringData:
  key: bob-password
---
apiVersion: configuration.konghq.com/v1
kind: KongConsumer
metadata:
  name: bob
  annotations:
    konghq.com/plugins: rate-limit-consumer
    kubernetes.io/ingress.class: kong
username: bob
credentials:
- bob-key-auth
'</span> | kubectl apply <span class="nt">-f</span> -
</code></pre></div></div>

<h4 id="verifying-routes-are-functional">Verifying routes are functional</h4>

<p>Letâ€™s ensure that the <code class="language-plaintext highlighter-rouge">HTTPRoute</code>s are working as expected:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-i</span> <span class="nv">$PROXY_IP</span>/route-a
</code></pre></div></div>

<p>The results should look like this:</p>
<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>HTTP/1.1 200 OK
Content-Type: text/plain; charset=utf-8
Content-Length: 137
Connection: keep-alive
X-Kong-Upstream-Latency: 1
X-Kong-Proxy-Latency: 1
Via: kong/3.6.0
X-Kong-Request-Id: 5bf50016730eae43c359c17b41dc8614

Welcome, you are connected to node orbstack.
Running on Pod echo-74c66b778-szf8f.
In namespace default.
With IP address 192.168.194.13.
</code></pre></div></div>

<p>Authenticated requests with the valid <code class="language-plaintext highlighter-rouge">apikey</code> header on the <code class="language-plaintext highlighter-rouge">route-b</code> should be accepted:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-i</span> <span class="nv">$PROXY_IP</span>/route-b <span class="nt">-H</span> apikey:bob-password
</code></pre></div></div>

<p>The results should look like this:</p>
<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>HTTP/1.1 200 OK
Content-Type: text/plain; charset=utf-8
Content-Length: 137
Connection: keep-alive
X-Kong-Upstream-Latency: 0
X-Kong-Proxy-Latency: 0
Via: kong/3.6.0
X-Kong-Request-Id: 14ae28589baff9459d5bb3476be6f570

Welcome, you are connected to node orbstack.
Running on Pod echo-74c66b778-szf8f.
In namespace default.
With IP address 192.168.194.13.
</code></pre></div></div>

<p>While the requests without the <code class="language-plaintext highlighter-rouge">apikey</code> header should be rejected:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-i</span> <span class="nv">$PROXY_IP</span>/route-b
</code></pre></div></div>

<p>The results should look like this:</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>HTTP/1.1 401 Unauthorized
Content-Type: application/json; charset=utf-8
Connection: keep-alive
WWW-Authenticate: Key realm="kong"
Content-Length: 96
X-Kong-Response-Latency: 0
Server: kong/3.6.0
X-Kong-Request-Id: 520c396c6c32b0400f7c33531b7f9b2c

{
  "message":"No API key found in request",
  "request_id":"520c396c6c32b0400f7c33531b7f9b2c"
}
</code></pre></div></div>

<h4 id="introducing-a-breaking-change-to-the-configuration">Introducing a breaking change to the configuration</h4>

<p>Now, letâ€™s simulate a situation where we introduce a breaking change to the configuration. Weâ€™ll remove the <code class="language-plaintext highlighter-rouge">rate-limit-consumer</code>
<code class="language-plaintext highlighter-rouge">KongPlugin</code> from the <code class="language-plaintext highlighter-rouge">KongConsumer</code> so that the <code class="language-plaintext highlighter-rouge">route-b</code> will now have two <code class="language-plaintext highlighter-rouge">rate-limiting</code> plugins associated with it,
which will cause it to break.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> kubectl annotate kongconsumer bob konghq.com/plugins-
</code></pre></div></div>

<p>The results should look like this:</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kongconsumer.configuration.konghq.com/bob annotated
</code></pre></div></div>

<h4 id="verifying-the-broken-route-was-excluded">Verifying the broken route was excluded</h4>

<p>This will cause the <code class="language-plaintext highlighter-rouge">route-b</code> to break as there are two <code class="language-plaintext highlighter-rouge">KongPlugin</code>s using the same type (<code class="language-plaintext highlighter-rouge">rate-limiting</code>). We expect
the route to be excluded from the configuration.</p>

<p>Letâ€™s verify this:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-i</span> <span class="nv">$PROXY_IP</span>/route-b
</code></pre></div></div>

<p>The results should look like this:</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>HTTP/1.1 404 Not Found
Content-Type: application/json; charset=utf-8
Connection: keep-alive
Content-Length: 103
X-Kong-Response-Latency: 0
Server: kong/3.6.0
X-Kong-Request-Id: 209a6b14781179103528093188ed4008

{
  "message":"no Route matched with those values",
  "request_id":"209a6b14781179103528093188ed4008"
}%
</code></pre></div></div>

<h4 id="inspecting-diagnostic-endpoints">Inspecting diagnostic endpoints</h4>

<p>The route is not configured because the Fallback Configuration mechanism has excluded the broken <code class="language-plaintext highlighter-rouge">HTTPRoute</code>.</p>

<p>We can verify this by inspecting the diagnostic endpoint:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kubectl port-forward <span class="nt">-n</span> kong deploy/kong-controller 10256 &amp;
curl localhost:10256/debug/config/fallback | jq
</code></pre></div></div>

<p>The results should look like this:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"triggered"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"brokenObjects"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"group"</span><span class="p">:</span><span class="w"> </span><span class="s2">"configuration.konghq.com"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"kind"</span><span class="p">:</span><span class="w"> </span><span class="s2">"KongPlugin"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"namespace"</span><span class="p">:</span><span class="w"> </span><span class="s2">"default"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"rate-limit-consumer"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"7167315d-58f5-4aea-8aa5-a9d989f33a49"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"excludedObjects"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"group"</span><span class="p">:</span><span class="w"> </span><span class="s2">"configuration.konghq.com"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"kind"</span><span class="p">:</span><span class="w"> </span><span class="s2">"KongPlugin"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"v1"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"namespace"</span><span class="p">:</span><span class="w"> </span><span class="s2">"default"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"rate-limit-consumer"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"7167315d-58f5-4aea-8aa5-a9d989f33a49"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"causingObjects"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"configuration.konghq.com/KongPlugin:default/rate-limit-consumer"</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"group"</span><span class="p">:</span><span class="w"> </span><span class="s2">"gateway.networking.k8s.io"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"kind"</span><span class="p">:</span><span class="w"> </span><span class="s2">"HTTPRoute"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"v1"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"namespace"</span><span class="p">:</span><span class="w"> </span><span class="s2">"default"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"route-b"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"fc82aa3d-512c-42f2-b7c3-e6f0069fcc94"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"causingObjects"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"configuration.konghq.com/KongPlugin:default/rate-limit-consumer"</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h4 id="verifying-the-working-route-is-still-operational-and-can-be-updated">Verifying the working route is still operational and can be updated</h4>

<p>We can also ensure the other <code class="language-plaintext highlighter-rouge">HTTPRoute</code> is still working:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-i</span> <span class="nv">$PROXY_IP</span>/route-a
</code></pre></div></div>

<p>The results should look like this:</p>
<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>HTTP/1.1 200 OK
Content-Type: text/plain; charset=utf-8
Content-Length: 137
Connection: keep-alive
X-Kong-Upstream-Latency: 1
X-Kong-Proxy-Latency: 1
Via: kong/3.6.0
X-Kong-Request-Id: 5bf50016730eae43c359c17b41dc8614

Welcome, you are connected to node orbstack.
Running on Pod echo-74c66b778-szf8f.
In namespace default.
With IP address 192.168.194.13.
</code></pre></div></div>

<p>Whatâ€™s more, weâ€™re still able to update the correct <code class="language-plaintext highlighter-rouge">HTTPRoute</code> without any issues. Letâ€™s modify <code class="language-plaintext highlighter-rouge">route-a</code>â€™s path:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kubectl patch httproute route-a <span class="nt">--type</span> merge <span class="nt">-p</span> <span class="s1">'{"spec":{"rules":[{"matches":[{"path":{"type":"PathPrefix","value":"/route-a-modified"}}],"backendRefs":[{"name":"echo","port":1027}]}]}}'</span>
</code></pre></div></div>

<p>The results should look like this:</p>
<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>httproute.gateway.networking.k8s.io/route-a patched
</code></pre></div></div>

<p>Letâ€™s verify the updated <code class="language-plaintext highlighter-rouge">HTTPRoute</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-i</span> <span class="nv">$PROXY_IP</span>/route-a-modified
</code></pre></div></div>

<p>The results should look like this:</p>
<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>HTTP/1.1 200 OK
Content-Type: text/plain; charset=utf-8
Content-Length: 137
Connection: keep-alive
X-Kong-Upstream-Latency: 1
X-Kong-Proxy-Latency: 0
Via: kong/3.6.0
X-Kong-Request-Id: f26ce453eeeda50e3d53a26f44f0f21f

Welcome, you are connected to node orbstack.
Running on Pod echo-74c66b778-szf8f.
In namespace default.
With IP address 192.168.194.13.
</code></pre></div></div>

<p>The Fallback Configuration mechanism has successfully isolated the broken <code class="language-plaintext highlighter-rouge">HTTPRoute</code> and allowed the correct one to be
updated.</p>

<h3 id="backfilling-broken-objects">Backfilling broken objects</h3>

<p>Another mode of operation that the Fallback Configuration feature supports is backfilling broken objects with their last
valid version. To demonstrate this, weâ€™ll use the same setup as in the default mode, but this time weâ€™ll set the
<code class="language-plaintext highlighter-rouge">CONTROLLER_USE_LAST_VALID_CONFIG_FOR_FALLBACK</code> environment variable to <code class="language-plaintext highlighter-rouge">true</code>.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>helm upgrade <span class="nt">--install</span> kong kong/ingress <span class="nt">-n</span> kong <span class="se">\</span>
<span class="nt">--set</span> controller.ingressController.env.feature_gates<span class="o">=</span><span class="nv">FallbackConfiguration</span><span class="o">=</span><span class="nb">true</span> <span class="se">\</span>
<span class="nt">--set</span> controller.ingressController.env.use_last_valid_config_for_fallback<span class="o">=</span><span class="nb">true</span> <span class="se">\</span>
<span class="nt">--set</span> controller.ingressController.env.dump_config<span class="o">=</span><span class="nb">true</span>
</code></pre></div></div>

<h4 id="attaching-the-plugin-back">Attaching the plugin back</h4>

<p>As this mode of operation leverages the last valid Kubernetes objectsâ€™ cache state, we need to make sure that
we begin with a clean slate, allowing Kong Ingress Controller to store it.</p>

<blockquote class="note">
  <p><strong>Note:</strong> Kong Ingress Controller stores the last valid Kubernetes objectsâ€™ cache state in memory. It is not persisted
across restarts. That means that if youâ€™ve got broken objects in the configuration that were backfilled using the
last valid version, after a restart the last valid version will be lost, effectively excluding these objects from the
configuration.</p>
</blockquote>

<p>Letâ€™s remove one <code class="language-plaintext highlighter-rouge">KongPlugin</code> so we get an entirely valid configuration:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kubectl annotate kongconsumer bob konghq.com/plugins<span class="o">=</span>rate-limit-consumer
</code></pre></div></div>

<p>The results should look like this:</p>
<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kongconsumer.configuration.konghq.com/bob annotated
</code></pre></div></div>

<h4 id="verifying-both-routes-are-operational-again">Verifying both routes are operational again</h4>

<p>Now, letâ€™s verify that both <code class="language-plaintext highlighter-rouge">HTTPRoute</code>s are operational back again.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-i</span> <span class="nv">$PROXY_IP</span>/route-a-modified
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-i</span> <span class="nv">$PROXY_IP</span>/route-b
</code></pre></div></div>

<p>The results should look like this:</p>
<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>HTTP/1.1 200 OK
Content-Type: text/plain; charset=utf-8
Content-Length: 137
Connection: keep-alive
X-Kong-Upstream-Latency: 2
X-Kong-Proxy-Latency: 0
Via: kong/3.6.0
X-Kong-Request-Id: 0d91bf2d355ede4d2b01c3306886c043

Welcome, you are connected to node orbstack.
Running on Pod echo-74c66b778-szf8f.
In namespace default.
With IP address 192.168.194.13.
</code></pre></div></div>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>HTTP/1.1 401 Unauthorized
Content-Type: application/json; charset=utf-8
Connection: keep-alive
WWW-Authenticate: Key realm="kong"
Content-Length: 96
X-Kong-Response-Latency: 0
Server: kong/3.6.0
X-Kong-Request-Id: 0bc94b381edeb52f5a41e23a260afe40

{
  "message":"No API key found in request",
  "request_id":"0bc94b381edeb52f5a41e23a260afe40"
}
</code></pre></div></div>

<h4 id="breaking-the-route-again">Breaking the route again</h4>

<p>As weâ€™ve verified that both <code class="language-plaintext highlighter-rouge">HTTPRoute</code>s are operational, letâ€™s break <code class="language-plaintext highlighter-rouge">route-b</code> again by removing the <code class="language-plaintext highlighter-rouge">rate-limit-consumer</code>
<code class="language-plaintext highlighter-rouge">KongPlugin</code> from the <code class="language-plaintext highlighter-rouge">KongConsumer</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kubectl annotate kongconsumer bob konghq.com/plugins-
</code></pre></div></div>

<p>The results should look like this:</p>
<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kongconsumer.configuration.konghq.com/bob annotated
</code></pre></div></div>

<h4 id="verifying-the-broken-route-was-backfilled">Verifying the broken route was backfilled</h4>

<p>Backfilling the broken <code class="language-plaintext highlighter-rouge">HTTPRoute</code> with its last valid version should have restored the route to its last valid working
state. That means we should be able to access <code class="language-plaintext highlighter-rouge">route-b</code> as before the breaking change:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-i</span> <span class="nv">$PROXY_IP</span>/route-b
</code></pre></div></div>

<p>The results should look like this:</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>HTTP/1.1 401 Unauthorized
Date: Mon, 10 Jun 2024 14:00:38 GMT
Content-Type: application/json; charset=utf-8
Connection: keep-alive
WWW-Authenticate: Key realm="kong"
Content-Length: 96
X-Kong-Response-Latency: 5
Server: kong/3.6.0
X-Kong-Request-Id: 4604f84de6ed0b1a9357e935da5cea2c

{
  "message":"No API key found in request",
  "request_id":"4604f84de6ed0b1a9357e935da5cea2c"
}
</code></pre></div></div>

<h4 id="inspecting-diagnostic-endpoints-1">Inspecting diagnostic endpoints</h4>

<p>Using diagnostic endpoints, we can now inspect the objects that were excluded and backfilled in the configuration:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kubectl port-forward <span class="nt">-n</span> kong deploy/kong-controller 10256 &amp;
curl localhost:10256/debug/config/fallback | jq
</code></pre></div></div>

<p>The results should look like this:</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"triggered"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"brokenObjects"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"group"</span><span class="p">:</span><span class="w"> </span><span class="s2">"configuration.konghq.com"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"kind"</span><span class="p">:</span><span class="w"> </span><span class="s2">"KongPlugin"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"namespace"</span><span class="p">:</span><span class="w"> </span><span class="s2">"default"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"rate-limit-consumer"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"7167315d-58f5-4aea-8aa5-a9d989f33a49"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"excludedObjects"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"group"</span><span class="p">:</span><span class="w"> </span><span class="s2">"configuration.konghq.com"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"kind"</span><span class="p">:</span><span class="w"> </span><span class="s2">"KongPlugin"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"v1"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"namespace"</span><span class="p">:</span><span class="w"> </span><span class="s2">"default"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"rate-limit-consumer"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"7167315d-58f5-4aea-8aa5-a9d989f33a49"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"causingObjects"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"configuration.konghq.com/KongPlugin:default/rate-limit-consumer"</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"group"</span><span class="p">:</span><span class="w"> </span><span class="s2">"gateway.networking.k8s.io"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"kind"</span><span class="p">:</span><span class="w"> </span><span class="s2">"HTTPRoute"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"v1"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"namespace"</span><span class="p">:</span><span class="w"> </span><span class="s2">"default"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"route-b"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"fc82aa3d-512c-42f2-b7c3-e6f0069fcc94"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"causingObjects"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"configuration.konghq.com/KongPlugin:default/rate-limit-consumer"</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"backfilledObjects"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"group"</span><span class="p">:</span><span class="w"> </span><span class="s2">"configuration.konghq.com"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"kind"</span><span class="p">:</span><span class="w"> </span><span class="s2">"KongPlugin"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"v1"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"namespace"</span><span class="p">:</span><span class="w"> </span><span class="s2">"default"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"rate-limit-consumer"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"7167315d-58f5-4aea-8aa5-a9d989f33a49"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"causingObjects"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"configuration.konghq.com/KongPlugin:default/rate-limit-consumer"</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"group"</span><span class="p">:</span><span class="w"> </span><span class="s2">"configuration.konghq.com"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"kind"</span><span class="p">:</span><span class="w"> </span><span class="s2">"KongConsumer"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"v1"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"namespace"</span><span class="p">:</span><span class="w"> </span><span class="s2">"default"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"bob"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"deecb7c5-a3f6-4b88-a875-0e1715baa7c3"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"causingObjects"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"configuration.konghq.com/KongPlugin:default/rate-limit-consumer"</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"group"</span><span class="p">:</span><span class="w"> </span><span class="s2">"gateway.networking.k8s.io"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"kind"</span><span class="p">:</span><span class="w"> </span><span class="s2">"HTTPRoute"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"v1"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"namespace"</span><span class="p">:</span><span class="w"> </span><span class="s2">"default"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"route-b"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"fc82aa3d-512c-42f2-b7c3-e6f0069fcc94"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"causingObjects"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"configuration.konghq.com/KongPlugin:default/rate-limit-consumer"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"gateway.networking.k8s.io/HTTPRoute:default/route-b"</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>As <code class="language-plaintext highlighter-rouge">rate-limit-consumer</code> and <code class="language-plaintext highlighter-rouge">route-b</code> were reported back as broken by the Kong Gateway, they were excluded from
the configuration. However, the Fallback Configuration mechanism backfilled them with their last valid version, restoring
the route to its working state. You may notice that also the <code class="language-plaintext highlighter-rouge">KongConsumer</code> was backfilled -
this is because the <code class="language-plaintext highlighter-rouge">KongConsumer</code> was depending on the <code class="language-plaintext highlighter-rouge">rate-limit-consumer</code> plugin in the last valid state.</p>

<blockquote class="note">
  <p><strong>Note:</strong> The Fallback Configuration mechanism will attempt to backfill all the broken objects along with their direct
and indirect dependants. The dependencies are resolved based on the last valid Kubernetes objectsâ€™ cache state.</p>
</blockquote>

<h4 id="modifying-the-affected-objects">Modifying the affected objects</h4>

<p>As weâ€™re now relying on the last valid version of the broken objects and their dependants, we wonâ€™t be able to effectively
modify them until we fix the problems. Letâ€™s try and add another key for the <code class="language-plaintext highlighter-rouge">bob</code> <code class="language-plaintext highlighter-rouge">KongConsumer</code>:</p>

<p>Create a new <code class="language-plaintext highlighter-rouge">Secret</code> with a new key:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s1">'apiVersion: v1
kind: Secret
metadata:
  name: bob-key-auth-new
  labels:
    konghq.com/credential: key-auth
stringData:
  key: bob-new-password'</span> | kubectl apply <span class="nt">-f</span> -
</code></pre></div></div>

<p>The results should look like this:</p>
<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>secret/bob-key-auth-new created
</code></pre></div></div>

<p>Associate the new <code class="language-plaintext highlighter-rouge">Secret</code> with the <code class="language-plaintext highlighter-rouge">KongConsumer</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kubectl patch kongconsumer bob <span class="nt">--type</span> merge <span class="nt">-p</span> <span class="s1">'{"credentials":["bob-key-auth", "bob-key-auth-new"]}'</span>
</code></pre></div></div>

<p>The results should look like this:</p>
<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kongconsumer.configuration.konghq.com/bob patched
</code></pre></div></div>

<p>The change wonâ€™t be effective as the <code class="language-plaintext highlighter-rouge">HTTPRoute</code> and <code class="language-plaintext highlighter-rouge">KongPlugin</code> are still broken. We can verify this by trying to access the
<code class="language-plaintext highlighter-rouge">route-b</code> with the new key:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-i</span> <span class="nv">$PROXY_IP</span>/route-b <span class="nt">-H</span> apikey:bob-new-password
</code></pre></div></div>

<p>The results should look like this:</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>HTTP/1.1 401 Unauthorized
Content-Type: application/json; charset=utf-8
Connection: keep-alive
Content-Length: 81
X-Kong-Response-Latency: 2
Server: kong/3.6.0
X-Kong-Request-Id: 4c706c7e4e06140e56453b22e169df0a

{
  "message":"Unauthorized",
  "request_id":"4c706c7e4e06140e56453b22e169df0a"
}
</code></pre></div></div>

<h4 id="modifying-the-working-route">Modifying the working route</h4>

<p>On the other hand, we can still modify the working <code class="language-plaintext highlighter-rouge">HTTPRoute</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kubectl patch httproute route-a <span class="nt">--type</span> merge <span class="nt">-p</span> <span class="s1">'{"spec":{"rules":[{"matches":[{"path":{"type":"PathPrefix","value":"/route-a-modified-again"}}],"backendRefs":[{"name":"echo","port":1027}]}]}}'</span>
</code></pre></div></div>

<p>The results should look like this:</p>
<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>httproute.gateway.networking.k8s.io/route-a patched
</code></pre></div></div>

<p>Letâ€™s verify the updated <code class="language-plaintext highlighter-rouge">HTTPRoute</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-i</span> <span class="nv">$PROXY_IP</span>/route-a-modified-again
</code></pre></div></div>

<p>The results should look like this:</p>
<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>HTTP/1.1 200 OK
Content-Type: text/plain; charset=utf-8
Content-Length: 136
Connection: keep-alive
X-Kong-Upstream-Latency: 2
X-Kong-Proxy-Latency: 0
Via: kong/3.6.0
X-Kong-Request-Id: 4369f15cf27cf16f5a2c82061b8d3950

Welcome, you are connected to node orbstack.
Running on Pod echo-bf9d56995-r8c86.
In namespace default.
With IP address 192.168.194.8.
</code></pre></div></div>

<h4 id="fixing-the-broken-route">Fixing the broken route</h4>

<p>To fix the broken <code class="language-plaintext highlighter-rouge">HTTPRoute</code>, we need to associate the <code class="language-plaintext highlighter-rouge">rate-limit-consumer</code> <code class="language-plaintext highlighter-rouge">KongPlugin</code> back with the <code class="language-plaintext highlighter-rouge">KongConsumer</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kubectl annotate kongconsumer bob konghq.com/plugins<span class="o">=</span>rate-limit-consumer
</code></pre></div></div>

<p>This should unblock the changes weâ€™ve made to the <code class="language-plaintext highlighter-rouge">bob-key-auth</code> <code class="language-plaintext highlighter-rouge">Secret</code>. Letâ€™s verify this by accessing the <code class="language-plaintext highlighter-rouge">route-b</code>
with the new key:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-i</span> <span class="nv">$PROXY_IP</span>/route-b <span class="nt">-H</span> apikey:bob-new-password
</code></pre></div></div>

<p>The results should look like this now:</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>HTTP/1.1 200 OK
Content-Type: text/plain; charset=utf-8
Content-Length: 136
Connection: keep-alive
X-RateLimit-Limit-Second: 5
RateLimit-Limit: 5
RateLimit-Remaining: 4
RateLimit-Reset: 1
X-RateLimit-Remaining-Second: 4
X-Kong-Upstream-Latency: 2
X-Kong-Proxy-Latency: 2
Via: kong/3.6.0
X-Kong-Request-Id: 183ecc2973f16529a314ca5bf205eb73

Welcome, you are connected to node orbstack.
Running on Pod echo-bf9d56995-r8c86.
In namespace default.
With IP address 192.168.194.8.
</code></pre></div></div>

<h3 id="inspecting-the-fallback-configuration-process">Inspecting the Fallback Configuration process</h3>

<p>Each time Kong Ingress Controller successfully applies a fallback configuration, it emits a Kubernetes Event
with the <code class="language-plaintext highlighter-rouge">FallbackKongConfigurationSucceeded</code> reason. It will also emit an Event with <code class="language-plaintext highlighter-rouge">FallbackKongConfigurationApplyFailed</code>
reason in case the fallback configuration gets rejected by Kong Gateway. You can monitor these events to track the
fallback configuration process.</p>

<p>You can check the Event gets emitted by running:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kubectl get events <span class="nt">-A</span> <span class="nt">--field-selector</span><span class="o">=</span><span class="s1">'reason=FallbackKongConfigurationSucceeded'</span>
</code></pre></div></div>

<p>The results should look like this:</p>
<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>NAMESPACE   LAST SEEN   TYPE     REASON                               OBJECT                                 MESSAGE
kong        4m26s       Normal   FallbackKongConfigurationSucceeded   pod/kong-controller-7f4fd47bb7-zdktb   successfully applied fallback Kong configuration to https://192.168.194.11:8444
</code></pre></div></div>

<blockquote class="note">
  <p>Another way to monitor the Fallback Configuration mechanism is by Prometheus metrics. Please refer to the
<a href="/kubernetes-ingress-controller/3.3.x/production/observability/prometheus">Prometheus Metrics</a> for more information.</p>
</blockquote>


          

        </div>
      </div>
    </div>
    
      <div id="scroll-to-top-button">
        <i class="fas fa-chevron-up"></i>
      </div>
      
        <div class="feedback-widget-container">
  <input id="feedback-widget-checkbox" type="checkbox">
  <label for="feedback-widget-checkbox">
    <img src="/assets/images/icons/feedback-widget.svg" alt="Feedback widget">
  </label>
  <div class="feedback-container">
    <div class="feedback-thankyou">
      Thank you for your feedback.
    </div>
    <div class="feedback-comment">
      <textarea id="feedback-comment-text" rows="3" placeholder="Please let us know what we can improve on this page..."></textarea>
      <div class="feedback-comment-buttons">
        <button id="feedback-comment-button-back">Back</button>
        <button id="feedback-comment-button-submit" class="button-primary">Submit</button>
      </div>
    </div>
    <div class="feedback-options">
      <div class="feedback-options-title">Was this page useful?</div>
      <div class="feedback-options-buttons">
        <i data-feedback-result="yes" class="feedback-options-button far fa-thumbs-up"></i>
        <i data-feedback-result="no" class="feedback-options-button far fa-thumbs-down"></i>
      </div>
    </div>
  </div>
</div>

      
    
  </div>

  <div id="image-modal" data-image-expand-disabled="">
  <div class="image-modal-backdrop"></div>
  <div class="image-container">
    <img src="" alt="">
    <i class="fa fa-times"></i>
  </div>
</div>




  <div class="modal closed" id="modal" role="dialog" aria-hidden="true" aria-labelledby="title" aria-describedby="description">
    <div class="konnect-cta-card">
      <div class="title">
      Too much on your plate?
      <a href="#" class="cta-card-close modal-close" id="modal-close">
          <img src="/assets/images/icons/documentation/close.svg" alt="close cta icon">
        </a>
      </div>
      <div class="description">More features, less infrastructure with Kong Konnect. 1M requests per month for free.</div>
      <a href="https://konghq.com/products/kong-konnect/register?utm_medium=referral&amp;utm_source=docs&amp;utm_campaign=gateway-konnect&amp;utm_campaign=right-nav-card&amp;utm_content=kubernetes-ingress-controller" class="button" target="_blank" rel="noopener nofollow noreferrer ">
      Try it for Free
    </a>
    </div>
  </div>
  <div id="modal-open" class="modal-open"></div>
  <div class="modal-overlay closed" id="modal-overlay"></div>


    <footer class="marketing-footer--light-gray">
  <section>
    <ul class="newsletter">
      <li class="logo-wrapper">
        <div class="logo">
          <img src="/assets/images/logos/konglogo-light-theme-primary.svg" alt="Kong">
        </div>
        <div class="footer-title">Powering the API world</div>
        <p>
          Increase developer productivity, security, and performance at scale with the unified platform for API management, service mesh, and ingress controller.
        </p>
        <div class="footer-form-container">
          <form id="subscribe-form" method="POST" action="/assets/javascripts/subscribe.js">
            <input required id="subscribe-input" type="email" name="email" placeholder="Email" aria-required="true" aria-invalid="false">
            <input id="footer-form-button" type="submit" form="subscribe-form" value="Subscribe">
          </form>

          <div id="form-response"></div>
        </div>
      </li>

      <li class="footer-columns">
        <ul class="footer-columns-product-list">
          <li>
            <nav>
              <div class="footer-category">Products</div>
              <ul>
                <li>
                  <a href="https://konghq.com/products/kong-konnect" target="_blank" rel="noopener nofollow noreferrer ">Kong Konnect</a>
                </li>
                <li>
                  <a href="https://konghq.com/products/kong-enterprise" target="_blank" rel="noopener nofollow noreferrer ">Kong Gateway Enterprise</a>
                </li>
                <li>
                  <a href="https://konghq.com/products/kong-gateway" target="_blank" rel="noopener nofollow noreferrer ">Kong Gateway</a>
                </li>
                <li>
                  <a href="https://konghq.com/products/kong-mesh" target="_blank" rel="noopener nofollow noreferrer ">Kong Mesh</a>
                </li>
                <li>
                  <a href="https://konghq.com/products/kong-ingress-controller" target="_blank" rel="noopener nofollow noreferrer ">Kong Ingress Controller</a>
                </li>
                <li>
                  <a href="https://insomnia.rest/" target="_blank" rel="noopener nofollow noreferrer noopener nofollow noreferrer">Kong Insomnia</a>
                </li>
                <li>
                  <a href="https://konghq.com/product-updates" target="_blank" rel="noopener nofollow noreferrer ">Product Updates</a>
                </li>
                <li>
                  <a href="https://konghq.com/contact-sales" target="_blank" rel="noopener nofollow noreferrer ">Get Started</a>
                </li>
              </ul>
            </nav>
          </li>
          <li>
            <nav>
              <div class="footer-category">Documentation</div>
              <ul>
                <li>
                  <a href="/konnect/">Kong Konnect Docs</a>
                </li>
                <li>
                  <a href="/gateway/latest/">Kong Gateway Docs</a>
                </li>
                <li>
                  <a href="/gateway/latest/kong-enterprise/">Kong Gateway Enterprise Docs</a>
                </li>
                <li>
                  <a href="/mesh/latest/">Kong Mesh Docs</a>
                </li>
                <li>
                  <a href="https://docs.insomnia.rest/" target="_blank" rel="noopener nofollow noreferrer noopener nofollow noreferrer">Kong Insomnia Docs</a>
                </li>
                <li>
                  <a href="/hub/">Kong Konnect Plugin Hub</a>
                </li>
              </ul>
            </nav>
          </li>
          <li>
            <nav>
              <div class="footer-category">Open Source</div>
              <ul>
                <li>
                  <a href="https://konghq.com/install/#kong-community" target="_blank" rel="noopener nofollow noreferrer ">Kong Gateway</a>
                </li>
                <li>
                  <a href="https://kuma.io/" target="_blank" rel="noopener nofollow noreferrer noopener nofollow noreferrer">Kuma</a>
                </li>
                <li>
                  <a href="https://insomnia.rest/" target="_blank" rel="noopener nofollow noreferrer noopener nofollow noreferrer">Insomnia</a>
                </li>
                <li>
                  <a href="https://konghq.com/community" target="_blank" rel="noopener nofollow noreferrer ">Kong Community</a>
                </li>
              </ul>
            </nav>
          </li>
          <li>
            <nav>
              <div class="footer-category">Company</div>
              <ul>
                <li>
                  <a href="https://konghq.com/company/about-us" target="_blank" rel="noopener nofollow noreferrer ">About Kong</a>
                </li>
                <li>
                  <a href="https://konghq.com/customers" target="_blank" rel="noopener nofollow noreferrer ">Customers</a>
                </li>
                <li>
                  <a href="https://konghq.com/company/careers" target="_blank" rel="noopener nofollow noreferrer ">Careers</a>
                </li>
                <li>
                  <a href="https://konghq.com/press-room" target="_blank" rel="noopener nofollow noreferrer ">Press</a>
                </li>
                <li>
                  <a href="https://konghq.com/events" target="_blank" rel="noopener nofollow noreferrer ">Events</a>
                </li>
                <li>
                  <a href="https://konghq.com/company/contact-us" target="_blank" rel="noopener nofollow noreferrer ">Contact</a>
                </li>
              </ul>
            </nav>
          </li>
        </ul>
      </li>

    </ul>
  </section>

  <section class="legal">
    <div class="container d-flex">
      <div class="social">
        <div class="social-link">
          <a href="https://www.facebook.com/konghq/" title="Facebook" target="_blank" rel="noopener nofollow noreferrer "><i aria-label="Facebook" class="fa fa-facebook-official" aria-hidden="true"></i></a>
        </div>
        <div class="social-link">
          <a href="https://twitter.com/thekonginc" title="Twitter" target="_blank" rel="noopener nofollow noreferrer "><i aria-label="Twitter" class="fa fa-twitter" aria-hidden="true"></i></a>
        </div>
        <div class="social-link">
          <a href="https://www.meetup.com/topics/kong/all/" title="Meetup" target="_blank" rel="noopener nofollow noreferrer "><i aria-label="Meetup" class="fa fa-meetup" aria-hidden="true"></i></a>
        </div>
        <div class="social-link">
          <a href="https://linkedin.com/company/278819" title="LinkedIn" target="_blank" rel="noopener nofollow noreferrer "><i aria-label="GitHub" class="fa fa-linkedin" aria-hidden="true"></i></a>
        </div>
        <div class="social-link">
          <a href="https://github.com/kong/kong" target="_blank" class="btn-gh" title="GitHub" rel="noopener nofollow noreferrer ">
            <i class="fa fa-github" aria-hidden="true" aria-label="GitHub"></i>
          </a>
        </div>
      </div>
      <ul>
        <li>
          <span class="mashape-footer-content">
            <a href="https://konghq.com/legal/terms-of-use" target="_blank" rel="noopener nofollow noreferrer ">Terms</a><b>â€¢</b>
            <a href="https://konghq.com/legal/privacy-policy" target="_blank" rel="noopener nofollow noreferrer ">Privacy</a><b>â€¢</b>
            <a href="https://konghq.com/compliance" target="_blank" rel="noopener nofollow noreferrer ">Trust and Compliance</a>
          </span>
        </li>
      </ul>
      <div>
        <span>Â© Kong Inc. 2024 Â </span>
      </div>
    </div>
  </section>
</footer>
 <script>
  var anchorForId = function (id) {
    var anchor = document.createElement("a");
    anchor.className = "header-link";
    anchor.href      = "#" + id;
    anchor.innerHTML = "<i class=\"fa fa-link\"></i>";
    anchor.title = `${id} Permalink`;
    return anchor;
  };

  document.onreadystatechange = function () {
    if (this.readyState === "complete") {
      var className =
        ".show-anchor-links h1, .show-anchor-links h2, .show-anchor-links h3, " +
        ".show-anchor-links h4, .show-anchor-links h5, .show-anchor-links h6";
      var headers = document.querySelectorAll(className);

      for (var i = 0; i < headers.length; i++) {
        var header = headers[i];
        if (typeof header.id !== "undefined" && header.id !== "") {
          header.prepend(anchorForId(header.id));
        }
      }
    }
  };
</script>


    
      <script>
        (function stp(){
          if (typeof analytics == "undefined"){
            return setTimeout(stp, 30);
          }
          analytics.page();
        })();
      </script>
    

    <div id="fb-root"></div>
    <script id="github-bjs" src="https://buttons.github.io/buttons.js" async defer></script>

    <script type="text/javascript">
      var _vwo_code = (function() {
        var account_id = 125292,
          settings_tolerance = 2000,
          library_tolerance = 2500,
          use_existing_jquery = true,
          // DO NOT EDIT BELOW THIS LINE
          f = false,
          d = document;
        return {
          use_existing_jquery: function() {
            return use_existing_jquery;
          },
          library_tolerance: function() {
            return library_tolerance;
          },
          finish: function() {
            if (!f) {
              f = true;
              var a = d.getElementById('_vis_opt_path_hides');
              if (a) a.parentNode.removeChild(a);
            }
          },
          finished: function() {
            return f;
          },
          load: function(a) {
            var b = d.createElement('script');
            b.src = a;
            b.type = 'text/javascript';
            b.innerText;
            b.onerror = function() {
              _vwo_code.finish();
            };
            d.getElementsByTagName('head')[0].appendChild(b);
          },
          init: function() {
            settings_timer = setTimeout(
              '_vwo_code.finish()',
              settings_tolerance
            );
            this.load(
              '//dev.visualwebsiteoptimizer.com/j.php?a=' +
                account_id +
                '&u=' +
                encodeURIComponent(d.URL) +
                '&r=' +
                Math.random()
            );
            var a = d.createElement('style'),
              b = '',
              h = d.getElementsByTagName('head')[0];
            a.setAttribute('id', '_vis_opt_path_hides');
            a.setAttribute('type', 'text/css');
            if (a.styleSheet) a.styleSheet.cssText = b;
            else a.appendChild(d.createTextNode(b));
            h.appendChild(a);
            return settings_timer;
          }
        };
      })();
      _vwo_settings_timer = _vwo_code.init();
    </script>

    <script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script>

    
      <script type="text/javascript">
        docsearch({
          appId: '05Y6TLHNFZ',
          apiKey: '80483bfe28d9fd036a11a6f6a06454f8',
          indexName: 'konghq',
          container: '#getkong-algolia-search-input',
          disableUserPersonalization: true,
          placeholder: 'Search the docs...',
          // Override selected event to allow for local environment navigation
          transformItems(items) {
            return items.map((item) => {
              var modifiedUrl = window.location.protocol + '//' + window.location.host + item.url.split('docs.konghq.com')[1];
              return { ...item, url: modifiedUrl };
            });
          },
          translations: {
            button: {
              buttonText: 'Search the docs..',
              buttonAriaLabel: 'Search the docs...'
            }
          },
          resultsFooterComponent({ state }) {
            var facetParameters = {};
            
              facetParameters = {"version[0]":"3.3.x","product[0]":"Kong Ingress Controller"};
            

            var queryParams = new URLSearchParams(facetParameters);
            queryParams.set('query', state.query);

            return {
              // The HTML `tag`
              type: 'a',
              ref: undefined,
              constructor: undefined,
              key: state.query,
              // Its props
              props: {
                href: `/search/?${queryParams.toString()}`,
                target: '_blank',
                // Raw text rendered in the HTML element
                children: 'See more >'
              },
              __v: null,
            };
          },
          
           searchParameters: {
              optionalFilters: ['product:Kong Gateway Operator<score=1>', 'product:Kong Ingress Controller<score=2>'],
              facetFilters: [ 'version:3.3.x']
            }
            
          });
      </script>
    
  </div>
</body>

  

</html>

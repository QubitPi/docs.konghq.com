<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/Article">

  

<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
    <!-- OneTrust Cookies Consent Notice start for konghq.com -->
    <script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" type="text/javascript" charset="UTF-8" data-domain-script="2c4de954-6bec-4e93-8086-64cb113f151a">
    </script>
    <script type="text/javascript">
    function OptanonWrapper() { }
    </script>
    <!-- OneTrust Cookies Consent Notice end for konghq.com -->

    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-NL48VKT');</script>
    <!-- End Google Tag Manager -->
  

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Vault Policy - Kong Mesh - v1.9.x | Kong Docs</title>
  <meta name="description" content="Documentation for Kong, the Cloud Connectivity Company for APIs and Microservices.">
  <meta name="author" content="KongHQ">
  <meta property="og:title" content="Vault Policy - Kong Mesh - v1.9.x | Kong Docs">
  <meta property="og:site_name" content="Kong Docs">
  <!-- use share link for facebook -->
  <meta property="og:url" content="https://docs.konghq.com">
  <meta property="og:description" content="Documentation for Kong, the Cloud Connectivity Company for APIs and Microservices.">
  <meta property="og:type" content="website">
  <meta property="og:locale" content="en_US">
  <meta property="og:image" content="https://docs.konghq.com/assets/images/share.png">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@thekonginc">
  <meta name="twitter:creator" content="@thekonginc">
  <meta name="twitter:url" content="https://docs.konghq.com">
  <meta name="twitter:description" content="Documentation for Kong, the Cloud Connectivity Company for APIs and Microservices.">
  <meta name="twitter:image" content="https://docs.konghq.com/assets/images/share.png">
  <meta property="fb:admins" content="227304446">
  <meta property="fb:admins" content="576641408">
  <meta name="google-site-verification" content="CrU3zp02dNKTe8NSAipL4NCPkrIjDXG8fViTZ-MIzP4">

  

  <script type="application/ld+json">
    {
      "@context": "http://schema.org",
      "@type": "Organization",
      "name": "KongHQ",
      "url": "https://docs.konghq.com",
      "logo": "https://docs.konghq.com/assets/images/logo.png",
      "sameAs": [
        "https://www.facebook.com/konginc",
        "https://twitter.com/thekonginc",
        "https://plus.google.com/+mashape"
      ]
    }
  </script>

  <!-- Preload assets -->
  <link rel="dns-prefetch" href="https://cloud.typography.com">
  <link rel="dns-prefetch" href="https://dev.visualwebsiteoptimizer.com">
  <link rel="dns-prefetch" href="https://cdn.segment.com">

  <link rel="icon" type="image/x-icon" href="/assets/images/favicon.ico">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3">

  
    <link rel="canonical" href="https://docs.konghq.com/mesh/latest/features/vault/">
  

  
    <meta name="robots" content="follow,noindex">
  

  <!-- FontAwesome icon font -->
  <script src="https://kit.fontawesome.com/1332a92967.js" crossorigin="anonymous">
  </script>

  
  <script src="/vite/assets/application-DqmI9sc2.js" crossorigin="anonymous" type="module"></script>
<link href="/vite/assets/_commonjsHelpers-Cpj98o6Y.js" rel="modulepreload" as="script" crossorigin="anonymous">


  

  

  <link rel="stylesheet" href="/vite/assets/application-CrIf7Il_.css" media="screen">

  
</head>


  <body id="" data-spy="scroll" data-target="#scroll-sidebar" data-offset="350">

    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NL48VKT" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->

    <header class="navbar-v2 closed">
  <a class="skip-main" href="#main">Skip to content</a>
  <!-- uncomment the promo-banner div when adding a new promo banner-->
  <!--also uncomment the promo banner sections in app/assets/stylesheets/header.less and application.js-->
  <!-- <div id="promo-banner">
    <div class="container">
      <div class="closebanner"></div> <strong>2024 API Summit Hackathon: Experiment with API Innovation & AI. Submit by Sept 11 &nbsp;&mdash;<a href="https://konghq.com/conferences/kong-summit/hackathon?utm_medium=website&utm_source=docs-konghq-com&utm_campaign=docs-banner">Enter Now &rarr;</a> </strong>
    </div>
  </div> -->
  <div class="navbar-content">
    <a href="https://konghq.com" class="navbar-brand col col-xl-auto" target="_blank" rel="noopener noreferrer">
      <img src="/assets/images/logos/konglogo-dark-theme.svg" alt="Kong Logo" id="kong-logo">
    </a>
    <span class="logo-divider">|</span>
    <a href="/" class="navbar-brand col col-xl-auto">
      <img src="/assets/images/logos/docslogo-dark-theme.svg" alt="Kong Docs Logo" id="kong-docs-logo">
    </a>

    <div class="separator mobile"></div>
      <div class="search-input-wrapper" id="getkong-algolia-search-input">
    </div>

    <div class="search-results-wrapper"></div>

    <div class="navbar-items" role="navigation" aria-label="Main menu">
      <ul class="navbar-items" role="menubar">
        <li id="top-module-list" aria-haspopup="true" role="menuitem" aria-expanded="false" class="navbar-item main-menu-item with-submenu  active">
          <span tabindex="0" id="docs-link" class="main-menu-item-title">Docs</span>
          <span class="caret"></span>
          <ul class="navbar-item-submenu" role="menu">
            <div class="submenu-section">
              <li role="menuitem" class="docs-dropdown-li">
                <a href="/api/" class="docs-dropdown-li__link" tabindex="-1">
                  <div class="docs-dropdown-li__card">
                    <span class="heading">Explore the API Specs</span>
                    <div class="docs-dropdown-li__card-link">
                      <img src="/assets/images/landing-page/view-all-api-specs.png" alt="View all API Specs">
                      <span class="docs-dropdown-li__card-image">
                        View all API Specs
                        <img src="/assets/images/landing-page/arrow-right.svg" alt="View all API Specs arrow image">
                      </span>
                    </div>
                  </div>
                </a>
              </li>

              <li role="menuitem" class="docs-dropdown-li" tabindex="-1">
                <div class="docs-dropdown-li__section">
                  <div class="docs-dropdown-li__section-title">
                    <span class="heading">Documentation</span>
                  </div>

                  <div class="docs-dropdown-li__section-items">
                    <a class="item item-all" href="/api/" tabindex="-1">
                      <div class="item__description">
                        <div class="item__description-title">API Specs</div>
                      </div>
                    </a>
                    
                      <a class="item" href="/gateway/latest/" tabindex="-1">
                        
                        <div class="item__description">
                          <div class="item__description-title">Kong Gateway</div>
                          <div class="item__description-desc">Lightweight, fast, and flexible cloud-native API gateway</div>
                        </div>
                      </a>
                    
                      <a class="item" href="/konnect/" tabindex="-1">
                        
                        <div class="item__description">
                          <div class="item__description-title">Kong Konnect</div>
                          <div class="item__description-desc">Single platform for SaaS end-to-end connectivity</div>
                        </div>
                      </a>
                    
                      <a class="item" href="/gateway/latest/ai-gateway/" tabindex="-1">
                        
                        <div class="item__description">
                          <div class="item__description-title">Kong AI Gateway</div>
                          <div class="item__description-desc">Multi-LLM AI Gateway for GenAI infrastructure</div>
                        </div>
                      </a>
                    
                      <a class="item" href="/mesh/latest/" tabindex="-1">
                        
                        <div class="item__description">
                          <div class="item__description-title">Kong Mesh</div>
                          <div class="item__description-desc">Enterprise service mesh based on Kuma and Envoy</div>
                        </div>
                      </a>
                    
                      <a class="item" href="/deck/latest/" tabindex="-1">
                        
                        <div class="item__description">
                          <div class="item__description-title">decK</div>
                          <div class="item__description-desc">Helps manage Kong’s configuration in a declarative fashion</div>
                        </div>
                      </a>
                    
                      <a class="item" href="/kubernetes-ingress-controller/latest/" tabindex="-1">
                        
                        <div class="item__description">
                          <div class="item__description-title">Kong Ingress Controller</div>
                          <div class="item__description-desc">Works inside a Kubernetes cluster and configures Kong to proxy traffic</div>
                        </div>
                      </a>
                    
                      <a class="item" href="/gateway-operator/latest/" tabindex="-1">
                        
                        <div class="item__description">
                          <div class="item__description-title">Kong Gateway Operator</div>
                          <div class="item__description-desc">Manage your Kong deployments on Kubernetes using YAML Manifests</div>
                        </div>
                      </a>
                    
                      <a class="item" href="https://docs.insomnia.rest/" tabindex="-1" target="_blank" rel="noopener nofollow noreferrer ">
                        
                        <div class="item__description">
                          <div class="item__description-title">Insomnia</div>
                          <div class="item__description-desc">Collaborative API development platform</div>
                        </div>
                      </a>
                    
                  </div>
                </div>
              </li>

            </div>
          </ul>
        </li>

        <li role="menuitem" aria-haspopup="true" aria-expanded="false" class="navbar-item main-menu-item with-submenu navbar-item-hub">
          <span id="plugin-link" class="main-menu-item-title" tabindex="0">Plugin Hub</span>
          <span class="caret"></span>
          <ul class="navbar-item-submenu" role="menu">
            <div class="submenu-section">
              <li role="menuitem" class="docs-dropdown-li">
                <a href="/hub/" class="docs-dropdown-li__link" tabindex="-1">
                  <div class="docs-dropdown-li__card">
                    <span class="heading">Explore the Plugin Hub</span>
                    <div class="docs-dropdown-li__card-link">
                      <img src="/assets/images/landing-page/view-all-plugins.svg" alt="View all plugins">
                      <span class="docs-dropdown-li__card-image">
                        View all plugins
                        <img src="/assets/images/landing-page/arrow-right.svg" alt="View all plugins arrow image">
                      </span>
                    </div>
                  </div>
                </a>
              </li>

              <li role="menuitem" class="docs-dropdown-li">
                <div class="docs-dropdown-li__section">
                  <div class="docs-dropdown-li__section-title">
                    <span class="heading">Functionality</span>
                    <a href="/hub/" class="view-all" tabindex="-1">
                      View all
                      <img src="/assets/images/landing-page/arrow-right.svg" alt="View all arrow image">
                    </a>
                  </div>

                  <div class="docs-dropdown-li__section-items">
                    <a class="item item-all" href="/hub/" tabindex="-1">
                      <div class="item__description">
                        <div class="item__description-title">View all plugins</div>
                      </div>
                    </a>

                    
                      <a class="item" href="/hub/?category=ai" tabindex="-1">
                        <div>
                          <img src="/assets/images/nav/hub/ai.svg" alt="AI's icon">
                        </div>
                        <div class="item__description">
                          <div class="item__description-title">AI</div>
                          <div class="item__description-desc">Govern, secure, and control AI traffic with multi-LLM AI Gateway plugins</div>
                        </div>
                      </a>
                    
                      <a class="item" href="/hub/?category=authentication" tabindex="-1">
                        <div>
                          <img src="/assets/images/nav/hub/lock_person.svg" alt="Authentication's icon">
                        </div>
                        <div class="item__description">
                          <div class="item__description-title">Authentication</div>
                          <div class="item__description-desc">Protect your services with an authentication layer</div>
                        </div>
                      </a>
                    
                      <a class="item" href="/hub/?category=security" tabindex="-1">
                        <div>
                          <img src="/assets/images/nav/hub/shield.svg" alt="Security's icon">
                        </div>
                        <div class="item__description">
                          <div class="item__description-title">Security</div>
                          <div class="item__description-desc">Protect your services with additional security layer</div>
                        </div>
                      </a>
                    
                      <a class="item" href="/hub/?category=traffic-control" tabindex="-1">
                        <div>
                          <img src="/assets/images/nav/hub/route.svg" alt="Traffic Control's icon">
                        </div>
                        <div class="item__description">
                          <div class="item__description-title">Traffic Control</div>
                          <div class="item__description-desc">Manage, throttle and restrict inbound and outbound API traffic</div>
                        </div>
                      </a>
                    
                      <a class="item" href="/hub/?category=serverless" tabindex="-1">
                        <div>
                          <img src="/assets/images/nav/hub/serverless.svg" alt="Serverless's icon">
                        </div>
                        <div class="item__description">
                          <div class="item__description-title">Serverless</div>
                          <div class="item__description-desc">Invoke serverless functions in combination with other plugins</div>
                        </div>
                      </a>
                    
                      <a class="item" href="/hub/?category=analytics-monitoring" tabindex="-1">
                        <div>
                          <img src="/assets/images/nav/hub/bar_chart.svg" alt="Analytics &amp; Monitoring's icon">
                        </div>
                        <div class="item__description">
                          <div class="item__description-title">Analytics &amp; Monitoring</div>
                          <div class="item__description-desc">Visualize, inspect and monitor APIs and microservices traffic</div>
                        </div>
                      </a>
                    
                      <a class="item" href="/hub/?category=transformations" tabindex="-1">
                        <div>
                          <img src="/assets/images/nav/hub/swap_horiz.svg" alt="Transformations's icon">
                        </div>
                        <div class="item__description">
                          <div class="item__description-title">Transformations</div>
                          <div class="item__description-desc">Transform request and responses on the fly on Kong</div>
                        </div>
                      </a>
                    
                      <a class="item" href="/hub/?category=logging" tabindex="-1">
                        <div>
                          <img src="/assets/images/nav/hub/list_alt.svg" alt="Logging's icon">
                        </div>
                        <div class="item__description">
                          <div class="item__description-title">Logging</div>
                          <div class="item__description-desc">Log request and response data using the best transport for your infrastructure</div>
                        </div>
                      </a>
                    

                  </div>
                </div>
              </li>
            </div>
          </ul>
        </li>
        <li role="menuitem" class="main-menu-item">
          <a href="https://support.konghq.com/" class="navbar-item" target="_blank" rel="noopener nofollow noreferrer ">Support</a>
        </li>
        <li role="menuitem" class="main-menu-item">
          <a href="https://konghq.com/community/" class="navbar-item" target="_blank" rel="noopener noreferrer">Community</a>
        </li>
        <li role="menuitem" class="main-menu-item">
          <a href="https://education.konghq.com" class="navbar-item" target="_blank" rel="noopener nofollow noreferrer ">Kong Academy</a>
        </li>
      </ul>
      <a id="top-cta" href="https://konghq.com/contact-sales?utm_source=docs.konghq.com" class="navbar-button" target="_blank" rel="noopener nofollow noreferrer ">
        Get a Demo
      </a>
      <a id="konnect-cta" href="https://konghq.com/products/kong-konnect/register?utm_medium=referral&amp;utm_source=docs&amp;utm_campaign=gateway-konnect&amp;utm_content=top-nav" class="navbar-button" target="_blank" rel="noopener nofollow noreferrer ">
        Start Free Trial
      </a>
    </div>
    <div id="navbar-menu-toggle-button" class="small-screen-button" aria-label="Toggle navigation">
      <div></div>
      <div></div>
      <div></div>
    </div>
  </div>
</header>


    

<div class="page v2 " data-url="/mesh/1.9.x/features/vault/">
  <div class="page--header-background page--header-background-doc"></div>
  <div class="container">

    <header class="page-header page-header-doc">
      <div class="page-header-product-version">
        <div class="edition">
          Kong Mesh
          
        </div>
        
        <div class="version">
          1.9.x
          
          
        </div>
        
      </div>
      <div class="page-header--nav">
        <i class="sidebar-toggle"></i>

        
          









  <ul class="breadcrumbs">
    <li class="breadcrumb-item">
      <a href="/">
        <img src="/assets/images/icons/hub-layout/icn-breadcrumbs.svg" alt="Home icon">
      </a>
    </li>
    <li class="breadcrumb-item">
      <a href="/mesh/1.9.x/">Kong Mesh</a>
    </li>

    
    
      

      

      
      

      
      

      
        <li class="breadcrumb-item">
          
          Features
          
        </li>
      
    
      

      

      
      

      
      

      
    

    
    
    <li class="breadcrumb-item">
      <a href="/mesh/1.9.x/features/vault/">Vault Policy</a>
    </li>
  </ul>

        

        

        <div class="github-links">
  <div class="github-links--edit">
    
      <a href="https://github.com/Kong/docs.konghq.com/edit/main/app/_src/mesh/features/vault.md" target="_blank" rel="noopener nofollow noreferrer ">
        <img src="/assets/images/icons/third-party/logo-github-white.svg" alt="github-edit-page">Edit this page
      </a>
    
  </div>
  <div class="github-links--issues">
    <a href="https://github.com/Kong/docs.konghq.com/issues" target="_blank" rel="noopener nofollow noreferrer ">
      <img src="/assets/images/icons/documentation/icn-monitoring-white.svg" alt="report-issue">Report an issue</a>
  </div>
</div>


      </div>
    </header>

    

<aside class="docs-sidebar">
  <i class="fa fa-times close-sidebar"></i>

  <div class="sidebar-title-container">
    <div class="docsets-dropdown dropdown">
      <button class="dropdown-button" id="module-dropdown" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" tabindex="0">
        <span>
          Kong Mesh
          
        </span>
        <span class="caret"></span>
      </button>
      <ul class="dropdown-menu dropdown-menu-right with-submenu" id="module-list" role="menu" aria-labelledby="module-dropdown" aria-hidden="true">

        <li role="menuitem" tabindex="-1">
          <a href="/gateway/latest/">Kong Gateway</a>
        </li>
        <li role="menuitem" tabindex="-1">
          <a href="/konnect/">Kong Konnect</a>
        </li>
        <li role="menuitem" tabindex="-1" class="active">
          <a href="/mesh/latest/" class="active">Kong Mesh</a>
        </li>
        <li role="menuitem" tabindex="-1">
          <a href="/hub/?category=ai">Kong AI Gateway</a>
        </li>
        <li role="menuitem" tabindex="-1">
          <a href="/hub/">Plugin Hub</a>
        </li>
        <li role="menuitem" tabindex="-1">
          <a href="/deck/latest/">decK</a>
        </li>
        <li role="menuitem" tabindex="-1">
          <a href="/kubernetes-ingress-controller/latest/">Kong Ingress Controller</a>
        </li>
        <li role="menuitem" tabindex="-1">
          <a href="/gateway-operator/latest/">Kong Gateway Operator</a>
        </li>
        <li>
          <a href="https://docs.insomnia.rest/" target="_blank" rel="noopener nofollow noreferrer ">Insomnia</a>
        </li>
        <li role="menuitem" tabindex="-1">
          <a href="https://kuma.io/docs/" target="_blank" rel="noopener nofollow noreferrer ">Kuma</a>
        </li>
        <hr>
        <li role="menuitem" tabindex="-1">
          <a href="/contributing/">Docs contribution guidelines</a>
        </li>
      </ul>
    </div>

    
    <div class="versions-dropdown dropdown">
      <button class="dropdown-button" id="version-dropdown" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" tabindex="0">
        <span>
          Version 1.9.x
          
          
        </span>
        <span class="caret"></span>
      </button>
      <ul class="dropdown-menu dropdown-menu-right" id="version-list" role="menu" aria-labelledby="version-dropdown" aria-hidden="true">
        
          <li role="menuitem" tabindex="-1">
            <a href="/mesh/dev/features/vault/" data-version-id="2.9.x">
              <em>dev</em>
            </a>
          </li>
        
          <li role="menuitem" tabindex="-1">
            <a href="/mesh/2.8.x/features/vault/" data-version-id="2.8.x">
              2.8.x <em>(latest)</em>
            </a>
          </li>
        
          <li role="menuitem" tabindex="-1">
            <a href="/mesh/2.7.x/features/vault/" data-version-id="2.7.x">
              2.7.x (LTS)
            </a>
          </li>
        
          <li role="menuitem" tabindex="-1">
            <a href="/mesh/2.6.x/features/vault/" data-version-id="2.6.x">
              2.6.x
            </a>
          </li>
        
          <li role="menuitem" tabindex="-1">
            <a href="/mesh/2.5.x/features/vault/" data-version-id="2.5.x">
              2.5.x
            </a>
          </li>
        
          <li role="menuitem" tabindex="-1">
            <a href="/mesh/2.4.x/features/vault/" data-version-id="2.4.x">
              2.4.x
            </a>
          </li>
        
          <li role="menuitem" tabindex="-1">
            <a href="/mesh/2.3.x/features/vault/" data-version-id="2.3.x">
              2.3.x
            </a>
          </li>
        
          <li role="menuitem" tabindex="-1">
            <a href="/mesh/2.2.x/features/vault/" data-version-id="2.2.x">
              2.2.x
            </a>
          </li>
        
          <li role="menuitem" tabindex="-1">
            <a href="/mesh/2.1.x/features/vault/" data-version-id="2.1.x">
              2.1.x
            </a>
          </li>
        
          <li role="menuitem" tabindex="-1">
            <a href="/mesh/2.0.x/features/vault/" data-version-id="2.0.x">
              2.0.x
            </a>
          </li>
        
          <li class="active" role="menuitem" tabindex="-1">
            <a href="/mesh/1.9.x/features/vault/" class="active" data-version-id="1.9.x">
              1.9.x
            </a>
          </li>
        
          <li role="menuitem" tabindex="-1">
            <a href="/mesh/1.8.x/features/vault/" data-version-id="1.8.x">
              1.8.x
            </a>
          </li>
        
          <li role="menuitem" tabindex="-1">
            <a href="/mesh/1.7.x/features/vault/" data-version-id="1.7.x">
              1.7.x
            </a>
          </li>
        
          <li role="menuitem" tabindex="-1">
            <a href="/mesh/1.6.x/features/vault/" data-version-id="1.6.x">
              1.6.x
            </a>
          </li>
        
          <li role="menuitem" tabindex="-1">
            <a href="/mesh/1.5.x/features/vault/" data-version-id="1.5.x">
              1.5.x
            </a>
          </li>
        
          <li role="menuitem" tabindex="-1">
            <a href="/mesh/1.4.x/features/vault/" data-version-id="1.4.x">
              1.4.x
            </a>
          </li>
        
          <li role="menuitem" tabindex="-1">
            <a href="/mesh/1.3.x/features/vault/" data-version-id="1.3.x">
              1.3.x
            </a>
          </li>
        
          <li role="menuitem" tabindex="-1">
            <a href="/mesh/1.2.x/features/vault/" data-version-id="1.2.x">
              1.2.x
            </a>
          </li>
        
        
      </ul>
    </div>
    
  </div>

  <ul class="sidebar-container" role="tree" aria-label="Documentation">
    
      <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label" aria-expanded="false" aria-owns="id-1-introduction-subtree">
    
      <a class="sidebar-link" tabindex="-1" href="/mesh/1.9.x/">
        
  <img src="/assets/images/icons/documentation/icn-flag.svg" alt="">


Introduction

      </a>
    

    
      <button class="sidebar-tree-toggle" aria-label="toggle Introduction subtree" tabindex="-1">
        <i class="fa fa-chevron-down"></i>
      </button>
    
  </span>

  
    <ul class="items" id="id-1-introduction-subtree" role="group" aria-label="Introduction">
      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/mesh/1.9.x/support-policy/">
        

Version Support Policy

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/mesh/1.9.x/availability-stages/">
        

Stages of Software Availability

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/mesh/changelog/">
        

Release Notes

      </a>
    

    
  </span>

  
</li>

      
    </ul>
  
</li>

    
      <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/mesh/1.9.x/gettingstarted/">
        
  <img src="/assets/images/icons/documentation/icn-quickstart-color.svg" alt="">


Getting Started

      </a>
    

    
  </span>

  
</li>

    
      <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label" aria-expanded="false" aria-owns="id-3-install-subtree">
    
      <a class="sidebar-link" tabindex="-1" href="/mesh/1.9.x/install/">
        
  <img src="/assets/images/icons/documentation/icn-deployment-color.svg" alt="">


Install

      </a>
    

    
      <button class="sidebar-tree-toggle" aria-label="toggle Install subtree" tabindex="-1">
        <i class="fa fa-chevron-down"></i>
      </button>
    
  </span>

  
    <ul class="items" id="id-3-install-subtree" role="group" aria-label="Install">
      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/mesh/1.9.x/installation/kubernetes/">
        

Kubernetes

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/mesh/1.9.x/installation/helm/">
        

Helm

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/mesh/1.9.x/installation/openshift/">
        

OpenShift

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/mesh/1.9.x/installation/docker/">
        

Docker

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/mesh/1.9.x/installation/ecs/">
        

Amazon ECS

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/mesh/1.9.x/installation/centos/">
        

CentOS

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/mesh/1.9.x/installation/redhat/">
        

Red Hat

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/mesh/1.9.x/installation/amazonlinux/">
        

Amazon Linux

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/mesh/1.9.x/installation/debian/">
        

Debian

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/mesh/1.9.x/installation/ubuntu/">
        

Ubuntu

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/mesh/1.9.x/installation/macos/">
        

macOS

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/mesh/1.9.x/installation/windows/">
        

Windows

      </a>
    

    
  </span>

  
</li>

      
    </ul>
  
</li>

    
      <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label" aria-expanded="false" aria-owns="id-4-plan-and-deploy-subtree">
    
      
  <img src="/assets/images/icons/documentation/icn-deployment-color.svg" alt="">


Plan and Deploy

    

    
      <button class="sidebar-tree-toggle" aria-label="toggle Plan and Deploy subtree" tabindex="-1">
        <i class="fa fa-chevron-down"></i>
      </button>
    
  </span>

  
    <ul class="items" id="id-4-plan-and-deploy-subtree" role="group" aria-label="Plan and Deploy">
      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/mesh/1.9.x/plan-and-deploy/license/">
        

License

      </a>
    

    
  </span>

  
</li>

      
    </ul>
  
</li>

    
      <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label" aria-expanded="false" aria-owns="id-5-enterprise-features-subtree">
    
      
  <img src="/assets/images/icons/documentation/icn-enterprise-blue.svg" alt="">


Enterprise Features

    

    
      <button class="sidebar-tree-toggle" aria-label="toggle Enterprise Features subtree" tabindex="-1">
        <i class="fa fa-chevron-down"></i>
      </button>
    
  </span>

  
    <ul class="items" id="id-5-enterprise-features-subtree" role="group" aria-label="Enterprise Features">
      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/mesh/1.9.x/features/vault/">
        

HashiCorp Vault CA

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/mesh/1.9.x/features/acmpca/">
        

Amazon ACM Private CA

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/mesh/1.9.x/features/cert-manager/">
        

cert-manager Private CA

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/mesh/1.9.x/features/opa/">
        

OPAPolicy Support

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/mesh/1.9.x/features/kds-auth/">
        

Multi-zone authentication

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/mesh/1.9.x/features/fips-support/">
        

FIPS support

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/mesh/1.9.x/features/ca-rotation/">
        

Certificate Authority rotation

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/mesh/1.9.x/features/rbac/">
        

Role-Based Access Control

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/mesh/1.9.x/features/ubi-images/">
        

UBI Images

      </a>
    

    
  </span>

  
</li>

      
        
        <li class="sidebar-item" role="none">
  <span role="treeitem" class="sidebar-label">
    
      <a class="sidebar-link" tabindex="-1" href="/mesh/1.9.x/features/windows/">
        

Windows Support

      </a>
    

    
  </span>

  
</li>

      
    </ul>
  
</li>

    
  </ul>
</aside>




      <aside class="docs-toc">
        <i class="fa fa-times close-sidebar"></i>
        <i class="fa fa-chevron-right collapse-toc"></i>
        <i class="far fa-list-alt expand-toc"></i>

        <div id="oss-ee-toggle" data-current="Enterprise" style="display: none">
          <span class="oss-ee-toggle-inner">
            <img src="/assets/images/icons/icn-enterprise-black.svg" alt="enterprise-switcher-icon">
            <span>Switch to <span id="switch-to-version">OSS</span></span>
          </span>
        </div>

        
        <div class="docs-toc-title">
<img src="/assets/images/icons/hub-layout/icn-on-this-page.svg" alt="On this page"><a href="#">On this page</a>
</div>
<ul>
  <li><a href="#vault-ca-backend" class="active scroll-to">Vault CA Backend</a></li>
  <li>
<a href="#vault-mode" class="scroll-to">Vault mode</a>
    <ul>
      <li><a href="#configure-vault" class="scroll-to">Configure Vault</a></li>
      <li><a href="#configure-mesh" class="scroll-to">Configure Mesh</a></li>
    </ul>
  </li>
  <li><a href="#common-name" class="scroll-to">Common name</a></li>
  <li><a href="#multi-zone-and-vault" class="scroll-to">Multi-zone and Vault</a></li>
</ul>

        
      </aside>

    <div class="page-content-container page-content-container-doc v2 " id="documentation">
      <div class="toggles ">
          <i class="far fa-list-alt toc-sidebar-toggle"></i>
      </div>

      <div class="page-content">
        <div class="content show-anchor-links">
          
            
              <blockquote id="version-notice" class="important">
                You are browsing documentation for an older version.
            
                See the <a href="/mesh/latest/features/vault/">latest documentation here</a>.
              </blockquote>
          

          <h1 tabindex="-1" id="main" class="page-content-title">Vault Policy
            

            
          </h1>

          

          
          

          <h2 id="vault-ca-backend">Vault CA Backend</h2>

<p>The default <a href="https://kuma.io/docs/1.8.x/policies/mutual-tls/" target="_blank" rel="noopener nofollow noreferrer ">mTLS policy in Kong Mesh</a>
supports the following backends:</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">builtin</code>: Kong Mesh automatically generates the Certificate
Authority (CA) root certificate and key that will be used to generate the data
plane certificates.</li>
  <li>
<code class="language-plaintext highlighter-rouge">provided</code>: the CA root certificate and key can be provided by the user.</li>
</ul>

<p>Kong Mesh adds:</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">vault</code>: Kong Mesh generates data plane certificates
using a CA root certificate and key stored in a HashiCorp Vault
server.</li>
  <li>
<a href="/mesh/1.9.x/features/acmpca/"><code class="language-plaintext highlighter-rouge">acmpca</code></a>: Kong Mesh generates data plane certificates
using Amazon Certificate Manager Private CA.</li>
  <li>
<a href="/mesh/1.9.x/features/cert-manager/"><code class="language-plaintext highlighter-rouge">certmanager</code></a>: Kong Mesh generates data plane certificates
using Kubernetes <a href="https://cert-manager.io" target="_blank" rel="noopener nofollow noreferrer ">cert-manager</a> certificate controller.</li>
</ul>

<h2 id="vault-mode">Vault mode</h2>

<p>In <code class="language-plaintext highlighter-rouge">vault</code> mTLS mode, Kong Mesh communicates with the HashiCorp Vault PKI,
which generates the data plane proxy certificates automatically.
Kong Mesh does not retrieve private key of the CA to generate data plane proxy certificates,
which means that private key of the CA is secured by Vault and not exposed to third parties.</p>

<p>In <code class="language-plaintext highlighter-rouge">vault</code> mode, you point Kong Mesh to the
Vault server and provide the appropriate credentials. Kong Mesh
uses these parameters to authenticate the control plane and generate the
data plane certificates.</p>

<p>When Kong Mesh is running in <code class="language-plaintext highlighter-rouge">vault</code> mode, the backend communicates with Vault and ensures
that Vault’s PKI automatically issues data plane certificates and rotates them for
each proxy.</p>

<p>If Kong Mesh is configured to authenticate to Vault using a renewable token,
it will handle keeping the token renewed.</p>

<h3 id="configure-vault">Configure Vault</h3>

<p>The <code class="language-plaintext highlighter-rouge">vault</code> mTLS backend expects a configured PKI and role for generating data plane proxy certificates.</p>

<p>The following steps show how to configure Vault for Kong Mesh with a mesh named
<code class="language-plaintext highlighter-rouge">default</code>. For your environment, replace <code class="language-plaintext highlighter-rouge">default</code> with the appropriate mesh name.</p>

<h4 id="step-1-configure-the-certificate-authority">Step 1. Configure the Certificate Authority</h4>

<p>Kong Mesh works with a Root CA or an Intermediate CA.</p>

<div class="navtabs  ">
  <div class="navtab-titles" role="tablist">
  
    
    <div data-slug="root-ca" data-navtab-id="navtab-8b863c83-20c6-4f8a-91b0-163b82245b2a-0" class="navtab-title" role="tab" aria-controls="navtab-id-0" tabindex="0">
      Root CA
    </div>
  
    
    <div data-slug="intermediate-ca" data-navtab-id="navtab-8b863c83-20c6-4f8a-91b0-163b82245b2a-1" class="navtab-title" role="tab" aria-controls="navtab-id-1" tabindex="0">
      Intermediate CA
    </div>
  
  </div>
  <div class="navtab-contents">
  
    
    <div data-panel="root-ca" data-navtab-content="navtab-8b863c83-20c6-4f8a-91b0-163b82245b2a-0" class="navtab-content" role="tabpanel" id="navtab-id-0" tabindex="0" aria-labelledby="navtab-id-0">
      
<p>Create a new PKI for the <code class="language-plaintext highlighter-rouge">default</code> Mesh called <code class="language-plaintext highlighter-rouge">kmesh-pki-default</code>:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vault secrets <span class="nb">enable</span> <span class="nt">-path</span><span class="o">=</span>kmesh-pki-default pki
</code></pre></div></div>

<p>Generate a new Root Certificate Authority for the <code class="language-plaintext highlighter-rouge">default</code> Mesh:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vault secrets tune <span class="nt">-max-lease-ttl</span><span class="o">=</span>87600h kmesh-pki-default
</code></pre></div></div>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vault write <span class="nt">-field</span><span class="o">=</span>certificate kmesh-pki-default/root/generate/internal <span class="se">\</span>
  <span class="nv">common_name</span><span class="o">=</span><span class="s2">"Kong Mesh Default"</span> <span class="se">\</span>
  <span class="nv">uri_sans</span><span class="o">=</span><span class="s2">"spiffe://default"</span> <span class="se">\</span>
  <span class="nv">ttl</span><span class="o">=</span>87600h
</code></pre></div></div>


    </div>
  
    
    <div data-panel="intermediate-ca" data-navtab-content="navtab-8b863c83-20c6-4f8a-91b0-163b82245b2a-1" class="navtab-content" role="tabpanel" id="navtab-id-1" tabindex="0" aria-labelledby="navtab-id-1">
      
<p>Create a new Root Certificate Authority and save it to a file called <code class="language-plaintext highlighter-rouge">ca.pem</code>:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vault secrets <span class="nb">enable </span>pki
</code></pre></div></div>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vault secrets tune <span class="nt">-max-lease-ttl</span><span class="o">=</span>87600h pki
</code></pre></div></div>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vault write <span class="nt">-field</span><span class="o">=</span>certificate pki/root/generate/internal <span class="se">\</span>
  <span class="nv">common_name</span><span class="o">=</span><span class="s2">"Organization CA"</span> <span class="se">\</span>
  <span class="nv">ttl</span><span class="o">=</span>87600h <span class="o">&gt;</span> ca.pem
</code></pre></div></div>

<p>You can also use your current Root CA, retrieve the PEM-encoded certificate, and save it to <code class="language-plaintext highlighter-rouge">ca.pem</code>.</p>

<p>Create a new PKI for the <code class="language-plaintext highlighter-rouge">default</code> Mesh:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vault secrets <span class="nb">enable</span> <span class="nt">-path</span><span class="o">=</span>kmesh-pki-default pki
</code></pre></div></div>

<p>Generate the Intermediate CA for the <code class="language-plaintext highlighter-rouge">default</code> Mesh:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vault write <span class="nt">-format</span><span class="o">=</span>json kmesh-pki-default/intermediate/generate/internal <span class="se">\</span>
    <span class="nv">common_name</span><span class="o">=</span><span class="s2">"Kong Mesh Mesh Default"</span> <span class="se">\</span>
    <span class="nv">uri_sans</span><span class="o">=</span><span class="s2">"spiffe://default"</span> <span class="se">\</span>
    | jq <span class="nt">-r</span> <span class="s1">'.data.csr'</span> <span class="o">&gt;</span> pki_intermediate.csr
</code></pre></div></div>

<p>Sign the Intermediate CA with the Root CA. Make sure to pass the right path for the PKI that has the Root CA.
In this example, the path  value is <code class="language-plaintext highlighter-rouge">pki</code>:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vault write <span class="nt">-format</span><span class="o">=</span>json pki/root/sign-intermediate <span class="nv">csr</span><span class="o">=</span>@pki_intermediate.csr <span class="se">\</span>
  <span class="nv">format</span><span class="o">=</span>pem_bundle <span class="se">\</span>
  <span class="nv">ttl</span><span class="o">=</span><span class="s2">"43800h"</span> <span class="se">\</span>
  | jq <span class="nt">-r</span> <span class="s1">'.data.certificate'</span> <span class="o">&gt;</span> intermediate.cert.pem
</code></pre></div></div>

<p>Set the certificate of signed Intermediate CA to the <code class="language-plaintext highlighter-rouge">default</code> Mesh PKI. You must include the public certificate of the Root CA
so that data plane proxies can verify the certificates:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat </span>intermediate.cert.pem <span class="o">&gt;</span> bundle.pem
<span class="nb">echo</span> <span class="s2">""</span> <span class="o">&gt;&gt;</span> bundle.pem
<span class="nb">cat </span>ca.pem <span class="o">&gt;&gt;</span> bundle.pem
vault write kmesh-pki-default/intermediate/set-signed <span class="nv">certificate</span><span class="o">=</span>@bundle.pem
</code></pre></div></div>


    </div>
  
  </div>
</div>

<h4 id="step-2-create-a-role-for-generating-data-plane-proxy-certificates">Step 2. Create a role for generating data plane proxy certificates:</h4>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vault write kmesh-pki-default/roles/dataplane-proxies <span class="se">\</span>
  <span class="nv">allowed_uri_sans</span><span class="o">=</span><span class="s2">"spiffe://default/*,kuma://*"</span> <span class="se">\</span>
  <span class="nv">key_usage</span><span class="o">=</span><span class="s2">"KeyUsageKeyEncipherment,KeyUsageKeyAgreement,KeyUsageDigitalSignature"</span> <span class="se">\</span>
  <span class="nv">ext_key_usage</span><span class="o">=</span><span class="s2">"ExtKeyUsageServerAuth,ExtKeyUsageClientAuth"</span> <span class="se">\</span>
  <span class="nv">client_flag</span><span class="o">=</span><span class="nb">true</span> <span class="se">\</span>
  <span class="nv">require_cn</span><span class="o">=</span><span class="nb">false</span> <span class="se">\</span>
  <span class="nv">allowed_domains</span><span class="o">=</span><span class="s2">"mesh"</span> <span class="se">\</span>
  <span class="nv">allow_subdomains</span><span class="o">=</span><span class="nb">true</span> <span class="se">\</span>
  <span class="nv">basic_constraints_valid_for_non_ca</span><span class="o">=</span><span class="nb">true</span> <span class="se">\</span>
  <span class="nv">max_ttl</span><span class="o">=</span><span class="s2">"720h"</span> <span class="se">\</span>
  <span class="nv">ttl</span><span class="o">=</span><span class="s2">"720h"</span>
</code></pre></div></div>

<blockquote class="note">
  <p><strong>Note:</strong> Use the <code class="language-plaintext highlighter-rouge">allowed_domains</code> and <code class="language-plaintext highlighter-rouge">allow_subdomains</code> parameters
<strong>only</strong> when <code class="language-plaintext highlighter-rouge">commonName</code> is set in the mTLS Vault backend.</p>
</blockquote>

<h4 id="step-3-create-a-policy-to-use-the-new-role">Step 3. Create a policy to use the new role:</h4>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat</span> <span class="o">&gt;</span> kmesh-default-dataplane-proxies.hcl <span class="o">&lt;&lt;-</span> <span class="no">EOM</span><span class="sh">
path "/kmesh-pki-default/issue/dataplane-proxies"
{
  capabilities = ["create", "update"]
}
</span><span class="no">EOM
</span>vault policy write kmesh-default-dataplane-proxies kmesh-default-dataplane-proxies.hcl
</code></pre></div></div>

<h4 id="step-4-configure-authentication-method">Step 4. Configure authentication method:</h4>

<p>To authorize Kong Mesh to vault using a token, generate the following orphan token and pass it to the mesh:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vault token create <span class="nt">-type</span><span class="o">=</span>service <span class="nt">-orphan</span> <span class="nt">-format</span><span class="o">=</span>json <span class="nt">-policy</span><span class="o">=</span><span class="s2">"kmesh-default-dataplane-proxies"</span> | jq <span class="nt">-r</span> <span class="s2">".auth.client_token"</span>
</code></pre></div></div>

<p>We suggest using an <a href="https://developer.hashicorp.com/vault/docs/concepts/tokens#token-hierarchies-and-orphan-tokens" target="_blank" rel="noopener nofollow noreferrer ">orphan token to avoid surprising behavior around expiration in token hierarchies</a>.
You need root/sudo permissions to execute the previous command.
The output should print a Vault token that you then provide as the <code class="language-plaintext highlighter-rouge">conf.fromCp.auth.token</code> value of the <code class="language-plaintext highlighter-rouge">Mesh</code> object.</p>

<blockquote class="note">
  <p><strong>Note:</strong> There are some failure modes where the <code class="language-plaintext highlighter-rouge">vault</code> CLI still returns a token
even though an error was encountered and the token is invalid. For example, if the
policy creation fails in the previous step, then the <code class="language-plaintext highlighter-rouge">vault token create</code> command
both returns a token and exposes an error. In such situations, using <code class="language-plaintext highlighter-rouge">jq</code> to parse
the output hides the error message provided in the <code class="language-plaintext highlighter-rouge">vault</code> CLI output. Manually
parse the output instead of using <code class="language-plaintext highlighter-rouge">jq</code> so that the full output of the <code class="language-plaintext highlighter-rouge">vault</code> CLI
command is available.</p>
</blockquote>

<p>Kong Mesh also supports AWS Instance Role authentication to Vault. Vault must be configured to accept EC2 or IAM role authentication. See <a href="https://www.vaultproject.io/docs/auth/aws" target="_blank" rel="noopener nofollow noreferrer ">Vault documentation</a> for details.  With Vault configured, select AWS authentication in the <code class="language-plaintext highlighter-rouge">Mesh</code> object by setting <code class="language-plaintext highlighter-rouge">conf.fromCp.auth.aws</code>. Kong Mesh will authenticate using the instance or IRSA role available within the environment.</p>

<h3 id="configure-mesh">Configure Mesh</h3>

<p><code class="language-plaintext highlighter-rouge">kuma-cp</code> communicates directly with Vault. To connect to
Vault, you must provide credentials in the configuration of the <code class="language-plaintext highlighter-rouge">mesh</code> object of <code class="language-plaintext highlighter-rouge">kuma-cp</code>.</p>

<p>You can authenticate with the <code class="language-plaintext highlighter-rouge">token</code>, with client certificates by providing <code class="language-plaintext highlighter-rouge">clientKey</code> and <code class="language-plaintext highlighter-rouge">clientCert</code>, or by AWS role-based authentication.</p>

<p>You can provide these values inline for testing purposes only, as a path to a file on the
same host as <code class="language-plaintext highlighter-rouge">kuma-cp</code>, or contained in a <code class="language-plaintext highlighter-rouge">secret</code>. When using a <code class="language-plaintext highlighter-rouge">secret</code>, it should be a
<a href="https://kuma.io/docs/1.8.x/security/secrets/" target="_blank" rel="noopener nofollow noreferrer ">mesh-scoped secret</a>.
On Kubernetes, this mesh-scoped secret should be stored
in the system namespace (<code class="language-plaintext highlighter-rouge">kong-mesh-system</code> by default) and should be configured as <code class="language-plaintext highlighter-rouge">type: system.kuma.io/secret</code>.</p>

<p>Here’s an example of a configuration with a <code class="language-plaintext highlighter-rouge">vault</code>-backed CA:</p>

<div class="navtabs  ">
  <div class="navtab-titles" role="tablist">
  
    
    <div data-slug="kubernetes" data-navtab-id="navtab-c70fe82b-6758-4ae2-ab20-5a7306482bc1-0" class="navtab-title" role="tab" aria-controls="navtab-id-0" tabindex="0">
      Kubernetes
    </div>
  
    
    <div data-slug="universal" data-navtab-id="navtab-c70fe82b-6758-4ae2-ab20-5a7306482bc1-1" class="navtab-title" role="tab" aria-controls="navtab-id-1" tabindex="0">
      Universal
    </div>
  
  </div>
  <div class="navtab-contents">
  
    
    <div data-panel="kubernetes" data-navtab-content="navtab-c70fe82b-6758-4ae2-ab20-5a7306482bc1-0" class="navtab-content" role="tabpanel" id="navtab-id-0" tabindex="0" aria-labelledby="navtab-id-0">
      
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">kuma.io/v1alpha1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Mesh</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">default</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">mtls</span><span class="pi">:</span>
    <span class="na">enabledBackend</span><span class="pi">:</span> <span class="s">vault-1</span>
    <span class="na">backends</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">vault-1</span>
        <span class="na">type</span><span class="pi">:</span> <span class="s">vault</span>
        <span class="na">dpCert</span><span class="pi">:</span>
          <span class="na">rotation</span><span class="pi">:</span>
            <span class="na">expiration</span><span class="pi">:</span> <span class="s">1d</span> <span class="c1"># must be lower than max_ttl in Vault role</span>
        <span class="na">conf</span><span class="pi">:</span>
          <span class="na">fromCp</span><span class="pi">:</span>
            <span class="na">address</span><span class="pi">:</span> <span class="s">https://vault.8200</span>
            <span class="na">agentAddress</span><span class="pi">:</span> <span class="s2">"</span><span class="s">"</span> <span class="c1"># optional</span>
            <span class="na">namespace</span><span class="pi">:</span> <span class="s2">"</span><span class="s">"</span> <span class="c1"># optional</span>
            <span class="na">pki</span><span class="pi">:</span> <span class="s">kmesh-pki-default</span> <span class="c1"># name of the configured PKI</span>
            <span class="na">role</span><span class="pi">:</span> <span class="s">dataplane-proxies</span> <span class="c1"># name of the role that will be used to generate data plane proxy certificates</span>
            <span class="na">commonName</span><span class="pi">:</span> <span class="s1">'</span><span class="s">{{</span><span class="nv"> </span><span class="s">tag</span><span class="nv"> </span><span class="s">"kuma.io/service"</span><span class="nv"> </span><span class="s">}}.mesh'</span> <span class="c1"># optional. If set, then commonName is added to the certificate. You can use "tag" directive to pick a tag which will be base for commonName.</span>

            <span class="na">tls</span><span class="pi">:</span> <span class="c1"># options for connecting to Vault via TLS</span>
              <span class="na">skipVerify</span><span class="pi">:</span> <span class="kc">false</span>   <span class="c1"># if set to true, caCert is optional, should only be used in development</span>
              <span class="na">caCert</span><span class="pi">:</span>             <span class="c1"># caCert is used to verify the TLS certificate presented by Vault</span>
                <span class="na">secret</span><span class="pi">:</span> <span class="s">sec-1</span>     <span class="c1"># one of secret, inline, or inlineString</span>
              <span class="na">serverName</span><span class="pi">:</span> <span class="s2">"</span><span class="s">"</span>      <span class="c1"># optional. The SNI to use when connecting to Vault</span>

            <span class="na">auth</span><span class="pi">:</span> <span class="c1"># how to authenticate Kong Mesh when connecting to Vault</span>
              <span class="na">token</span><span class="pi">:</span>
                <span class="na">secret</span><span class="pi">:</span> <span class="s">token-1</span>  <span class="c1"># one of secret, inline, or inlineString</span>
              <span class="na">tls</span><span class="pi">:</span>
                <span class="na">clientKey</span><span class="pi">:</span>
                  <span class="na">secret</span><span class="pi">:</span> <span class="s">sec-2</span>  <span class="c1"># can be file, secret or inline</span>
                <span class="na">clientCert</span><span class="pi">:</span>
                  <span class="na">file</span><span class="pi">:</span> <span class="s">/tmp/cert.pem</span> <span class="c1"># can be file, secret or inlineString</span>
              <span class="na">aws</span><span class="pi">:</span> <span class="c1"># AWS role-based authentication. May be empty to use defaults.</span>
                <span class="na">type</span><span class="pi">:</span> <span class="s2">"</span><span class="s">IAM"</span> <span class="s">or "EC2"</span> <span class="c1"># Optional AWS authentication type. Default is IAM.</span>
                <span class="na">role</span><span class="pi">:</span> <span class="s">role-name</span> <span class="c1"># Optional role name to use for IAM authentication</span>
                <span class="na">iamServerIdHeader</span><span class="pi">:</span> <span class="s">example.com</span> <span class="c1"># Optional server ID header value</span>
</code></pre></div></div>


    </div>
  
    
    <div data-panel="universal" data-navtab-content="navtab-c70fe82b-6758-4ae2-ab20-5a7306482bc1-1" class="navtab-content" role="tabpanel" id="navtab-id-1" tabindex="0" aria-labelledby="navtab-id-1">
      
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">type</span><span class="pi">:</span> <span class="s">Mesh</span>
<span class="na">name</span><span class="pi">:</span> <span class="s">default</span>
<span class="na">mtls</span><span class="pi">:</span>
  <span class="na">enabledBackend</span><span class="pi">:</span> <span class="s">vault-1</span>
  <span class="na">backends</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">vault-1</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">vault</span>
    <span class="na">dpCert</span><span class="pi">:</span>
      <span class="na">rotation</span><span class="pi">:</span>
        <span class="na">expiration</span><span class="pi">:</span> <span class="s">24h</span> <span class="c1"># must be lower than max_ttl in Vault role</span>
    <span class="na">conf</span><span class="pi">:</span>
      <span class="na">fromCp</span><span class="pi">:</span>
        <span class="na">address</span><span class="pi">:</span> <span class="s">https://vault.8200</span>
        <span class="na">agentAddress</span><span class="pi">:</span> <span class="s2">"</span><span class="s">"</span> <span class="c1"># optional</span>
        <span class="na">namespace</span><span class="pi">:</span> <span class="s2">"</span><span class="s">"</span> <span class="c1"># optional</span>
        <span class="na">pki</span><span class="pi">:</span> <span class="s">kmesh-pki-default</span> <span class="c1"># name of the configured PKI</span>
        <span class="na">role</span><span class="pi">:</span> <span class="s">dataplane-proxies</span> <span class="c1"># name of the role that will be used to generate data plane proxy certificates</span>
        <span class="na">commonName</span><span class="pi">:</span> <span class="s1">'</span><span class="s">{{</span><span class="nv"> </span><span class="s">tag</span><span class="nv"> </span><span class="s">"kuma.io/service"</span><span class="nv"> </span><span class="s">}}.mesh'</span> <span class="c1"># optional. If set, then commonName is added to the certificate. You can use "tag" directive to pick a tag which will be base for commonName.</span>
        <span class="na">tls</span><span class="pi">:</span>
          <span class="na">caCert</span><span class="pi">:</span>
            <span class="na">secret</span><span class="pi">:</span> <span class="s">sec-1</span>
          <span class="na">skipVerify</span><span class="pi">:</span> <span class="kc">false</span> <span class="c1"># if set to true, caCert is optional. Set to true only for development</span>
          <span class="na">serverName</span><span class="pi">:</span> <span class="s2">"</span><span class="s">"</span> <span class="c1"># verify sever name</span>
        <span class="na">auth</span><span class="pi">:</span> <span class="c1"># how to authenticate Kong Mesh when connecting to Vault</span>
          <span class="na">token</span><span class="pi">:</span>
            <span class="na">secret</span><span class="pi">:</span> <span class="s">token-1</span>  <span class="c1"># can be file, secret or inlineString</span>
          <span class="na">tls</span><span class="pi">:</span>
            <span class="na">clientKey</span><span class="pi">:</span>
              <span class="na">secret</span><span class="pi">:</span> <span class="s">sec-2</span>  <span class="c1"># can be file, secret or inlineString</span>
            <span class="na">clientCert</span><span class="pi">:</span>
              <span class="na">file</span><span class="pi">:</span> <span class="s">/tmp/cert.pem</span> <span class="c1"># can be file, secret or inline</span>
            <span class="na">aws</span><span class="pi">:</span> <span class="c1"># AWS role-based authentication. May be empty to use defaults.</span>
              <span class="na">type</span><span class="pi">:</span> <span class="s2">"</span><span class="s">IAM"</span> <span class="s">or "EC2"</span> <span class="c1"># Optional AWS authentication type. Default is IAM.</span>
              <span class="na">role</span><span class="pi">:</span> <span class="s">role-name</span> <span class="c1"># Optional role name to use for IAM authentication</span>
              <span class="na">iamServerIdHeader</span><span class="pi">:</span> <span class="s">example.com</span> <span class="c1"># Optional server ID header value</span>
</code></pre></div></div>


    </div>
  
  </div>
</div>

<p>Apply the configuration with <code class="language-plaintext highlighter-rouge">kumactl apply -f [..]</code>.</p>

<p>If you’re running in Universal mode, you can also use the <a href="https://kuma.io/docs/1.8.x/reference/http-api" target="_blank" rel="noopener nofollow noreferrer ">HTTP API</a> to apply configuration.</p>

<h2 id="common-name">Common name</h2>

<p>Kong Mesh uses Service Alternative Name with <code class="language-plaintext highlighter-rouge">spiffe://</code> format to verify secure connection between services. In this case, the common name in the certificate is not used.
You may need to set a common name in the certificate, for compliance reasons. To do this, set the <code class="language-plaintext highlighter-rouge">commonName</code> field in the Vault mTLS backend configuration.
The value contains the template that will be used to generate the name.</p>

<p>For example, assuming that the template is <code class="language-plaintext highlighter-rouge">'{{ tag "kuma.io/service" }}.mesh'</code>, a data plane proxy with <code class="language-plaintext highlighter-rouge">kuma.io/service: backend</code> tag will receive a certificate with the <code class="language-plaintext highlighter-rouge">backend.mesh</code> common name.</p>

<p>You can also use the <code class="language-plaintext highlighter-rouge">replace</code> function to replace <code class="language-plaintext highlighter-rouge">_</code> with <code class="language-plaintext highlighter-rouge">-</code>. For example, <code class="language-plaintext highlighter-rouge">'{{ tag "kuma.io/service" | replace "_" "-" }}.mesh'</code> changes the common name of <code class="language-plaintext highlighter-rouge">kuma.io/service: my_backend</code> from <code class="language-plaintext highlighter-rouge">my_backend.mesh</code> to <code class="language-plaintext highlighter-rouge">my-backend.mesh</code>.</p>

<h2 id="multi-zone-and-vault">Multi-zone and Vault</h2>

<p>In a multi-zone environment, the global control plane provides the <code class="language-plaintext highlighter-rouge">Mesh</code> to the zone control planes. However, you must make sure that each zone control plane communicates with Vault over the same address. This is because certificates for data plane proxies are issued from the zone control plane, not from the global control plane.</p>

<p>You must also make sure the global control plane communicates with Vault. When a new Vault backend is configured, Kong Mesh validates the connection by issuing a test certificate. In a multi-zone environment, validation is performed on the global control plane.</p>

<!-- links -->



          

        </div>
      </div>
    </div>
    
      <div id="scroll-to-top-button">
        <i class="fas fa-chevron-up"></i>
      </div>
      
        <div class="feedback-widget-container">
  <input id="feedback-widget-checkbox" type="checkbox">
  <label for="feedback-widget-checkbox">
    <img src="/assets/images/icons/feedback-widget.svg" alt="Feedback widget">
  </label>
  <div class="feedback-container">
    <div class="feedback-thankyou">
      Thank you for your feedback.
    </div>
    <div class="feedback-comment">
      <textarea id="feedback-comment-text" rows="3" placeholder="Please let us know what we can improve on this page..."></textarea>
      <div class="feedback-comment-buttons">
        <button id="feedback-comment-button-back">Back</button>
        <button id="feedback-comment-button-submit" class="button-primary">Submit</button>
      </div>
    </div>
    <div class="feedback-options">
      <div class="feedback-options-title">Was this page useful?</div>
      <div class="feedback-options-buttons">
        <i data-feedback-result="yes" class="feedback-options-button far fa-thumbs-up"></i>
        <i data-feedback-result="no" class="feedback-options-button far fa-thumbs-down"></i>
      </div>
    </div>
  </div>
</div>

      
    
  </div>

  <div id="image-modal" data-image-expand-disabled="">
  <div class="image-modal-backdrop"></div>
  <div class="image-container">
    <img src="" alt="">
    <i class="fa fa-times"></i>
  </div>
</div>




  <div class="modal closed" id="modal" role="dialog" aria-hidden="true" aria-labelledby="title" aria-describedby="description">
    <div class="konnect-cta-card">
      <div class="title">
      Too much on your plate?
      <a href="#" class="cta-card-close modal-close" id="modal-close">
          <img src="/assets/images/icons/documentation/close.svg" alt="close cta icon">
        </a>
      </div>
      <div class="description">More features, less infrastructure with Kong Konnect. 1M requests per month for free.</div>
      <a href="https://konghq.com/products/kong-konnect/register?utm_medium=referral&amp;utm_source=docs&amp;utm_campaign=gateway-konnect&amp;utm_campaign=right-nav-card&amp;utm_content=mesh" class="button" target="_blank" rel="noopener nofollow noreferrer ">
      Try it for Free
    </a>
    </div>
  </div>
  <div id="modal-open" class="modal-open"></div>
  <div class="modal-overlay closed" id="modal-overlay"></div>


    <footer class="marketing-footer--light-gray">
  <section>
    <ul class="newsletter">
      <li class="logo-wrapper">
        <div class="logo">
          <img src="/assets/images/logos/konglogo-light-theme-primary.svg" alt="Kong">
        </div>
        <div class="footer-title">Powering the API world</div>
        <p>
          Increase developer productivity, security, and performance at scale with the unified platform for API management, service mesh, and ingress controller.
        </p>
        <div class="footer-form-container">
          <form id="subscribe-form" method="POST" action="/assets/javascripts/subscribe.js">
            <input required id="subscribe-input" type="email" name="email" placeholder="Email" aria-required="true" aria-invalid="false">
            <input id="footer-form-button" type="submit" form="subscribe-form" value="Subscribe">
          </form>

          <div id="form-response"></div>
        </div>
      </li>

      <li class="footer-columns">
        <ul class="footer-columns-product-list">
          <li>
            <nav>
              <div class="footer-category">Products</div>
              <ul>
                <li>
                  <a href="https://konghq.com/products/kong-konnect" target="_blank" rel="noopener nofollow noreferrer ">Kong Konnect</a>
                </li>
                <li>
                  <a href="https://konghq.com/products/kong-enterprise" target="_blank" rel="noopener nofollow noreferrer ">Kong Gateway Enterprise</a>
                </li>
                <li>
                  <a href="https://konghq.com/products/kong-gateway" target="_blank" rel="noopener nofollow noreferrer ">Kong Gateway</a>
                </li>
                <li>
                  <a href="https://konghq.com/products/kong-mesh" target="_blank" rel="noopener nofollow noreferrer ">Kong Mesh</a>
                </li>
                <li>
                  <a href="https://konghq.com/products/kong-ingress-controller" target="_blank" rel="noopener nofollow noreferrer ">Kong Ingress Controller</a>
                </li>
                <li>
                  <a href="https://insomnia.rest/" target="_blank" rel="noopener nofollow noreferrer noopener nofollow noreferrer">Kong Insomnia</a>
                </li>
                <li>
                  <a href="https://konghq.com/product-updates" target="_blank" rel="noopener nofollow noreferrer ">Product Updates</a>
                </li>
                <li>
                  <a href="https://konghq.com/contact-sales" target="_blank" rel="noopener nofollow noreferrer ">Get Started</a>
                </li>
              </ul>
            </nav>
          </li>
          <li>
            <nav>
              <div class="footer-category">Documentation</div>
              <ul>
                <li>
                  <a href="/konnect/">Kong Konnect Docs</a>
                </li>
                <li>
                  <a href="/gateway/latest/">Kong Gateway Docs</a>
                </li>
                <li>
                  <a href="/gateway/latest/kong-enterprise/">Kong Gateway Enterprise Docs</a>
                </li>
                <li>
                  <a href="/mesh/latest/">Kong Mesh Docs</a>
                </li>
                <li>
                  <a href="https://docs.insomnia.rest/" target="_blank" rel="noopener nofollow noreferrer noopener nofollow noreferrer">Kong Insomnia Docs</a>
                </li>
                <li>
                  <a href="/hub/">Kong Konnect Plugin Hub</a>
                </li>
              </ul>
            </nav>
          </li>
          <li>
            <nav>
              <div class="footer-category">Open Source</div>
              <ul>
                <li>
                  <a href="https://konghq.com/install/#kong-community" target="_blank" rel="noopener nofollow noreferrer ">Kong Gateway</a>
                </li>
                <li>
                  <a href="https://kuma.io/" target="_blank" rel="noopener nofollow noreferrer noopener nofollow noreferrer">Kuma</a>
                </li>
                <li>
                  <a href="https://insomnia.rest/" target="_blank" rel="noopener nofollow noreferrer noopener nofollow noreferrer">Insomnia</a>
                </li>
                <li>
                  <a href="https://konghq.com/community" target="_blank" rel="noopener nofollow noreferrer ">Kong Community</a>
                </li>
              </ul>
            </nav>
          </li>
          <li>
            <nav>
              <div class="footer-category">Company</div>
              <ul>
                <li>
                  <a href="https://konghq.com/company/about-us" target="_blank" rel="noopener nofollow noreferrer ">About Kong</a>
                </li>
                <li>
                  <a href="https://konghq.com/customers" target="_blank" rel="noopener nofollow noreferrer ">Customers</a>
                </li>
                <li>
                  <a href="https://konghq.com/company/careers" target="_blank" rel="noopener nofollow noreferrer ">Careers</a>
                </li>
                <li>
                  <a href="https://konghq.com/press-room" target="_blank" rel="noopener nofollow noreferrer ">Press</a>
                </li>
                <li>
                  <a href="https://konghq.com/events" target="_blank" rel="noopener nofollow noreferrer ">Events</a>
                </li>
                <li>
                  <a href="https://konghq.com/company/contact-us" target="_blank" rel="noopener nofollow noreferrer ">Contact</a>
                </li>
              </ul>
            </nav>
          </li>
        </ul>
      </li>

    </ul>
  </section>

  <section class="legal">
    <div class="container d-flex">
      <div class="social">
        <div class="social-link">
          <a href="https://www.facebook.com/konghq/" title="Facebook" target="_blank" rel="noopener nofollow noreferrer "><i aria-label="Facebook" class="fa fa-facebook-official" aria-hidden="true"></i></a>
        </div>
        <div class="social-link">
          <a href="https://twitter.com/thekonginc" title="Twitter" target="_blank" rel="noopener nofollow noreferrer "><i aria-label="Twitter" class="fa fa-twitter" aria-hidden="true"></i></a>
        </div>
        <div class="social-link">
          <a href="https://www.meetup.com/topics/kong/all/" title="Meetup" target="_blank" rel="noopener nofollow noreferrer "><i aria-label="Meetup" class="fa fa-meetup" aria-hidden="true"></i></a>
        </div>
        <div class="social-link">
          <a href="https://linkedin.com/company/278819" title="LinkedIn" target="_blank" rel="noopener nofollow noreferrer "><i aria-label="GitHub" class="fa fa-linkedin" aria-hidden="true"></i></a>
        </div>
        <div class="social-link">
          <a href="https://github.com/kong/kong" target="_blank" class="btn-gh" title="GitHub" rel="noopener nofollow noreferrer ">
            <i class="fa fa-github" aria-hidden="true" aria-label="GitHub"></i>
          </a>
        </div>
      </div>
      <ul>
        <li>
          <span class="mashape-footer-content">
            <a href="https://konghq.com/legal/terms-of-use" target="_blank" rel="noopener nofollow noreferrer ">Terms</a><b>•</b>
            <a href="https://konghq.com/legal/privacy-policy" target="_blank" rel="noopener nofollow noreferrer ">Privacy</a><b>•</b>
            <a href="https://konghq.com/compliance" target="_blank" rel="noopener nofollow noreferrer ">Trust and Compliance</a>
          </span>
        </li>
      </ul>
      <div>
        <span>© Kong Inc. 2024  </span>
      </div>
    </div>
  </section>
</footer>
 <script>
  var anchorForId = function (id) {
    var anchor = document.createElement("a");
    anchor.className = "header-link";
    anchor.href      = "#" + id;
    anchor.innerHTML = "<i class=\"fa fa-link\"></i>";
    anchor.title = `${id} Permalink`;
    return anchor;
  };

  document.onreadystatechange = function () {
    if (this.readyState === "complete") {
      var className =
        ".show-anchor-links h1, .show-anchor-links h2, .show-anchor-links h3, " +
        ".show-anchor-links h4, .show-anchor-links h5, .show-anchor-links h6";
      var headers = document.querySelectorAll(className);

      for (var i = 0; i < headers.length; i++) {
        var header = headers[i];
        if (typeof header.id !== "undefined" && header.id !== "") {
          header.prepend(anchorForId(header.id));
        }
      }
    }
  };
</script>


    
      <script>
        (function stp(){
          if (typeof analytics == "undefined"){
            return setTimeout(stp, 30);
          }
          analytics.page();
        })();
      </script>
    

    <div id="fb-root"></div>
    <script id="github-bjs" src="https://buttons.github.io/buttons.js" async defer></script>

    <script type="text/javascript">
      var _vwo_code = (function() {
        var account_id = 125292,
          settings_tolerance = 2000,
          library_tolerance = 2500,
          use_existing_jquery = true,
          // DO NOT EDIT BELOW THIS LINE
          f = false,
          d = document;
        return {
          use_existing_jquery: function() {
            return use_existing_jquery;
          },
          library_tolerance: function() {
            return library_tolerance;
          },
          finish: function() {
            if (!f) {
              f = true;
              var a = d.getElementById('_vis_opt_path_hides');
              if (a) a.parentNode.removeChild(a);
            }
          },
          finished: function() {
            return f;
          },
          load: function(a) {
            var b = d.createElement('script');
            b.src = a;
            b.type = 'text/javascript';
            b.innerText;
            b.onerror = function() {
              _vwo_code.finish();
            };
            d.getElementsByTagName('head')[0].appendChild(b);
          },
          init: function() {
            settings_timer = setTimeout(
              '_vwo_code.finish()',
              settings_tolerance
            );
            this.load(
              '//dev.visualwebsiteoptimizer.com/j.php?a=' +
                account_id +
                '&u=' +
                encodeURIComponent(d.URL) +
                '&r=' +
                Math.random()
            );
            var a = d.createElement('style'),
              b = '',
              h = d.getElementsByTagName('head')[0];
            a.setAttribute('id', '_vis_opt_path_hides');
            a.setAttribute('type', 'text/css');
            if (a.styleSheet) a.styleSheet.cssText = b;
            else a.appendChild(d.createTextNode(b));
            h.appendChild(a);
            return settings_timer;
          }
        };
      })();
      _vwo_settings_timer = _vwo_code.init();
    </script>

    <script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script>

    
      <script type="text/javascript">
        docsearch({
          appId: '05Y6TLHNFZ',
          apiKey: '80483bfe28d9fd036a11a6f6a06454f8',
          indexName: 'konghq',
          container: '#getkong-algolia-search-input',
          disableUserPersonalization: true,
          placeholder: 'Search the docs...',
          // Override selected event to allow for local environment navigation
          transformItems(items) {
            return items.map((item) => {
              var modifiedUrl = window.location.protocol + '//' + window.location.host + item.url.split('docs.konghq.com')[1];
              return { ...item, url: modifiedUrl };
            });
          },
          translations: {
            button: {
              buttonText: 'Search the docs..',
              buttonAriaLabel: 'Search the docs...'
            }
          },
          resultsFooterComponent({ state }) {
            var facetParameters = {};
            
              facetParameters = {"version[0]":"1.9.x","product[0]":"Kong Mesh"};
            

            var queryParams = new URLSearchParams(facetParameters);
            queryParams.set('query', state.query);

            return {
              // The HTML `tag`
              type: 'a',
              ref: undefined,
              constructor: undefined,
              key: state.query,
              // Its props
              props: {
                href: `/search/?${queryParams.toString()}`,
                target: '_blank',
                // Raw text rendered in the HTML element
                children: 'See more >'
              },
              __v: null,
            };
          },
          
           searchParameters: {
              optionalFilters: ['product:Kong Mesh<score=1>'],
              facetFilters: [ 'version:1.9.x']
            }
            
          });
      </script>
    
  </div>
</body>

  

</html>
